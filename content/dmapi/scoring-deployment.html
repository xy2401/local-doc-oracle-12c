<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Explains the scoring and deployment features of Oracle Data Mining.">
      <meta name="description" content="Explains the scoring and deployment features of Oracle Data Mining.">
      <title>Scoring and Deployment</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="API Guide">
      <meta property="og:description" content="Explains the scoring and deployment features of Oracle Data Mining.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="API Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="data-mining-api-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-03-12T08:52:48-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2005, 2018">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E85759-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/12.2">
      <meta name="dcterms.release" content="Release 12.2">
      <link rel="prev" href="model-creation.html" title="Previous" type="text/html">
      <link rel="next" href="mining-unstructured-text.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"12.2","element_name":"Release 12.2","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Data Mining API Guide">
    <meta name="dcterms.isVersionOf" content="DMAPI">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="model-creation.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="mining-unstructured-text.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">API Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="using-data-mining-API.html" property="item" typeof="WebPage"><span property="name">Using the Data Mining API</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Scoring and Deployment </li>
            </ol>
            <a id="GUID-891F460B-CB68-43F6-AD21-D7C9FD1CF670" name="GUID-891F460B-CB68-43F6-AD21-D7C9FD1CF670"></a><a id="DMPRG004"></a>
            
            <h2 id="DMAPI-GUID-891F460B-CB68-43F6-AD21-D7C9FD1CF670" class="sect2"><span class="enumeration_chapter">26 </span> Scoring and Deployment 
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Explains the scoring and deployment features of Oracle Data Mining. </p>
               <p><a id="d57501e19" class="indexterm-anchor"></a><a id="d57501e23" class="indexterm-anchor"></a></p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="scoring-deployment.html#GUID-D7FA7C0E-DAF5-4F02-BCA5-4EB3B7312B24" title="Scoring is the application of models to new data. In Oracle Data Mining, scoring is performed by SQL language functions.">About Scoring and Deployment</a></p>
                  </li>
                  <li>
                     <p><a href="scoring-deployment.html#GUID-50EDC913-073D-461D-9627-9269C2552FDE" title="Learn about the benefits of SQL functions in data mining.">Using the Data Mining SQL Functions</a></p>
                  </li>
                  <li>
                     <p><a href="scoring-deployment.html#GUID-28A6F6E9-398C-426C-943C-F3CB1C635610" title="Data mining functions consist of SQL functions such as PREDICTION*, CLUSTER*, FEATURE*, and ORA_DM_*. The GROUPING hint is an optional hint which applies to data mining scoring functions when scoring partitioned models.">Prediction Details</a></p>
                  </li>
                  <li>
                     <p><a href="scoring-deployment.html#GUID-4E135716-76B6-4870-B283-927C1E83C4EE">Real-Time Scoring</a></p>
                  </li>
                  <li>
                     <p><a href="scoring-deployment.html#GUID-AB32A94A-2D8C-4BBC-89B9-FD432F3A464B">Dynamic Scoring</a></p>
                  </li>
                  <li>
                     <p><a href="scoring-deployment.html#GUID-CA99161A-9A1C-4736-855D-98356E451783" title="Costs are user-specified numbers that bias Classification. The algorithm uses positive numbers to penalize more expensive outcomes over less expensive outcomes. Higher numbers indicate higher costs.">Cost-Sensitive Decision Making</a></p>
                  </li>
                  <li>
                     <p><a href="scoring-deployment.html#GUID-08557F7B-217F-4C96-833B-D4AAA613D90B" title="The APPLY procedure in DBMS_DATA_MINING is a batch apply operation that writes the results of scoring directly to a table.">DBMS_DATA_MINING.Apply </a></p>
                  </li>
               </ul>
            </div><a id="DMPRG224"></a><div class="props_rev_3"><a id="GUID-D7FA7C0E-DAF5-4F02-BCA5-4EB3B7312B24" name="GUID-D7FA7C0E-DAF5-4F02-BCA5-4EB3B7312B24"></a><h3 id="DMAPI-GUID-D7FA7C0E-DAF5-4F02-BCA5-4EB3B7312B24" class="sect3"><span class="enumeration_section">26.1 </span>About Scoring and Deployment
               </h3>
               <div>
                  <p><strong class="term">Scoring</strong> is the application of models to new data. In Oracle Data Mining, scoring is performed by SQL language functions.
                  </p>
                  <p>Predictive functions perform Classification, Regression, or Anomaly detection. Clustering functions assign rows to clusters. Feature Extraction functions transform the input data to a set of higher order predictors. A scoring procedure is also available in the <code class="codeph">DBMS_DATA_MINING</code> PL/SQL package.
                  </p>
                  <p><strong class="term">Deployment</strong> refers to the use of models in a target environment. Once the models have been built, the challenges come in deploying them to obtain the best results, and in maintaining them within a production environment.<a id="d57501e132" class="indexterm-anchor"></a> Deployment can be any of the following:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Scoring data either for batch or <a id="d57501e141" class="indexterm-anchor"></a>real-time results. Scores can include predictions, probabilities, rules, and other statistics.
                        </p>
                     </li>
                     <li>
                        <p>Extracting model details to produce reports. For example: clustering rules, decision tree rules, or attribute rankings from an Attribute Importance model.</p>
                     </li>
                     <li>
                        <p>Extending the business intelligence infrastructure of a data warehouse by incorporating mining results in applications or operational systems.</p>
                     </li>
                     <li>
                        <p>Moving a model from the database where it was built to the database where it used for scoring (export/import)</p>
                     </li>
                  </ul>
                  <p>Oracle Data Mining supports all of these deployment scenarios.</p>
                  <div class="infoboxnote" id="GUID-D7FA7C0E-DAF5-4F02-BCA5-4EB3B7312B24__GUID-E3E95778-4412-4297-8F55-950B6F761604">
                     <p class="notep1">Note:</p>
                     <p>Oracle Data Mining scoring operations support parallel execution. When <a id="d57501e158" class="indexterm-anchor"></a>parallel execution is enabled, multiple CPU and I/O resources are applied to the execution of a single database operation.
                     </p>
                     <p>Parallel execution <a id="d57501e163" class="indexterm-anchor"></a>offers significant performance improvements, especially for operations that involve complex queries and large databases typically associated with decision support systems (DSS) and data warehouses.
                     </p>
                  </div>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/12.2/dmapi&amp;id=VLDBG-GUID-3E2AE088-2505-465E-A8B2-AC38813EA355"><span><cite>Oracle Database VLDB and Partitioning Guide</cite></span></a></li>
                        <li><a href="../dmcon/data-mining-basics.html#DMCON-GUID-21677973-2248-4119-A560-24D7F2FD7EAD"><span><cite>Oracle Data Mining Concepts</cite></span></a></li>
                        <li><a href="administrative-tasks.html#GUID-0A1878F3-36A7-47EB-B555-BD0FDA66BC23" title="You can export data mining models to flat files to back up work in progress or to move models to a different instance of Oracle Database Enterprise Edition (such as from a development database to a test database).">Exporting and Importing Mining Models</a></li>
                     </ul>
                  </div>
               </div>
            </div><a id="DMPRG771"></a><div class="props_rev_3"><a id="GUID-50EDC913-073D-461D-9627-9269C2552FDE" name="GUID-50EDC913-073D-461D-9627-9269C2552FDE"></a><h3 id="DMAPI-GUID-50EDC913-073D-461D-9627-9269C2552FDE" class="sect3"><span class="enumeration_section">26.2 </span>Using the Data Mining SQL Functions
               </h3>
               <div>
                  <p>Learn about the benefits of SQL functions in data mining.</p>
                  <div class="section">
                     <p>The data mining SQL functions provide the following benefits:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Models can be easily deployed within the context of existing SQL applications.</p>
                        </li>
                        <li>
                           <p>Scoring operations take advantage of existing query execution functionality. This provides performance benefits.</p>
                        </li>
                        <li>
                           <p>Scoring results are pipelined, enabling the rows to be processed without requiring materialization.</p>
                        </li>
                     </ul>
                     <p>The data mining functions produce a score for each row in the selection. The functions can apply a mining model schema object to compute the score, or they can score dynamically without a pre-defined model, as described in <span class="q">"Dynamic Scoring"</span>.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="scoring-deployment.html#GUID-AB32A94A-2D8C-4BBC-89B9-FD432F3A464B">Dynamic Scoring</a></li>
                        <li><a href="preparing-data.html#GUID-DA5FBB07-125D-4388-812D-AA1DE469FDE8">Scoring Requirements</a></li>
                        <li><a href="data-mining-API.html#GUID-191F4A5D-136B-426E-98F6-D4EB250A602E__CHDIGCHB" title="This table provides a summary of the predictive functions for Data Mining."></a></li>
                        <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/12.2/dmapi&amp;id=SQLRF20030"><span><cite>Oracle Database SQL Language Reference</cite></span></a></li>
                     </ul>
                  </div>
               </div><a id="DMPRG825"></a><a id="DMPRG839"></a><a id="DMPRG840"></a><a id="DMPRG824"></a><div class="props_rev_3"><a id="GUID-FE739B8A-EF2F-4EF8-B51E-7BE3F73FED40" name="GUID-FE739B8A-EF2F-4EF8-B51E-7BE3F73FED40"></a><h4 id="DMAPI-GUID-FE739B8A-EF2F-4EF8-B51E-7BE3F73FED40" class="sect4"><span class="enumeration_section">26.2.1 </span>Choosing the Predictors
                  </h4>
                  <div>
                     <div class="section">
                        <p>The data mining functions support a <code class="codeph">USING</code> clause that specifies which attributes to use for scoring. You can specify some or all of the attributes in the selection and you can specify expressions. The following examples all use the <code class="codeph">PREDICTION</code> function to find the customers who are likely to use an affinity card, but each example uses a different set of predictors.
                        </p>
                        <p>The query in <a href="scoring-deployment.html#GUID-FE739B8A-EF2F-4EF8-B51E-7BE3F73FED40__BABCBAGJ">Example 26-1</a> uses all the predictors.
                        </p>
                        <p>The query in <a href="scoring-deployment.html#GUID-FE739B8A-EF2F-4EF8-B51E-7BE3F73FED40__BABIEJCI">Example 26-2</a> uses only gender, marital status, occupation, and income as predictors. 
                        </p>
                        <p>The query in <a href="scoring-deployment.html#GUID-FE739B8A-EF2F-4EF8-B51E-7BE3F73FED40__BABIFCFD">Example 26-3</a> uses three attributes and an expression as predictors. The prediction is based on gender, marital status, occupation, and the assumption that all customers are in the highest income bracket.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-FE739B8A-EF2F-4EF8-B51E-7BE3F73FED40__BABCBAGJ">
                        <p class="titleinexample">Example 26-1 Using All Predictors</p><pre class="oac_no_warn" dir="ltr">SELECT cust_gender, COUNT(*) AS cnt, ROUND(AVG(age)) AS avg_age
     FROM mining_data_apply_v
     WHERE PREDICTION(dt_sh_clas_sample USING *) = 1
   GROUP BY cust_gender
   ORDER BY cust_gender;
 
C        CNT    AVG_AGE
- ---------- ----------
F         25         38
M        213         43
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-FE739B8A-EF2F-4EF8-B51E-7BE3F73FED40__BABIEJCI">
                        <p class="titleinexample">Example 26-2 Using Some Predictors</p><pre class="oac_no_warn" dir="ltr"> SELECT cust_gender, COUNT(*) AS cnt, ROUND(AVG(age)) AS avg_age
     FROM mining_data_apply_v
     WHERE PREDICTION(dt_sh_clas_sample USING
                      cust_gender,cust_marital_status,
                      occupation, cust_income_level) = 1
   GROUP BY cust_gender
   ORDER BY cust_gender;
 
C        CNT    AVG_AGE
- ---------- ----------
F         30         38
M        186         43
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-FE739B8A-EF2F-4EF8-B51E-7BE3F73FED40__BABIFCFD">
                        <p class="titleinexample">Example 26-3 Using Some Predictors and an Expression</p><pre class="oac_no_warn" dir="ltr">SELECT cust_gender, COUNT(*) AS cnt, ROUND(AVG(age)) AS avg_age
     FROM mining_data_apply_v
     WHERE PREDICTION(dt_sh_clas_sample USING
                     cust_gender, cust_marital_status, occupation,
                    'L: 300,000 and above' AS cust_income_level) = 1
   GROUP BY cust_gender
   ORDER BY cust_gender;
 
C        CNT    AVG_AGE
- ---------- ----------
F         30         38
M        186         43
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="DMPRG827"></a><a id="DMPRG841"></a><a id="DMPRG826"></a><div class="props_rev_3"><a id="GUID-3C177C13-21A5-412D-83C2-FF7B8F27447C" name="GUID-3C177C13-21A5-412D-83C2-FF7B8F27447C"></a><h4 id="DMAPI-GUID-3C177C13-21A5-412D-83C2-FF7B8F27447C" class="sect4"><span class="enumeration_section">26.2.2 </span>Single-Record Scoring
                  </h4>
                  <div>
                     <div class="section">
                        <p>The data mining functions can produce a score for a single record, as shown in <a href="scoring-deployment.html#GUID-3C177C13-21A5-412D-83C2-FF7B8F27447C__BABEFIAB">Example 26-4</a> and <a href="scoring-deployment.html#GUID-3C177C13-21A5-412D-83C2-FF7B8F27447C__BABGAFAJ">Example 26-5</a>.
                        </p>
                        <p><a href="scoring-deployment.html#GUID-3C177C13-21A5-412D-83C2-FF7B8F27447C__BABEFIAB">Example 26-4</a> returns a prediction for customer 102001 by applying the classification model <code class="codeph">NB_SH_Clas_sample</code>. The resulting score is 0, meaning that this customer is unlikely to use an affinity card.
                        </p>
                        <p><a href="scoring-deployment.html#GUID-3C177C13-21A5-412D-83C2-FF7B8F27447C__BABGAFAJ">Example 26-5</a> returns a prediction for 'Affinity card is great' as the comments attribute by applying the text mining model <code class="codeph">T_SVM_Clas_sample</code>. The resulting score is 1, meaning that this customer is likely to use an affinity card.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-3C177C13-21A5-412D-83C2-FF7B8F27447C__BABEFIAB">
                        <p class="titleinexample">Example 26-4 Scoring a Single Customer or a Single Text Expression</p><pre class="oac_no_warn" dir="ltr">SELECT PREDICTION (NB_SH_Clas_Sample USING *)
    FROM sh.customers where cust_id = 102001;  
 
PREDICTION(NB_SH_CLAS_SAMPLEUSING*)
-----------------------------------
                                  0
</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-3C177C13-21A5-412D-83C2-FF7B8F27447C__BABGAFAJ">
                        <p class="titleinexample">Example 26-5 Scoring a Single Text Expression</p><pre class="oac_no_warn" dir="ltr">SELECT
  PREDICTION(T_SVM_Clas_sample USING 'Affinity card is great' AS comments)
FROM DUAL;
 
PREDICTION(T_SVM_CLAS_SAMPLEUSING'AFFINITYCARDISGREAT'ASCOMMENTS)
-----------------------------------------------------------------
                                                                1
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
            </div><a id="DMPRG776"></a><div class="props_rev_3"><a id="GUID-28A6F6E9-398C-426C-943C-F3CB1C635610" name="GUID-28A6F6E9-398C-426C-943C-F3CB1C635610"></a><h3 id="DMAPI-GUID-28A6F6E9-398C-426C-943C-F3CB1C635610" class="sect3"><span class="enumeration_section">26.3 </span>Prediction Details
               </h3>
               <div>
                  <p>Prediction details are XML strings that provide information about the score. Details are available for all types of scoring: clustering, feature extraction, classification, regression, and anomaly detection. Details are available whether scoring is dynamic or the result of model apply. </p>
                  <p>The details functions, <code class="codeph">CLUSTER_DETAILS</code>, <code class="codeph">FEATURE_DETAILS</code>, and <code class="codeph">PREDICTION_DETAILS</code> return the actual value of attributes used for scoring and the relative importance of the attributes in determining the score. By default, the functions return the five most important attributes in descending order of importance.
                  </p>
               </div><a id="DMPRG829"></a><a id="DMPRG828"></a><div class="props_rev_3"><a id="GUID-3DE3B80D-B6E5-4803-A903-76F16408B74F" name="GUID-3DE3B80D-B6E5-4803-A903-76F16408B74F"></a><h4 id="DMAPI-GUID-3DE3B80D-B6E5-4803-A903-76F16408B74F" class="sect4"><span class="enumeration_section">26.3.1 </span>Cluster Details
                  </h4>
                  <div>
                     <div class="section">
                        <p>For the most likely cluster assignments of customer 100955 (probability of assignment &gt; 20%), the query in the following example produces the five attributes that have the most impact for each of the likely clusters. The clustering functions apply an Expectation Maximization model named <code class="codeph">em_sh_clus_sample</code> to the data selected from <code class="codeph">mining_data_apply_v</code>. The "5" specified in <code class="codeph">CLUSTER_DETAILS</code> is not required, because five attributes are returned by default.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-3DE3B80D-B6E5-4803-A903-76F16408B74F__BABBDDIG">
                        <p class="titleinexample">Example 26-6 Cluster Details</p><pre class="oac_no_warn" dir="ltr">SELECT S.cluster_id, probability prob,
           CLUSTER_DETAILS(em_sh_clus_sample, S.cluster_id, 5 USING T.*) det
    FROM
      (SELECT v.*, CLUSTER_SET(em_sh_clus_sample, NULL, 0.2 USING *) pset
        FROM mining_data_apply_v v
       WHERE cust_id = 100955) T,
      TABLE(T.pset) S
    ORDER BY 2 DESC;
 
CLUSTER_ID  PROB DET
---------- ----- ----------------------------------------------------------------------------
        14 .6761 &lt;Details algorithm="Expectation Maximization" cluster="14"&gt;  
                 &lt;Attribute name="AGE" actualValue="51" weight=".676" rank="1"/&gt;
                 &lt;Attribute name="HOME_THEATER_PACKAGE" actualValue="1" weight=".557" rank="2"/&gt;
                 &lt;Attribute name="FLAT_PANEL_MONITOR" actualValue="0" weight=".412" rank="3"/&gt;
                 &lt;Attribute name="Y_BOX_GAMES" actualValue="0" weight=".171" rank="4"/&gt;
                 &lt;Attribute name="BOOKKEEPING_APPLICATION"actualValue="1" weight="-.003"
                  rank="5"/&gt;
                 &lt;/Details&gt;
 
         3 .3227 &lt;Details algorithm="Expectation Maximization" cluster="3"&gt;
                 &lt;Attribute name="YRS_RESIDENCE" actualValue="3" weight=".323" rank="1"/&gt;
                 &lt;Attribute name="BULK_PACK_DISKETTES" actualValue="1" weight=".265" rank="2"/&gt;
                 &lt;Attribute name="EDUCATION" actualValue="HS-grad" weight=".172" rank="3"/&gt;
                 &lt;Attribute name="AFFINITY_CARD" actualValue="0" weight=".125" rank="4"/&gt;
                 &lt;Attribute name="OCCUPATION" actualValue="Crafts" weight=".055" rank="5"/&gt;
                 &lt;/Details&gt;
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="DMPRG831"></a><a id="DMPRG830"></a><div class="props_rev_3"><a id="GUID-7B7BBCAE-3152-4EAD-882D-65BCD11572F6" name="GUID-7B7BBCAE-3152-4EAD-882D-65BCD11572F6"></a><h4 id="DMAPI-GUID-7B7BBCAE-3152-4EAD-882D-65BCD11572F6" class="sect4"><span class="enumeration_section">26.3.2 </span>Feature Details
                  </h4>
                  <div>
                     <div class="section">
                        <p>The query in the following example returns the three attributes that have the greatest impact on the top Principal Components Analysis (PCA) projection for customer 101501. The <code class="codeph">FEATURE_DETAILS</code> function applies a Singular Value Decomposition model named <code class="codeph">svd_sh_sample</code> to the data selected from <code class="codeph">svd_sh_sample_build_num</code>.
                        </p>
                        <p></p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-7B7BBCAE-3152-4EAD-882D-65BCD11572F6__BABHEIII">
                        <p class="titleinexample">Example 26-7 Feature Details</p><pre class="oac_no_warn" dir="ltr">SELECT FEATURE_DETAILS(svd_sh_sample, 1, 3 USING *) proj1det
  FROM svd_sh_sample_build_num
  WHERE CUST_ID = 101501;
 
PROJ1DET
--------------------------------------------------------------------------------
&lt;Details algorithm="Singular Value Decomposition" feature="1"&gt;
&lt;Attribute name="HOME_THEATER_PACKAGE" actualValue="1" weight=".352" rank="1"/&gt;
&lt;Attribute name="Y_BOX_GAMES" actualValue="0" weight=".249" rank="2"/&gt;
&lt;Attribute name="AGE" actualValue="41" weight=".063" rank="3"/&gt;
&lt;/Details&gt;
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="DMPRG833"></a><a id="DMPRG835"></a><a id="DMPRG837"></a><a id="DMPRG832"></a><div class="props_rev_3"><a id="GUID-BF9D58F4-FF25-430C-84D7-411A6B3071CA" name="GUID-BF9D58F4-FF25-430C-84D7-411A6B3071CA"></a><h4 id="DMAPI-GUID-BF9D58F4-FF25-430C-84D7-411A6B3071CA" class="sect4"><span class="enumeration_section">26.3.3 </span>Prediction Details
                  </h4>
                  <div>
                     <div class="section">
                        <p>The query in the following example returns the attributes that are most important in predicting the age of customer 100010. The prediction functions apply a Generalized Linear Model Regression model named <code class="codeph">GLMR_SH_Regr_sample</code> to the data selected from <code class="codeph">mining_data_apply_v</code>.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-BF9D58F4-FF25-430C-84D7-411A6B3071CA__BABGBJIB">
                        <p class="titleinexample">Example 26-8 Prediction Details for Regression</p><pre class="oac_no_warn" dir="ltr">SELECT cust_id,
      PREDICTION(GLMR_SH_Regr_sample USING *) pr,
      PREDICTION_DETAILS(GLMR_SH_Regr_sample USING *) pd
  FROM mining_data_apply_v
  WHERE CUST_ID = 100010;
 
CUST_ID    PR PD
------- ----- -----------
 100010 25.45 &lt;Details algorithm="Generalized Linear Model"&gt;
              &lt;Attribute name="FLAT_PANEL_MONITOR" actualValue="1" weight=".025" rank="1"/&gt;
              &lt;Attribute name="OCCUPATION" actualValue="Crafts" weight=".019" rank="2"/&gt;
              &lt;Attribute name="AFFINITY_CARD" actualValue="0" weight=".01" rank="3"/&gt;
              &lt;Attribute name="OS_DOC_SET_KANJI" actualValue="0" weight="0" rank="4"/&gt;
              &lt;Attribute name="BOOKKEEPING_APPLICATION" actualValue="1" weight="-.004" rank="5"/&gt;
              &lt;/Details&gt;
</pre></div>
                     <!-- class="example" -->
                     <div class="section">
                        <p>The query in the following example returns the customers who work in Tech Support and are likely to use an affinity card (with more than 85% probability). The prediction functions apply an Support Vector Machine (SVM) Classification model named <code class="codeph">svmc_sh_clas_sample</code>. to the data selected from <code class="codeph">mining_data_apply_v</code>. The query includes the prediction details, which show that education is the most important predictor. 
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-BF9D58F4-FF25-430C-84D7-411A6B3071CA__BABFJFEF">
                        <p class="titleinexample">Example 26-9 Prediction Details for Classification</p><pre class="oac_no_warn" dir="ltr">SELECT cust_id, PREDICTION_DETAILS(svmc_sh_clas_sample, 1 USING *) PD
      FROM mining_data_apply_v
  WHERE PREDICTION_PROBABILITY(svmc_sh_clas_sample, 1 USING *) &gt; 0.85
  AND occupation = 'TechSup'
  ORDER BY cust_id;
 
CUST_ID PD
------- ---------------------------------------------------------------------------------------
 100029 &lt;Details algorithm="Support Vector Machines" class="1"&gt;
        &lt;Attribute name="EDUCATION" actualValue="Assoc-A" weight=".199" rank="1"/&gt;
        &lt;Attribute name="CUST_INCOME_LEVEL" actualValue="I: 170\,000 - 189\,999" weight=".044"
         rank="2"/&gt;
        &lt;Attribute name="HOME_THEATER_PACKAGE" actualValue="1" weight=".028" rank="3"/&gt;
        &lt;Attribute name="BULK_PACK_DISKETTES" actualValue="1" weight=".024" rank="4"/&gt;
        &lt;Attribute name="BOOKKEEPING_APPLICATION" actualValue="1" weight=".022" rank="5"/&gt;
        &lt;/Details&gt;
 
 100378 &lt;Details algorithm="Support Vector Machines" class="1"&gt;
        &lt;Attribute name="EDUCATION" actualValue="Assoc-A" weight=".21" rank="1"/&gt;
        &lt;Attribute name="CUST_INCOME_LEVEL" actualValue="B: 30\,000 - 49\,999" weight=".047"
         rank="2"/&gt;
        &lt;Attribute name="FLAT_PANEL_MONITOR" actualValue="0" weight=".043" rank="3"/&gt;
        &lt;Attribute name="HOME_THEATER_PACKAGE" actualValue="1" weight=".03" rank="4"/&gt;
        &lt;Attribute name="BOOKKEEPING_APPLICATION" actualValue="1" weight=".023" rank="5"/&gt;
        &lt;/Details&gt;
 
 100508 &lt;Details algorithm="Support Vector Machines" class="1"&gt;
        &lt;Attribute name="EDUCATION" actualValue="Bach." weight=".19" rank="1"/&gt;
        &lt;Attribute name="CUST_INCOME_LEVEL" actualValue="L: 300\,000 and above" weight=".046"
         rank="2"/&gt;
        &lt;Attribute name="HOME_THEATER_PACKAGE" actualValue="1" weight=".031" rank="3"/&gt;
        &lt;Attribute name="BULK_PACK_DISKETTES" actualValue="1" weight=".026" rank="4"/&gt;
        &lt;Attribute name="BOOKKEEPING_APPLICATION" actualValue="1" weight=".024" rank="5"/&gt;
        &lt;/Details&gt;
 
 100980 &lt;Details algorithm="Support Vector Machines" class="1"&gt;
        &lt;Attribute name="EDUCATION" actualValue="Assoc-A" weight=".19" rank="1"/&gt;
        &lt;Attribute name="FLAT_PANEL_MONITOR" actualValue="0" weight=".038" rank="2"/&gt;
        &lt;Attribute name="HOME_THEATER_PACKAGE" actualValue="1" weight=".026" rank="3"/&gt;
        &lt;Attribute name="BULK_PACK_DISKETTES" actualValue="1" weight=".022" rank="4"/&gt;
        &lt;Attribute name="BOOKKEEPING_APPLICATION" actualValue="1" weight=".02" rank="5"/&gt;
        &lt;/Details&gt;
</pre></div>
                     <!-- class="example" -->
                     <div class="section">
                        <p>The query in the following example returns the two customers that differ the most from the rest of the customers. The prediction functions apply an anomaly detection model named <code class="codeph">SVMO_SH_Clas_sample</code> to the data selected from <code class="codeph">mining_data_apply_v</code>. Anomaly Detection uses a one-class SVM classifier.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-BF9D58F4-FF25-430C-84D7-411A6B3071CA__BABHHAEH">
                        <p class="titleinexample">Example 26-10 Prediction Details for Anomaly Detection</p><pre class="oac_no_warn" dir="ltr">SELECT cust_id, pd FROM
  (SELECT cust_id,        
         PREDICTION_DETAILS(SVMO_SH_Clas_sample, 0 USING *) pd,
         RANK() OVER (ORDER BY prediction_probability(
               SVMO_SH_Clas_sample, 0 USING *) DESC, cust_id) rnk
  FROM mining_data_one_class_v)
  WHERE rnk &lt;= 2
  ORDER BY rnk;

  CUST_ID PD
---------- -----------------------------------------------------------------------------------
    102366 &lt;Details algorithm="Support Vector Machines" class="0"&gt;
           &lt;Attribute name="COUNTRY_NAME" actualValue="United Kingdom" weight=".078" rank="1"/&gt;
           &lt;Attribute name="CUST_MARITAL_STATUS" actualValue="Divorc." weight=".027" rank="2"/&gt;
           &lt;Attribute name="CUST_GENDER" actualValue="F" weight=".01" rank="3"/&gt;
           &lt;Attribute name="HOUSEHOLD_SIZE" actualValue="9+" weight=".009" rank="4"/&gt;
           &lt;Attribute name="AGE" actualValue="28" weight=".006" rank="5"/&gt;
           &lt;/Details&gt;
 
    101790 &lt;Details algorithm="Support Vector Machines" class="0"&gt;
           &lt;Attribute name="COUNTRY_NAME" actualValue="Canada" weight=".068" rank="1"/&gt;
           &lt;Attribute name="HOUSEHOLD_SIZE" actualValue="4-5" weight=".018" rank="2"/&gt;
           &lt;Attribute name="EDUCATION" actualValue="7th-8th" weight=".015" rank="3"/&gt;
           &lt;Attribute name="CUST_GENDER" actualValue="F" weight=".013" rank="4"/&gt;
           &lt;Attribute name="AGE" actualValue="38" weight=".001" rank="5"/&gt;
           &lt;/Details&gt;</pre></div>
                     <!-- class="example" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-0ABE2189-A385-48C6-88FD-E8F59B021BE1" name="GUID-0ABE2189-A385-48C6-88FD-E8F59B021BE1"></a><h4 id="DMAPI-GUID-0ABE2189-A385-48C6-88FD-E8F59B021BE1" class="sect4"><span class="enumeration_section">26.3.4 </span>GROUPING Hint
                  </h4>
                  <div>
                     <p>Data mining functions consist of SQL functions such as <code class="codeph">PREDICTION*</code>, <code class="codeph">CLUSTER*</code>, <code class="codeph">FEATURE*</code>, and <code class="codeph">ORA_DM_*</code>. The <code class="codeph">GROUPING</code> hint is an optional hint which applies to data mining scoring functions when scoring partitioned models. 
                     </p>
                     <div class="section">
                        <p class="subhead3">Enhanced PREDICTION Function Command Format</p>
                        <p>This hint results in partitioning the input data set into distinct data slices so that each partition is scored in its entirety before advancing to the next partition. However, parallelism by partition is still available. Data slices are determined by the partitioning key columns used when the model was built. This method can be used with any data mining function against a partitioned model. The hint may yield a query performance gain when scoring large data that is associated with many partitions but may negatively impact performance when scoring large data with few partitions on large systems. Typically, there is no performance gain if you use the hint for single row queries.</p><pre class="pre codeblock"><code>&lt;prediction function&gt; ::=
    PREDICTION &lt;left paren&gt; /*+ GROUPING */ &lt;prediction model&gt;
        [ &lt;comma&gt; &lt;class value&gt; [ &lt;comma&gt; &lt;top N&gt; ] ]
        USING &lt;mining attribute list&gt; &lt;right paren&gt;</code></pre><p>The syntax for only the <code>PREDICTION</code> function is given but it is applicable to any Data mining function where <code>PREDICTION</code>, <code class="codeph">CLUSTERING</code>, and <code class="codeph">FEATURE_EXTRACTION</code> scoring functions occur.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="example" id="GUID-0ABE2189-A385-48C6-88FD-E8F59B021BE1__GUID-DDEC3A38-7BAD-4D4C-9799-AB849F5FE230">
                        <p class="titleinexample">Example 26-11 Example</p><pre class="pre codeblock"><code>SELECT PREDICTION(/*+ GROUPING */my_model USING *) pred FROM &lt;input table&gt;;</code></pre></div>
                     <!-- class="example" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="../sqlrf/PREDICTION.html#SQLRF-GUID-DA66A1C3-BFB2-43A1-A3FF-93D4A3DAB9C6"><span><cite>Oracle Database SQL Language Reference</cite></span></a></li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="DMPRG226"></a><a id="DMPRG773"></a><div class="props_rev_3"><a id="GUID-4E135716-76B6-4870-B283-927C1E83C4EE" name="GUID-4E135716-76B6-4870-B283-927C1E83C4EE"></a><h3 id="DMAPI-GUID-4E135716-76B6-4870-B283-927C1E83C4EE" class="sect3"><span class="enumeration_section">26.4 </span>Real-Time Scoring
               </h3>
               <div>
                  <p>Oracle Data Mining SQL functions enable prediction, clustering, and feature extraction analysis to be easily integrated into live production and operational systems. Because mining results are returned within SQL queries, mining can occur in real time. </p>
                  <p>With real-time scoring, point-of-sales database transactions can be mined. Predictions and rule sets can be generated to help front-line workers make better analytical decisions. Real-time scoring enables fraud detection, identification of potential liabilities, and recognition of better marketing and selling opportunities. </p>
                  <p>The query in the following example uses a <a id="d57501e642" class="indexterm-anchor"></a>Decision Tree model named <code class="codeph">dt_sh_clas_sample</code> to predict the probability that customer 101488 uses an affinity card. A customer representative can retrieve this information in real time when talking to this customer on the phone. Based on the query result, the representative can offer an extra-value card, since there is a 73% chance that the customer uses a card.
                  </p>
                  <div class="example" id="GUID-4E135716-76B6-4870-B283-927C1E83C4EE__CIHEFAAJ">
                     <p class="titleinexample">Example 26-12 Real-Time Query with Prediction Probability</p><pre class="oac_no_warn" dir="ltr">SELECT <a id="d57501e653" class="indexterm-anchor"></a>PREDICTION_PROBABILITY(dt_sh_clas_sample, 1 USING *) cust_card_prob
       FROM mining_data_apply_v
       WHERE cust_id = 101488;

CUST_CARD_PROB
--------------
        .72764</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="DMPRG775"></a><a id="DMPRG774"></a><div class="props_rev_3"><a id="GUID-AB32A94A-2D8C-4BBC-89B9-FD432F3A464B" name="GUID-AB32A94A-2D8C-4BBC-89B9-FD432F3A464B"></a><h3 id="DMAPI-GUID-AB32A94A-2D8C-4BBC-89B9-FD432F3A464B" class="sect3"><span class="enumeration_section">26.5 </span>Dynamic Scoring
               </h3>
               <div>
                  <p><a id="d57501e677" class="indexterm-anchor"></a>The Data Mining SQL functions operate in two modes: by applying a pre-defined model, or by executing an analytic clause. If you supply an analytic clause instead of a model name, the function builds one or more transient models and uses them to score the data.
                  </p>
                  <p>The ability to score data dynamically without a pre-defined model extends the application of basic embedded data mining techniques into environments where models are not available. Dynamic scoring, however, has limitations. The transient models created during dynamic scoring are not available for inspection or fine tuning. Applications that require model inspection, the correlation of scoring results with the model, special algorithm settings, or multiple scoring queries that use the same model, require a predefined model.</p>
                  <p>The following example shows a dynamic scoring query. The example identifies the rows in the input data that contain unusual customer age values. </p>
                  <div class="example" id="GUID-AB32A94A-2D8C-4BBC-89B9-FD432F3A464B__BABGGIGF">
                     <p class="titleinexample">Example 26-13 Dynamic Prediction</p><pre class="oac_no_warn" dir="ltr">SELECT cust_id, age, pred_age, age-pred_age age_diff, pred_det FROM
 (SELECT cust_id, age, pred_age, pred_det,
    RANK() OVER (ORDER BY ABS(age-pred_age) DESC) rnk FROM
    (SELECT cust_id, age,
         <a id="d57501e693" class="indexterm-anchor"></a>PREDICTION(FOR age USING *) OVER () pred_age,
         <a id="d57501e696" class="indexterm-anchor"></a>PREDICTION_DETAILS(FOR age ABS USING *) OVER () pred_det
  FROM mining_data_apply_v))
WHERE rnk &lt;= 5; 

CUST_ID  AGE   PRED_AGE AGE_DIFF PRED_DET
------- ---- ---------- -------- --------------------------------------------------------------
 100910   80 40.6686505    39.33 &lt;Details algorithm="Support Vector Machines"&gt;
                                 &lt;Attribute name="HOME_THEATER_PACKAGE" actualValue="1"
                                  weight=".059" rank="1"/&gt;
                                 &lt;Attribute name="Y_BOX_GAMES" actualValue="0"
                                  weight=".059" rank="2"/&gt;
                                 &lt;Attribute name="AFFINITY_CARD" actualValue="0"
                                  weight=".059" rank="3"/&gt;
                                 &lt;Attribute name="FLAT_PANEL_MONITOR" actualValue="1"
                                  weight=".059" rank="4"/&gt;
                                 &lt;Attribute name="YRS_RESIDENCE" actualValue="4"
                                  weight=".059" rank="5"/&gt;
                                  &lt;/Details&gt;
 
 101285   79 42.1753571    36.82 &lt;Details algorithm="Support Vector Machines"&gt;
                                 &lt;Attribute name="HOME_THEATER_PACKAGE" actualValue="1"
                                  weight=".059" rank="1"/&gt;
                                 &lt;Attribute name="HOUSEHOLD_SIZE" actualValue="2" weight=".059"
                                  rank="2"/&gt;
                                 &lt;Attribute name="CUST_MARITAL_STATUS" actualValue="Mabsent"
                                  weight=".059" rank="3"/&gt;
                                 &lt;Attribute name="Y_BOX_GAMES" actualValue="0" weight=".059"
                                  rank="4"/&gt;
                                 &lt;Attribute name="OCCUPATION" actualValue="Prof." weight=".059"
                                  rank="5"/&gt;
                                 &lt;/Details&gt;
 
 100694   77 41.0396722    35.96 &lt;Details algorithm="Support Vector Machines"&gt;
                                 &lt;Attribute name="HOME_THEATER_PACKAGE" actualValue="1"
                                  weight=".059" rank="1"/&gt;
                                 &lt;Attribute name="EDUCATION" actualValue="&amp;lt; Bach."
                                  weight=".059" rank="2"/&gt;
                                 &lt;Attribute name="Y_BOX_GAMES" actualValue="0" weight=".059"
                                  rank="3"/&gt;
                                 &lt;Attribute name="CUST_ID" actualValue="100694" weight=".059"
                                  rank="4"/&gt;
                                 &lt;Attribute name="COUNTRY_NAME" actualValue="United States of
                                  America" weight=".059" rank="5"/&gt;
                                 &lt;/Details&gt;
 
 100308   81 45.3252491    35.67 &lt;Details algorithm="Support Vector Machines"&gt;
                                 &lt;Attribute name="HOME_THEATER_PACKAGE" actualValue="1"
                                  weight=".059" rank="1"/&gt;
                                 &lt;Attribute name="Y_BOX_GAMES" actualValue="0" weight=".059"
                                  rank="2"/&gt;
                                 &lt;Attribute name="HOUSEHOLD_SIZE" actualValue="2" weight=".059"
                                  rank="3"/&gt;
                                 &lt;Attribute name="FLAT_PANEL_MONITOR" actualValue="1"
                                  weight=".059" rank="4"/&gt;
                                 &lt;Attribute name="CUST_GENDER" actualValue="F" weight=".059"
                                  rank="5"/&gt;
                                 &lt;/Details&gt;
 
 101256   90 54.3862214    35.61 &lt;Details algorithm="Support Vector Machines"&gt;
                                 &lt;Attribute name="YRS_RESIDENCE" actualValue="9" weight=".059"
                                  rank="1"/&gt;
                                 &lt;Attribute name="HOME_THEATER_PACKAGE" actualValue="1"
                                  weight=".059" rank="2"/&gt;
                                 &lt;Attribute name="EDUCATION" actualValue="&amp;lt; Bach."
                                  weight=".059" rank="3"/&gt;
                                 &lt;Attribute name="Y_BOX_GAMES" actualValue="0" weight=".059"
                                  rank="4"/&gt;
                                 &lt;Attribute name="COUNTRY_NAME" actualValue="United States of
                                  America" weight=".059" rank="5"/&gt;
                                 &lt;/Details&gt;</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="DMPRG244"></a><a id="DMPRG842"></a><a id="DMPRG243"></a><div class="props_rev_3"><a id="GUID-CA99161A-9A1C-4736-855D-98356E451783" name="GUID-CA99161A-9A1C-4736-855D-98356E451783"></a><h3 id="DMAPI-GUID-CA99161A-9A1C-4736-855D-98356E451783" class="sect3"><span class="enumeration_section">26.6 </span>Cost-Sensitive Decision Making
               </h3>
               <div>
                  <p>Costs are user-specified numbers that bias Classification. The algorithm uses positive numbers to penalize more expensive outcomes over less expensive outcomes. Higher numbers indicate higher costs. </p>
                  <p><a id="d57501e722" class="indexterm-anchor"></a>The algorithm uses negative numbers to favor more beneficial outcomes over less beneficial outcomes. Lower negative numbers indicate higher benefits.
                  </p>
                  <p>All classification algorithms can use costs for scoring. You can specify the costs in a cost matrix table, or you can specify the costs inline when scoring. If you specify costs inline and the model also has an associated cost matrix, only the inline costs are used. The <code class="codeph">PREDICTION</code>, <code class="codeph">PREDICTION_SET</code>, and <code class="codeph">PREDICTION_COST</code> functions support costs. 
                  </p>
                  <p>Only the Decision Tree algorithm can use costs to bias the model build. If you want to create a Decision Tree model with costs, create a cost matrix table and provide its name in the <code class="codeph">CLAS_COST_TABLE_NAME</code> setting for the model. If you specify costs when building the model, the cost matrix used to create the model is used when scoring. If you want to use a different cost matrix table for scoring, first remove the existing cost matrix table then add the new one.
                  </p>
                  <p>A sample <a id="d57501e745" class="indexterm-anchor"></a>cost matrix table is shown in the following table. The cost matrix specifies costs for a binary target. The matrix indicates that the algorithm must treat a misclassified 0 as twice as costly as a misclassified 1.
                  </p>
                  <div class="tblformal" id="GUID-CA99161A-9A1C-4736-855D-98356E451783__BABECBFD">
                     <p class="titleintable">Table 26-1 Sample Cost Matrix</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="Sample Cost Matrix" summary="Columns of a cost matrix table" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="36%" id="d57501e759">ACTUAL_TARGET_VALUE</th>
                              <th align="left" valign="bottom" width="39%" id="d57501e762">PREDICTED_TARGET_VALUE</th>
                              <th align="left" valign="bottom" width="25%" id="d57501e765">COST</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="36%" id="d57501e770" headers="d57501e759 ">
                                 <p>0</p>
                              </td>
                              <td align="left" valign="top" width="39%" headers="d57501e770 d57501e762 ">
                                 <p>0</p>
                              </td>
                              <td align="left" valign="top" width="25%" headers="d57501e770 d57501e765 ">
                                 <p>0</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="36%" id="d57501e780" headers="d57501e759 ">
                                 <p>0</p>
                              </td>
                              <td align="left" valign="top" width="39%" headers="d57501e780 d57501e762 ">
                                 <p>1</p>
                              </td>
                              <td align="left" valign="top" width="25%" headers="d57501e780 d57501e765 ">
                                 <p>2</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="36%" id="d57501e790" headers="d57501e759 ">
                                 <p>1</p>
                              </td>
                              <td align="left" valign="top" width="39%" headers="d57501e790 d57501e762 ">
                                 <p>0</p>
                              </td>
                              <td align="left" valign="top" width="25%" headers="d57501e790 d57501e765 ">
                                 <p>1</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="36%" id="d57501e800" headers="d57501e759 ">
                                 <p>1</p>
                              </td>
                              <td align="left" valign="top" width="39%" headers="d57501e800 d57501e762 ">
                                 <p>1</p>
                              </td>
                              <td align="left" valign="top" width="25%" headers="d57501e800 d57501e765 ">
                                 <p>0</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="example" id="GUID-CA99161A-9A1C-4736-855D-98356E451783__GUID-A0ED8C05-A339-4A9D-90A0-8F65EA025C79">
                     <p class="titleinexample">Example 26-14 Sample Queries With Costs</p>
                     <p>The table <code class="codeph">nbmodel_costs</code> contains the cost matrix described in <a href="scoring-deployment.html#GUID-CA99161A-9A1C-4736-855D-98356E451783__BABECBFD" title="Columns of a cost matrix table">Table 26-1</a>.
                     </p><pre class="oac_no_warn" dir="ltr">SELECT * from nbmodel_costs;

ACTUAL_TARGET_VALUE PREDICTED_TARGET_VALUE       COST
------------------- ---------------------- ----------
                  0                      0          0
                  0                      1          2
                  1                      0          1
                  1                      1          0
</pre><p>The following statement associates the cost matrix with a Naive Bayes model called <code class="codeph">nbmodel.</code></p><pre class="oac_no_warn" dir="ltr">BEGIN
  dbms_data_mining.add_cost_matrix('nbmodel', 'nbmodel_costs');
END;
/
</pre><p>The following query takes the cost matrix into account when scoring <code class="codeph">mining_data_apply_v</code>. The output is restricted to those rows where a prediction of 1 is less costly then a prediction of 0.
                     </p><pre class="oac_no_warn" dir="ltr">SELECT cust_gender, COUNT(*) AS cnt, ROUND(AVG(age)) AS avg_age
    	FROM mining_data_apply_v
    	WHERE PREDICTION (nbmodel COST MODEL
       USING cust_marital_status, education, household_size) = 1
    	GROUP BY cust_gender
    	ORDER BY cust_gender;
 
C        CNT    AVG_AGE
- ---------- ----------
F         25         38
M        208         43
</pre><p>You can specify costs inline when you invoke the scoring function. If you specify costs inline and the model also has an associated cost matrix, only the inline costs are used. The same query is shown below with different costs specified inline. Instead of the "2" shown in the cost matrix table (<a href="scoring-deployment.html#GUID-CA99161A-9A1C-4736-855D-98356E451783__BABECBFD" title="Columns of a cost matrix table">Table 26-1</a>), "10" is specified in the inline costs.
                     </p><pre class="oac_no_warn" dir="ltr">SELECT cust_gender, COUNT(*) AS cnt, ROUND(AVG(age)) AS avg_age
  	FROM mining_data_apply_v
  	WHERE PREDICTION (nbmodel
  			  COST (0,1) values ((0, 10),
  					     (1, 0))
  			  USING cust_marital_status, education, household_size) = 1
  	GROUP BY cust_gender
  	ORDER BY cust_gender;
 
C        CNT    AVG_AGE
- ---------- ----------
F         74         39
M        581         43
</pre><p>The same query based on probability instead of costs is shown below.</p><pre class="oac_no_warn" dir="ltr">SELECT cust_gender, COUNT(*) AS cnt, ROUND(AVG(age)) AS avg_age
    	FROM mining_data_apply_v
    	WHERE PREDICTION (nbmodel
    	   USING cust_marital_status, education, household_size) = 1
    	GROUP BY cust_gender
    	ORDER BY cust_gender;
 
C        CNT    AVG_AGE
- ---------- ----------
F         73         39
M        577         44
</pre></div>
                  <!-- class="example" -->
               </div>
               <div></div>
            </div><a id="DMPRG246"></a><a id="DMPRG247"></a><a id="DMPRG245"></a><div class="props_rev_3"><a id="GUID-08557F7B-217F-4C96-833B-D4AAA613D90B" name="GUID-08557F7B-217F-4C96-833B-D4AAA613D90B"></a><h3 id="DMAPI-GUID-08557F7B-217F-4C96-833B-D4AAA613D90B" class="sect3"><span class="enumeration_section">26.7 </span>DBMS_DATA_MINING.Apply 
               </h3>
               <div>
                  <p>The <code class="codeph">APPLY</code> procedure in <code class="codeph">DBMS_DATA_MINING</code> is a batch apply operation that writes the results of scoring directly to a table.
                  </p>
                  <p>The columns in the table are mining function-dependent.</p>
                  <p>Scoring with <code class="codeph">APPLY</code> generates the same results as scoring with the SQL scoring functions. Classification produces a prediction and a probability for each case; clustering produces a cluster ID and a probability for each case, and so on. The difference lies in the way that scoring results are captured and the mechanisms that can be used for retrieving them.
                  </p>
                  <p><code class="codeph">APPLY</code> creates an output table with the columns shown in the following table:
                  </p>
                  <div class="tblformal" id="GUID-08557F7B-217F-4C96-833B-D4AAA613D90B__BABIHCEC">
                     <p class="titleintable">Table 26-2 APPLY Output Table</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="APPLY Output Table" summary="Columns in Apply output table" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="47%" id="d57501e905">Mining Function</th>
                              <th align="left" valign="bottom" width="53%" id="d57501e908">Output Columns</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="47%" id="d57501e913" headers="d57501e905 ">
                                 <p>classification</p>
                              </td>
                              <td align="left" valign="top" width="53%" headers="d57501e913 d57501e908 ">
                                 <p><code class="codeph">CASE_ID</code></p>
                                 <p><code class="codeph">PREDICTION</code></p>
                                 <p><code class="codeph">PROBABILITY</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="47%" id="d57501e927" headers="d57501e905 ">
                                 <p>regression</p>
                              </td>
                              <td align="left" valign="top" width="53%" headers="d57501e927 d57501e908 ">
                                 <p><code class="codeph">CASE_ID</code></p>
                                 <p><code class="codeph">PREDICTION</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="47%" id="d57501e938" headers="d57501e905 ">
                                 <p>anomaly detection</p>
                              </td>
                              <td align="left" valign="top" width="53%" headers="d57501e938 d57501e908 ">
                                 <p><code class="codeph">CASE_ID</code></p>
                                 <p><code class="codeph">PREDICTION</code></p>
                                 <p><code class="codeph">PROBABILITY</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="47%" id="d57501e952" headers="d57501e905 ">
                                 <p>clustering</p>
                              </td>
                              <td align="left" valign="top" width="53%" headers="d57501e952 d57501e908 ">
                                 <p><code class="codeph">CASE_ID</code></p>
                                 <p><code class="codeph">CLUSTER_ID</code></p>
                                 <p><code class="codeph">PROBABILITY</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="47%" id="d57501e966" headers="d57501e905 ">
                                 <p>feature extraction</p>
                              </td>
                              <td align="left" valign="top" width="53%" headers="d57501e966 d57501e908 ">
                                 <p><code class="codeph">CASE_ID</code></p>
                                 <p><code class="codeph">FEATURE_ID</code></p>
                                 <p><code class="codeph">MATCH_QUALITY</code></p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p>Since <code class="codeph">APPLY</code> output is stored separately from the scoring data, it must be joined to the scoring data to support queries that include the scored rows. Thus any model that is used with <code class="codeph">APPLY</code> must have a case ID.
                  </p>
                  <p>A <a id="d57501e991" class="indexterm-anchor"></a>case ID is not required for models that is applied with SQL scoring functions. Likewise, storage and joins are not required, since scoring results are generated and consumed in real time within a SQL query.
                  </p>
                  <p>The following example illustrates <a id="d57501e996" class="indexterm-anchor"></a>Anomaly Detection with <code class="codeph">APPLY</code>. The query of the <code class="codeph">APPLY</code> output table returns the ten first customers in the table. Each has a a probability for being typical (1) and a probability for being anomalous (0).
                  </p>
                  <div class="example" id="GUID-08557F7B-217F-4C96-833B-D4AAA613D90B__CIHHGHDA">
                     <p class="titleinexample">Example 26-15 Anomaly Detection with DBMS_DATA_MINING.APPLY</p><pre class="oac_no_warn" dir="ltr">EXEC dbms_data_mining.apply
        ('SVMO_SH_Clas_sample','svmo_sh_sample_prepared', 
         'cust_id', 'one_class_output'); 

SELECT * from one_class_output where rownum &lt; 11;
 
   CUST_ID PREDICTION PROBABILITY
---------- ---------- -----------
    101798          1  .567389309
    101798          0  .432610691
    102276          1  .564922469
    102276          0  .435077531
    102404          1   .51213544
    102404          0   .48786456
    101891          1  .563474346
    101891          0  .436525654
    102815          0  .500663683
    102815          1  .499336317</pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="../arpls/DBMS_DATA_MINING.html#ARPLS-GUID-7D936294-87C0-4A6C-98EA-AD4FC5F7878F"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>