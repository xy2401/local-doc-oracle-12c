<!DOCTYPE html
  SYSTEM "about:legacy-compat">

<!-- saved from url=(0023)https://docs.oracle.com -->

<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Oracle SQL functions for updating XML data that are deprecated starting with Oracle Database 12c Release 1 (12.1.0.1) are described. Use XQuery Update instead to update XML data.">
      <meta name="description" content="Oracle SQL functions for updating XML data that are deprecated starting with Oracle Database 12c Release 1 (12.1.0.1) are described. Use XQuery Update instead to update XML data.">
      <title>Deprecated Functions for Updating XML Data</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Developer's Guide ">
      <meta property="og:description" content="Oracle SQL functions for updating XML data that are deprecated starting with Oracle Database 12c Release 1 (12.1.0.1) are described. Use XQuery Update instead to update XML data.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 17.8.1">
      <link rel="alternate" href="xml-db-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2017-11-27T10:00:52-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2002, 2017">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E85669-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/12.2">
      <meta name="dcterms.release" content="Release 12.2">
      <link rel="prev" href="XML-DB-restrictions.html" title="Previous" type="text/html">
      <link rel="next" href="deprecated-constructs-for-XML-translation.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">
            {
                "primary":
                {
                    "category":{
                      "short_name":"database",
                      "element_name":"Database",
                      "display_in_url":true
                    },
                    "suite":{
                      "short_name":"oracle",
                      "element_name":"Oracle",
                      "display_in_url":true
                    },
                    "product_group":{
                      "short_name":"not-applicable",
                      "element_name":"Not applicable",
                      "display_in_url":false
                    },
                    "product":{
                      "short_name":"oracle-database",
                      "element_name":"Oracle Database",
                      "display_in_url":true
                    },
                    "release":{
                      "short_name":"12.2",
                      "element_name":"Release 12.2",
                      "display_in_url":true
                    },
                    "platform":{
                      "short_name":"",
                      "element_name":"",
                      "display_in_url":false
                    },
                    "component":{
                      "short_name":"",
                      "element_name":"",
                      "display_in_url":false
                    }
                }
            }
            </script>
      
    <meta name="dcterms.title" content="XML DB Developer's Guide">
    <meta name="dcterms.isVersionOf" content="ADXDB">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="XML-DB-restrictions.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="deprecated-constructs-for-XML-translation.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Developer's Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="appendices.html" property="item" typeof="WebPage"><span property="name"> Appendixes </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Deprecated Functions for Updating XML Data</li>
            </ol>
            <a id="GUID-0FC4D071-65A4-4092-AE78-6F707F882E03" name="GUID-0FC4D071-65A4-4092-AE78-6F707F882E03"></a><a id="ADXDB6044"></a>
            
            <h2 id="ADXDB-GUID-0FC4D071-65A4-4092-AE78-6F707F882E03" class="sect2"><span class="enumeration_chapter">C </span>Deprecated Functions for Updating XML Data
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Oracle SQL functions for updating XML data that are <span class="italic">deprecated</span> starting with Oracle Database 12<span class="italic">c</span> Release 1 (12.1.0.1) are described. Use XQuery Update instead to update XML data.
               </p>
               <div class="section"></div>
               <!-- class="section" -->
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="deprecated-functions-for-updating-XML-data.html#GUID-8DFBDD92-2FD8-4F30-8B26-6E5FC22090F7">Migration from Oracle Functions for Updating XML Data to XQuery Update</a><br>The XQuery Update Facility 1.0 Recommendation is supported by Oracle XML&nbsp;DB starting with Oracle Database&nbsp;12c Release 1 (12.1.0.1). Prior to this release, to update XML data your queries necessarily used Oracle-specific SQL functions: <code class="codeph">appendChildXML</code>, <code class="codeph">deleteXML</code>, <code class="codeph">insertChildXML</code>, <code class="codeph">insertchildXMLafter</code>, <code class="codeph">insertChildXMLbefore</code>, <code class="codeph">insertXMLafter</code>, <code class="codeph">insertXMLbefore</code>, and <code class="codeph">updateXML</code>. 
                  </li>
                  <li class="ulchildlink"><a href="deprecated-functions-for-updating-XML-data.html#GUID-65A5282B-487A-4389-9C42-2F34FA80E0D6">Deprecated Oracle SQL Functions for Updating XML Data</a><br>Prior to their deprecation, you used Oracle SQL functions to update XML data incrementally — that is, to replace, insert, or delete XML data without replacing the entire surrounding XML document. This is also called <strong class="term">partial updating</strong>. 
                  </li>
                  <li class="ulchildlink"><a href="deprecated-functions-for-updating-XML-data.html#GUID-EFE0A8A0-7B0A-4F77-B70D-A2DABFC0BB9E">UPDATEXML Deprecated Oracle SQL Function</a><br>Deprecated Oracle SQL function <code class="codeph">updateXML</code> replaces XML nodes of any kind. The XML document that is the target of the update can be schema-based or non-schema-based. 
                  </li>
                  <li class="ulchildlink"><a href="deprecated-functions-for-updating-XML-data.html#GUID-505550EB-A598-40F4-BB73-12837E3D887C">Optimization of Deprecated Oracle SQL Functions that Modify XML Data</a><br>In most cases, the deprecated Oracle SQL functions that modify XML data materialize a copy of the entire input XML document in memory, then update the copy. However, functions <code class="codeph">updateXML</code>, <code class="codeph">insertChildXML</code>, <code class="codeph">insertChildXMLbefore</code>, <code class="codeph">insertChildXMLafter</code>, and <code class="codeph">deleteXML</code> — that is, all <span class="italic">except</span> <code class="codeph">insertXMLbefore</code>, <code class="codeph">insertXMLafter</code>, and <code class="codeph">appendChildXML</code> — are optimized for <code class="codeph">XMLType</code> <code class="codeph">UPDATE</code> operations. 
                  </li>
                  <li class="ulchildlink"><a href="deprecated-functions-for-updating-XML-data.html#GUID-646CDBD2-A1DC-4FC3-BF87-7E5D47B28005">Creating XML Views Using Deprecated Oracle SQL Functions that Modify XML Data</a><br>You can use the deprecated Oracle SQL functions that modify XML data (<code class="codeph">updateXML</code>, <code class="codeph">insertChildXML</code>, <code class="codeph">insertChildXMLbefore</code>, <code class="codeph">insertChildXMLafter</code>, <code class="codeph">insertXMLbefore</code>, <code class="codeph">insertXMLafter</code>, <code class="codeph">appendChildXML</code>, and <code class="codeph">deleteXML</code>) to create new views of XML data.
                  </li>
                  <li class="ulchildlink"><a href="deprecated-functions-for-updating-XML-data.html#GUID-23A699A3-B5F1-4BB1-A6FC-2D079398F8DD">INSERTCHILDXML Deprecated Oracle SQL Function</a><br>Deprecated Oracle SQL function <code class="codeph">insertChildXML</code> inserts new children (one or more elements of the same type or a single attribute) under parent XML elements. The XML document that is the target of the insertion can be XML Schema-based or non-schema-based. 
                  </li>
                  <li class="ulchildlink"><a href="deprecated-functions-for-updating-XML-data.html#GUID-B71A91D0-7DE0-4B86-BEBC-CE0080D3A8D7">INSERTCHILDXMLBEFORE Deprecated Oracle SQL Function</a><br>Deprecated Oracle SQL function <code class="codeph">insertChildXMLbefore</code> inserts one or more collection elements as children of target parent elements. The insertion for each target occurs immediately before a specified existing collection element. The existing XML document that is the target of the insertion can be XML Schema-based or non-schema-based. 
                  </li>
                  <li class="ulchildlink"><a href="deprecated-functions-for-updating-XML-data.html#GUID-38E1764C-91A1-448A-A485-B01A2172CACD">INSERTCHILDXMLAFTER Deprecated Oracle SQL Function</a><br>Deprecated Oracle SQL function <code class="codeph">insertChildXMLafter</code> inserts one or more collection elements as children of target parent elements. The insertion for each target occurs immediately after a specified existing collection element. The existing XML document that is the target of the insertion can be XML Schema-based or non-schema-based. 
                  </li>
                  <li class="ulchildlink"><a href="deprecated-functions-for-updating-XML-data.html#GUID-9C56911D-B8B9-4C3D-A90F-F471C5DB3C8F">INSERTXMLBEFORE Deprecated Oracle SQL Function</a><br>Deprecated Oracle SQL function <code class="codeph">insertXMLbefore</code> inserts one or more nodes of any kind immediately before a target node that is not an attribute node. The XML document that is the target of the insertion can be XML Schema-based or non-schema-based. 
                  </li>
                  <li class="ulchildlink"><a href="deprecated-functions-for-updating-XML-data.html#GUID-A9632F5C-6BB3-4AF6-B01E-92C4FD562C3B">INSERTXMLAFTER Deprecated Oracle SQL Function</a><br>Deprecated Oracle SQL function <code class="codeph">insertXMLafter</code> inserts one or more nodes of any kind immediately after a target node that is not an attribute node. The XML document that is the target of the insertion can be XML Schema-based or non-schema-based. 
                  </li>
                  <li class="ulchildlink"><a href="deprecated-functions-for-updating-XML-data.html#GUID-7F8F13A6-493A-4831-B698-0FCC07508222">APPENDCHILDXML Deprecated Oracle SQL Function</a><br>Deprecated Oracle SQL function <code class="codeph">appendChildXML</code> inserts one or more nodes of any kind as the last children of a given element node. The XML document that is the target of the insertion can be XML Schema-based or non-schema-based. 
                  </li>
                  <li class="ulchildlink"><a href="deprecated-functions-for-updating-XML-data.html#GUID-4E781DD7-B60E-49A5-8238-9E7CD207238B">DELETEXML Deprecated Oracle SQL Function</a><br>Deprecated Oracle SQL function <code class="codeph">deleteXML</code> deletes XML nodes of any kind. The XML document that is the target of the deletion can be XML Schema-based or non-schema-based. 
                  </li>
               </ul>
               <div class="relinfo">
                  <p><strong>Related Topics</strong></p>
                  <ul>
                     <li><a href="xquery-and-XML-DB.html#GUID-4F83A835-C94B-4D62-999B-111AB5E8A8F1" title="The XQuery language is one of the main ways that you interact with XML data in Oracle XML&nbsp;DB. Support for the language includes SQL*Plus commandXQUERY and SQL/XML functions XMLQuery, XMLTable, XMLExists, and XMLCast.">XQuery and Oracle XML&nbsp;DB</a></li>
                  </ul>
               </div>
            </div>
            <a id="ADXDB6160"></a><a id="ADXDB6159"></a><div class="props_rev_3"><a id="GUID-8DFBDD92-2FD8-4F30-8B26-6E5FC22090F7" name="GUID-8DFBDD92-2FD8-4F30-8B26-6E5FC22090F7"></a><h3 id="ADXDB-GUID-8DFBDD92-2FD8-4F30-8B26-6E5FC22090F7" class="sect3"><span class="enumeration_section">C.1 </span>Migration from Oracle Functions for Updating XML Data to XQuery Update
               </h3>
               <div>
                  <p>The XQuery Update Facility 1.0 Recommendation is supported by Oracle XML&nbsp;DB starting with Oracle Database&nbsp;12c Release 1 (12.1.0.1). Prior to this release, to update XML data your queries necessarily used Oracle-specific SQL functions: <code class="codeph">appendChildXML</code>, <code class="codeph">deleteXML</code>, <code class="codeph">insertChildXML</code>, <code class="codeph">insertchildXMLafter</code>, <code class="codeph">insertChildXMLbefore</code>, <code class="codeph">insertXMLafter</code>, <code class="codeph">insertXMLbefore</code>, and <code class="codeph">updateXML</code>. 
                  </p>
                  <p>These functions are covered in detail in the other sections of this appendix.</p>
                  <p>If you have legacy code that uses these functions, Oracle recommends that you migrate that code to use XQuery Update. This section provides information about which XQuery Update constructs you can use to replace the use of the Oracle-specific XML updating functions in queries.</p>
                  <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-8DFBDD92-2FD8-4F30-8B26-6E5FC22090F7__CIHEAEBF" title="This table shows mapping from typical queries that use Oracle-specific updating SQL functions to queries that use XQuery Update.">Table C-1</a> provides a mapping from typical queries that use Oracle-specific updating SQL functions to queries that use XQuery Update. 
                  </p>
                  <p>There is no Oracle-specific equivalent for the XQuery Update constructs <code class="codeph">rename</code> and <code class="codeph">insert as first into</code>. 
                  </p>
                  <p>Note too that if the target XPath expression matches more than one node then the Oracle updating functions act on <span class="italic">all</span> such nodes, whereas the XQuery Update functions raise an error in this case. To act on multiple nodes using XQuery Update you need to use explicit iteration (that is, a <code class="codeph">for</code> expression).
                  </p>
                  <div class="tblformalwide" id="GUID-8DFBDD92-2FD8-4F30-8B26-6E5FC22090F7__CIHEAEBF">
                     <p class="titleintable">Table C-1 Migrating Oracle-Specific XML Updating Queries to XQuery Update</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="Migrating Oracle-Specific XML Updating Queries to XQuery Update" summary=" This table shows mapping from typical queries that use Oracle-specific updating SQL functions to queries that use XQuery Update." width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="50%" id="d169707e347">Original Expression</th>
                              <th align="left" valign="bottom" width="50%" id="d169707e350">Replacement Expression</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d169707e355" headers="d169707e347 "><pre class="pre codeblock"><code>-- Insert a node as the last child of a node.
UPDATE warehouses SET warehouse_spec =
  <span class="bold">appendChildXML</span>(
    warehouse_spec,
    '/Warehouse/Parking',
    XMLType('&lt;Spaces&gt;250&lt;/Spaces&gt;'));</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d169707e355 d169707e350 "><pre class="pre codeblock"><code>-- Insert a node as the last child of a node.
UPDATE warehouses SET warehouse_spec =
  XMLQuery('copy $tmp := . modify <span class="bold">insert</span> node 
            &lt;Spaces&gt;250&lt;/Spaces&gt;
            <span class="bold">as last</span> into $tmp/Warehouse/Parking
            return $tmp'
           PASSING warehouse_spec RETURNING CONTENT)
  WHERE warehouse_spec IS NOT NULL;</code></pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d169707e371" headers="d169707e347 "><pre class="pre codeblock"><code>-- Delete a node.
UPDATE warehouses SET warehouse_spec =
  <span class="bold">deleteXML</span>(value(po), '/Warehouse/VClearance');</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d169707e371 d169707e350 "><pre class="pre codeblock"><code>-- Delete a node.
UPDATE warehouses SET warehouse_spec =
  XMLQuery('copy $tmp := . modify <span class="bold">delete</span> node
            $tmp/Warehouse/VClearance return $tmp'
           PASSING warehouse_spec RETURNING CONTENT)
  WHERE warehouse_spec IS NOT NULL;</code></pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d169707e384" headers="d169707e347 "><pre class="pre codeblock"><code>-- Insert a node as a child of a node.
UPDATE warehouses SET warehouse_spec =
  <span class="bold">insertChildXML</span>(
    warehouse_spec,
    '/Warehouse/Parking',
    'Spaces',
    XMLType('&lt;Spaces&gt;300&lt;/Spaces&gt;');</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d169707e384 d169707e350 "><pre class="pre codeblock"><code>-- Insert a node as a child of a node.
UPDATE warehouses SET warehouse_spec =
  XMLQuery('copy $tmp := . modify <span class="bold">insert</span> node
            &lt;Spaces&gt;300&lt;/Spaces&gt;
            <span class="bold">into</span> $tmp/Warehouse/Parking
            return $tmp'
           PASSING warehouse_spec RETURNING CONTENT)
  WHERE warehouse_spec IS NOT NULL;</code></pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d169707e400" headers="d169707e347 "><pre class="pre codeblock"><code>-- Insert a node before a node.
UPDATE warehouses SET warehouse_spec = 
  <span class="bold">insertXMLbefore</span>(
    warehouse_spec, 
    '/Warehouse/RailAccess', 
    XMLType('&lt;SkyAccess&gt;N&lt;/SkyAccess&gt;');</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d169707e400 d169707e350 "><pre class="pre codeblock"><code>-- Insert a node before a node.
UPDATE warehouses SET warehouse_spec =
  XMLQuery('copy $tmp := . modify <span class="bold">insert</span> node
            &lt;SkyAccess&gt;N&lt;/SkyAccess&gt;
            <span class="bold">before</span> $tmp/Warehouse/RailAccess 
            return $tmp'
           PASSING warehouse_spec RETURNING CONTENT)
  WHERE warehouse_spec IS NOT NULL;</code></pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d169707e416" headers="d169707e347 "><pre class="pre codeblock"><code>-- Insert a node after a node.
UPDATE warehouses SET warehouse_spec = 
  <span class="bold">insertXMLafter</span>(
    warehouse_spec,
    '/Warehouse/RailAccess', 
    XMLType('&lt;SkyAccess&gt;N&lt;/SkyAccess&gt;');</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d169707e416 d169707e350 "><pre class="pre codeblock"><code>-- Insert a node after a node.
UPDATE warehouses SET warehouse_spec =
  XMLQuery('copy $tmp := . modify <span class="bold">insert</span> node 
            &lt;SkyAccess&gt;N&lt;/SkyAccess&gt;
            <span class="bold">after</span> $tmp/Warehouse/RailAccess 
            return $tmp'
           PASSING warehouse_spec RETURNING CONTENT)
  WHERE warehouse_spec IS NOT NULL;</code></pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d169707e432" headers="d169707e347 "><pre class="pre codeblock"><code>-- Replace the text value of a set of nodes.
-- (Assumes a collection of &lt;Building&gt; nodes.)
UPDATE warehouses SET warehouse_spec = 
  <span class="bold">updateXML</span>(warehouse_spec,  
            '/Warehouse/Building/text()',
            'Owned');</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d169707e432 d169707e350 "><pre class="pre codeblock"><code>-- Replace the text value of a set of nodes.
-- (Assumes a collection of &lt;Building&gt; nodes.)
UPDATE warehouses SET warehouse_spec =
  XMLQuery('copy $tmp := . modify
            (for $i in $tmp/Warehouse/Building/text()  
             return <span class="bold">replace value of</span> node $i
                    <span class="bold">with</span> ''Owned'') 
            return $tmp'
           PASSING warehouse_spec RETURNING CONTENT)
  WHERE warehouse_spec IS NOT NULL;</code></pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d169707e448" headers="d169707e347 "><pre class="pre codeblock"><code>-- Insert a child under each node in a collection.
-- (Assumes a collection of &lt;Building&gt; nodes.)
UPDATE warehouses SET warehouse_spec = 
  <span class="bold">insertChildXML</span>(
    warehouse_spec, 
    '/Warehouse/Building',
    'Owner', 
    XMLType('&lt;Owner&gt;LesserCo&lt;/Owner&gt;'));</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d169707e448 d169707e350 "><pre class="pre codeblock"><code>-- Insert a child under each node in a collection.
-- (Assumes a collection of &lt;Building&gt; nodes.)
UPDATE warehouses SET warehouse_spec =
  XMLQuery('copy $tmp := . modify
            (for $i in $tmp/Warehouse/Building
             return <span class="bold">insert</span> node       
             &lt;Owner&gt;LesserCo&lt;/Owner&gt;
             <span class="bold">into</span> $i)
            return $tmp'
           PASSING warehouse_spec RETURNING CONTENT)
  WHERE warehouse_spec IS NOT NULL;</code></pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d169707e464" headers="d169707e347 "><pre class="pre codeblock"><code>-- Insert as child before the other children.
-- (Assumes a collection of &lt;Owner&gt; nodes.)
UPDATE warehouses SET warehouse_spec = 
  <span class="bold">insertChildXMLbefore</span>(
    warehouse_spec, 
    '/Warehouse/Building[1]',
    'Owner', 
    XMLType('&lt;Owner&gt;LesserCo&lt;/Owner&gt;'));</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d169707e464 d169707e350 "><pre class="pre codeblock"><code>-- Insert as child before the other children.
-- (Assumes a collection of &lt;Owner&gt; nodes.)
UPDATE warehouses SET warehouse_spec =
  XMLQuery(
    'copy $tmp := . modify
     (for $i in $tmp/Warehouse/Building[1]/Owner
      return <span class="bold">insert</span> node &lt;Owner&gt;LesserCo&lt;/Owner&gt;
             <span class="bold">before</span> $i)
     return $tmp'
    PASSING warehouse_spec RETURNING CONTENT)
  WHERE warehouse_spec IS NOT NULL;</code></pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d169707e480" headers="d169707e347 "><pre class="pre codeblock"><code>-- Insert as child after the other children.
-- (Assumes a collection of &lt;Owner&gt; nodes.)
UPDATE warehouses SET warehouse_spec =
  <span class="bold">insertChildXMLafter</span>(
    warehouse_spec, 
    '/Warehouse/Building[1]',
    'Owner', 
    XMLType('&lt;Owner&gt;LesserCo&lt;/Owner&gt;'));</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d169707e480 d169707e350 "><pre class="pre codeblock"><code>-- Insert as child after the other children.
-- (Assumes a collection of &lt;Owner&gt; nodes.)
UPDATE warehouses SET warehouse_spec =
  XMLQuery(
    'copy $tmp := . modify
     (for $i in $tmp/Warehouse/Building[1]/Owner
      return <span class="bold">insert</span> node &lt;Owner&gt;LesserCo&lt;/Owner&gt;
             <span class="bold">after</span> $i)
     return $tmp'
    PASSING warehouse_spec RETURNING CONTENT)
  WHERE warehouse_spec IS NOT NULL;</code></pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d169707e496" headers="d169707e347 "><pre class="pre codeblock"><code>-- Delete a node.
UPDATE warehouses SET warehouse_spec = 
  <span class="bold">updateXML</span>(warehouse_spec,
            '/Warehouse/Docks',
            <span class="bold">NULL</span>);</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d169707e496 d169707e350 "><pre class="pre codeblock"><code>-- Delete a node.
UPDATE warehouses SET warehouse_spec =
  XMLQuery('copy $tmp := . modify <span class="bold">delete node</span> 
            $tmp/Warehouse/Docks return $tmp'
           PASSING warehouse_spec RETURNING CONTENT)
  WHERE warehouse_spec IS NOT NULL;</code></pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d169707e512" headers="d169707e347 "><pre class="pre codeblock"><code>-- Replace with an empty node.
UPDATE warehouses SET warehouse_spec = 
  <span class="bold">updateXML</span>(warehouse_spec, '/Warehouse/Docks', <span class="bold">''</span> );</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d169707e512 d169707e350 "><pre class="pre codeblock"><code>-- Replace with an empty node.
UPDATE warehouses SET warehouse_spec =
  XMLQuery('copy $tmp := $p1 modify
            (for $j in $tmp/Warehouse/Docks
             return <span class="bold">replace node</span> $j with $p2)
            return $tmp'
           PASSING warehouse_spec "p1", <span class="bold">''</span> AS "p2" 
           RETURNING CONTENT)
  WHERE warehouse_spec IS NOT NULL;</code></pre></td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="50%" id="d169707e532" headers="d169707e347 "><pre class="pre codeblock"><code>-- Update multiple paths.
UPDATE warehouses SET warehouse_spec = 
  <span class="bold">updateXML</span>(warehouse_spec,  
            '/Warehouse/Docks/text()', '4',
            '/Warehouse/Area/text()', '3500');</code></pre></td>
                              <td align="left" valign="top" width="50%" headers="d169707e532 d169707e350 "><pre class="pre codeblock"><code>-- Update multiple paths.
UPDATE warehouses SET warehouse_spec =
  XMLQuery(
    'copy $tmp := . modify
     ((for $i in $tmp/Warehouse/Docks/text()  
       return <span class="bold">replace value of</span> node $i with 4),
      (for $i in $tmp/Warehouse/Area/text()  
       return <span class="bold">replace value of</span> node $i with 3500))
     return $tmp'
    PASSING warehouse_spec RETURNING CONTENT)
  WHERE warehouse_spec IS NOT NULL;</code></pre></td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
            </div><a id="ADXDB6045"></a><div class="props_rev_3"><a id="GUID-65A5282B-487A-4389-9C42-2F34FA80E0D6" name="GUID-65A5282B-487A-4389-9C42-2F34FA80E0D6"></a><h3 id="ADXDB-GUID-65A5282B-487A-4389-9C42-2F34FA80E0D6" class="sect3"><span class="enumeration_section">C.2 </span>Deprecated Oracle SQL Functions for Updating XML Data
               </h3>
               <div>
                  <p>Prior to their deprecation, you used Oracle SQL functions to update XML data incrementally — that is, to replace, insert, or delete XML data without replacing the entire surrounding XML document. This is also called <strong class="term">partial updating</strong>. 
                  </p>
                  <p>These are the deprecated Oracle SQL functions for updating XML data:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">updateXML</code> &#x2013; Replace XML nodes of any kind. 
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">insertChildXML</code> &#x2013; Insert XML element or attribute nodes as children of a given element node.
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">insertChildXMLbefore</code> &#x2013; Insert new collection elements immediately before a given collection element of the same type. 
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">insertChildXMLafter</code> &#x2013; Insert new collection elements immediately after a given collection element of the same type.
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">insertXMLbefore</code> &#x2013; Insert XML nodes of any kind immediately before a given node (other than an attribute node).
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">insertXMLafter</code> &#x2013; Insert XML nodes of any kind immediately after a given node (other than an attribute node).
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">appendChildXML</code> &#x2013; Insert XML nodes of any kind as the last child nodes of a given element node.
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">deleteXML</code> &#x2013; Delete XML nodes of any kind.
                        </p>
                     </li>
                  </ul>
                  <p>Functions <code class="codeph">insertChildXML</code>, <code class="codeph">insertChildXMLbefore</code>, <code class="codeph">insertChildXMLafter</code>, <code class="codeph">insertXMLbefore</code>, <code class="codeph">insertXMLafter</code>, and <code class="codeph">appendChildXML</code> are for inserting XML data. Function <code class="codeph">deleteXML</code> deletes XML data. Function <code class="codeph">updateXML</code> replaces XML data. 
                  </p>
                  <p>In particular, do <span class="italic">not</span> use function <code class="codeph">updateXML</code> to insert or delete XML data by replacing a parent node in its entirety. That works, but it is less efficient than using one of the other functions, which perform more localized updates.
                  </p>
                  <p>These Oracle SQL functions do <span class="italic">not</span>, by themselves, change database data &#x2013; they are all pure functions, without side effect. Each applies an XPath-expression argument to input XML data and returns a modified <span class="italic">copy</span> of the input XML data. You can then use that result with SQL DML operator <code class="codeph">UPDATE</code> to modify database data. This is no different from the way you use SQL function <code class="codeph">upper</code> to convert database data to uppercase: you must use a SQL DML operator such as <code class="codeph">UPDATE</code> to change the stored data.
                  </p>
                  <p>Each of these functions can be used on XML documents that are either schema-based or non-schema-based. For XML schema-based data, these Oracle SQL functions perform partial validation on the result, and, where appropriate, argument values are also checked for compatibility with the XML schema. </p>
                  <div class="infoboxnote" id="GUID-65A5282B-487A-4389-9C42-2F34FA80E0D6__GUID-981A69CD-9FFB-4BAA-A952-184F0254D064">
                     <p class="notep1">Note:</p>
                     <p>Oracle SQL functions and <code class="codeph">XMLType</code> methods respect the W3C XPath recommendation, which states that if an XPath expression targets <span class="italic">no nodes</span> when applied to XML data, then an empty sequence must be returned. An error must <span class="italic">not</span> be raised in this case. 
                     </p>
                     <p>The specific semantics of an Oracle SQL function or <code class="codeph">XMLType</code> method that applies an XPath expression to XML data determines what is returned. For example, SQL/XML function <code class="codeph">XMLQuery</code> returns <code class="codeph">NULL</code> if its XPath-expression argument targets no nodes, and the deprecated updating Oracle SQL functions, such as <code class="codeph">deleteXML</code>, return the input XML data unchanged. An error is never raised if no nodes are targeted, but the deprecated updating Oracle SQL functions can raise an error if an XPath-expression argument targets inappropriate nodes, such as attribute nodes or text nodes.
                     </p>
                  </div>
                  <div class="section"></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="deprecated-functions-for-updating-XML-data.html#GUID-5AFD9F2B-9107-474F-99E6-CBBA0307D92D">Insertion of XML Elements Using Deprecated Oracle SQL Functions</a><br>There are several deprecated Oracle SQL functions for inserting XML nodes into (a copy of) existing XML data. Each can insert nodes at multiple locations that are referenced by an XPath expression. They differ in the placement of the new nodes and how the target XML data is referenced.
                     </li>
                  </ul>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="transformation-and-validation-of-XMLType-data.html#GUID-BEF51F7F-33A8-4FED-AA21-FE8849821BEC" title="When you insert XML Schema-based documents into the database they can be validated partially or fully.">Partial and Full XML Schema Validation</a></li>
                        <li><a href="deprecated-functions-for-updating-XML-data.html#GUID-EFE0A8A0-7B0A-4F77-B70D-A2DABFC0BB9E" title="Deprecated Oracle SQL function updateXML replaces XML nodes of any kind. The XML document that is the target of the update can be schema-based or non-schema-based.">UPDATEXML Deprecated Oracle SQL Function</a></li>
                        <li><a href="deprecated-functions-for-updating-XML-data.html#GUID-23A699A3-B5F1-4BB1-A6FC-2D079398F8DD" title="Deprecated Oracle SQL function insertChildXML inserts new children (one or more elements of the same type or a single attribute) under parent XML elements. The XML document that is the target of the insertion can be XML Schema-based or non-schema-based.">INSERTCHILDXML Deprecated Oracle SQL Function</a></li>
                        <li><a href="deprecated-functions-for-updating-XML-data.html#GUID-B71A91D0-7DE0-4B86-BEBC-CE0080D3A8D7" title="Deprecated Oracle SQL function insertChildXMLbefore inserts one or more collection elements as children of target parent elements. The insertion for each target occurs immediately before a specified existing collection element. The existing XML document that is the target of the insertion can be XML Schema-based or non-schema-based.">INSERTCHILDXMLBEFORE Deprecated Oracle SQL Function</a></li>
                        <li><a href="deprecated-functions-for-updating-XML-data.html#GUID-38E1764C-91A1-448A-A485-B01A2172CACD" title="Deprecated Oracle SQL function insertChildXMLafter inserts one or more collection elements as children of target parent elements. The insertion for each target occurs immediately after a specified existing collection element. The existing XML document that is the target of the insertion can be XML Schema-based or non-schema-based.">INSERTCHILDXMLAFTER Deprecated Oracle SQL Function</a></li>
                        <li><a href="deprecated-functions-for-updating-XML-data.html#GUID-9C56911D-B8B9-4C3D-A90F-F471C5DB3C8F" title="Deprecated Oracle SQL function insertXMLbefore inserts one or more nodes of any kind immediately before a target node that is not an attribute node. The XML document that is the target of the insertion can be XML Schema-based or non-schema-based.">INSERTXMLBEFORE Deprecated Oracle SQL Function</a></li>
                        <li><a href="deprecated-functions-for-updating-XML-data.html#GUID-A9632F5C-6BB3-4AF6-B01E-92C4FD562C3B" title="Deprecated Oracle SQL function insertXMLafter inserts one or more nodes of any kind immediately after a target node that is not an attribute node. The XML document that is the target of the insertion can be XML Schema-based or non-schema-based.">INSERTXMLAFTER Deprecated Oracle SQL Function</a></li>
                        <li><a href="deprecated-functions-for-updating-XML-data.html#GUID-7F8F13A6-493A-4831-B698-0FCC07508222" title="Deprecated Oracle SQL function appendChildXML inserts one or more nodes of any kind as the last children of a given element node. The XML document that is the target of the insertion can be XML Schema-based or non-schema-based.">APPENDCHILDXML Deprecated Oracle SQL Function</a></li>
                        <li><a href="deprecated-functions-for-updating-XML-data.html#GUID-4E781DD7-B60E-49A5-8238-9E7CD207238B" title="Deprecated Oracle SQL function deleteXML deletes XML nodes of any kind. The XML document that is the target of the deletion can be XML Schema-based or non-schema-based.">DELETEXML Deprecated Oracle SQL Function</a></li>
                     </ul>
                  </div>
               </div>
               <a id="ADXDB6046"></a><div class="props_rev_3"><a id="GUID-5AFD9F2B-9107-474F-99E6-CBBA0307D92D" name="GUID-5AFD9F2B-9107-474F-99E6-CBBA0307D92D"></a><h4 id="ADXDB-GUID-5AFD9F2B-9107-474F-99E6-CBBA0307D92D" class="sect4"><span class="enumeration_section">C.2.1 </span>Insertion of XML Elements Using Deprecated Oracle SQL Functions
                  </h4>
                  <div>
                     <p>There are several deprecated Oracle SQL functions for inserting XML nodes into (a copy of) existing XML data. Each can insert nodes at multiple locations that are referenced by an XPath expression. They differ in the placement of the new nodes and how the target XML data is referenced.</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Function <code class="codeph">appendChildXML</code> appends nodes to the target elements. That is, for each target element, it inserts one or more nodes of any kind as the element's last children.
                           </p>
                        </li>
                        <li>
                           <p>Function <code class="codeph">insertChildXML</code> inserts new children (one or more elements of the same type or a single attribute) under target elements. The position of a new child element under its parent is not specified. If the target data is XML schema-based, then the schema can sometimes be used to determine the position. Otherwise, the position is arbitrary.
                           </p>
                        </li>
                        <li>
                           <p>Function <code class="codeph">insertXMLbefore</code> inserts one or more nodes of <span class="italic">any kind</span> immediately before a target node (which is not an attribute node). 
                           </p>
                           <p>Function <code class="codeph">insertXMLafter</code> inserts a node similarly, but after the target, not before.
                           </p>
                        </li>
                        <li>
                           <p>Function <code class="codeph">insertChildXMLbefore</code> is similar to <code class="codeph">insertChildXML</code>, except that the inserted node must be an element (not an attribute), and you specify the position of the new element among its siblings. It is similar to <code class="codeph">insertXMLbefore</code>, except that it inserts only <span class="italic">collection</span> elements, not arbitrary elements. The insertion position specifies a successor collection member. The actual element to be inserted must correspond to the element type for the collection.
                           </p>
                           <p>Function <code class="codeph">insertChildXMLafter</code> inserts a node similarly, but after the target, not before.
                           </p>
                        </li>
                     </ul>
                     <p>Though the effect of <code class="codeph">insertChildXMLbefore</code> (-<code class="codeph">after</code>) is similar to that of <code class="codeph">insertXMLbefore</code> (-<code class="codeph">after</code>), the target location is expressed differently. For the former, the target is the parent of the new child. For the latter, the target is the succeeding (or preceding) sibling. This difference is reflected in the function names (<code class="codeph">Child</code>).
                     </p>
                     <p>For example, to insert a new <code class="codeph">LineItem</code> element before the third <code class="codeph">LineItem</code> element under element <code class="codeph">/PurchaseOrder/LineItems</code>, you can use <code class="codeph">insertChildXMLbefore</code>, specifying the target parent as <code class="codeph">/PurchaseOrder/LineItems</code> and the succeeding sibling as <code class="codeph">LineItem[3]</code>. Or you can use <code class="codeph">insertXMLbefore</code>, specifying the target succeeding sibling as <code class="codeph">/PurchaseOrder/LineItems/LineItem[3]</code>. If you use <code class="codeph">insertChildXML</code> for the insertion, then you cannot specify the position of the new element in the collection — the resulting position is indeterminate.
                     </p>
                     <p>Another difference among these functions is that all of them <span class="italic">except</span> <code class="codeph">insertXMLbefore</code>, <code class="codeph">insertXMLafter</code>, and <code class="codeph">appendChildXML</code> —are optimized for SQL <code class="codeph">UPDATE</code> operations on <code class="codeph">XMLType</code> tables and columns that are stored object-relationally or as binary XML.
                     </p>
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="deprecated-functions-for-updating-XML-data.html#GUID-505550EB-A598-40F4-BB73-12837E3D887C" title="In most cases, the deprecated Oracle SQL functions that modify XML data materialize a copy of the entire input XML document in memory, then update the copy. However, functions updateXML, insertChildXML, insertChildXMLbefore, insertChildXMLafter, and deleteXML — that is, all except insertXMLbefore, insertXMLafter, and appendChildXML — are optimized for XMLType UPDATE operations.">Optimization of Deprecated Oracle SQL Functions that Modify XML Data</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
            </div><a id="ADXDB6048"></a><a id="ADXDB6049"></a><a id="ADXDB6050"></a><a id="ADXDB6051"></a><a id="ADXDB6047"></a><div class="props_rev_3"><a id="GUID-EFE0A8A0-7B0A-4F77-B70D-A2DABFC0BB9E" name="GUID-EFE0A8A0-7B0A-4F77-B70D-A2DABFC0BB9E"></a><h3 id="ADXDB-GUID-EFE0A8A0-7B0A-4F77-B70D-A2DABFC0BB9E" class="sect3"><span class="enumeration_section">C.3 </span>UPDATEXML Deprecated Oracle SQL Function
               </h3>
               <div>
                  <p>Deprecated Oracle SQL function <code class="codeph">updateXML</code> replaces XML nodes of any kind. The XML document that is the target of the update can be schema-based or non-schema-based. 
                  </p>
                  <p>A <span class="italic">copy</span> of the input <code class="codeph">XMLType</code> instance is modified and returned. The original data is unaffected. You can then use the returned data with SQL operation <code class="codeph">UPDATE</code> to modify database data.
                  </p>
                  <p>Function <code class="codeph">updateXML</code> has the following parameters (in order): 
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">target-data</code></span></span> (<code class="codeph">XMLType</code>) &#x2013; The XML data containing the target node to replace.
                        </p>
                     </li>
                     <li>
                        <p>One or more <span class="italic">pairs</span> of <span class="italic"><code class="codeph">xpath</code></span> and <span class="italic"><code class="codeph">replacement</code></span> parameters:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="italic"><span class="bold"><code class="codeph">xpath</code></span></span> (<code class="codeph">VARCHAR2</code>) &#x2013; An XPath&nbsp;1.0 expression that locates the nodes within <span class="italic"><code class="codeph">target-data</code></span> to replace. <span class="italic">Each</span> targeted node is replaced by <span class="italic"><code class="codeph">replacement</code></span>. These can be nodes of any kind. If <span class="italic"><code class="codeph">xpath</code></span> matches an empty sequence of nodes then no replacement is done, and <span class="italic"><code class="codeph">target-data</code></span> is returned unchanged (and no error is raised). 
                              </p>
                           </li>
                           <li>
                              <p><span class="italic"><span class="bold"><code class="codeph">replacement</code></span></span> (<code class="codeph">XMLType</code> or <code class="codeph">VARCHAR2</code>) &#x2013; The XML data that replaces the data targeted by <span class="italic"><code class="codeph">xpath</code></span>. The data type of <span class="italic"><code class="codeph">replacement</code></span> must correspond to the data to be replaced. If <span class="italic"><code class="codeph">xpath</code></span> targets an element node for replacement, then the data type must be <code class="codeph">XMLType</code>. If <span class="italic"><code class="codeph">xpath</code></span> targets an attribute node or a text node, then it must be <code class="codeph">VARCHAR2</code>. For an attribute node, <span class="italic"><code class="codeph">replacement</code></span> is only the replacement <span class="italic">value</span> of the attribute (for example, 23), not the complete attribute node including the name (for example, <code class="codeph">my_attribute="23"</code>).
                              </p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">namespace</code></span></span> (<code class="codeph">VARCHAR2</code>, <span class="italic">optional</span>) &#x2013; The XML namespace for parameter <span class="italic"><code class="codeph">xpath</code></span>.
                        </p>
                     </li>
                  </ul>
                  <p>Deprecated Oracle SQL function <code class="codeph">updateXML</code> can be used to <span class="italic">replace</span> existing elements, attributes, and other nodes with new values. It is <span class="italic">not</span> an efficient way to insert new nodes or delete existing ones. You can perform insertions and deletions with <code class="codeph">updateXML</code> only by using it to replace the entire node that is the parent of the node to be inserted or deleted.
                  </p>
                  <p>Function <code class="codeph">updateXML</code> updates only the transient XML instance in memory. Use a SQL <code class="codeph">UPDATE</code> statement to update data stored in tables. 
                  </p>
                  <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-EFE0A8A0-7B0A-4F77-B70D-A2DABFC0BB9E__BABEGCHA">Figure C-1</a> illustrates the syntax. 
                  </p>
                  <div class="figure" id="GUID-EFE0A8A0-7B0A-4F77-B70D-A2DABFC0BB9E__BABEGCHA">
                     <p class="titleinfigure">Figure C-1 UPDATEXML Syntax</p><img src="img/updatexml.gif" width="581" alt="Description of Figure C-1 follows" title="Description of Figure C-1 follows" longdesc="img_text/updatexml.html"><br><a href="img_text/updatexml.html">Description of "Figure C-1 UPDATEXML Syntax"</a></div>
                  <!-- class="figure" -->
                  <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-EFE0A8A0-7B0A-4F77-B70D-A2DABFC0BB9E__BABIHDJF">Example C-1</a> uses <code class="codeph">updateXML</code> on the right side of an <code class="codeph">UPDATE</code> statement to update the XML document in a table instead of creating a new document. The entire document is updated, not just the part that is selected.
                  </p>
                  <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-EFE0A8A0-7B0A-4F77-B70D-A2DABFC0BB9E__BABFIJJB">Example C-2</a> updates multiple nodes using Oracle SQL function <code class="codeph">updateXML</code>. 
                  </p>
                  <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-EFE0A8A0-7B0A-4F77-B70D-A2DABFC0BB9E__BABJBEAG">Example C-3</a> uses SQL function <code class="codeph">updateXML</code> to update selected nodes within a collection. 
                  </p>
                  <div class="example" id="GUID-EFE0A8A0-7B0A-4F77-B70D-A2DABFC0BB9E__BABIHDJF">
                     <p class="titleinexample">Example C-1 Updating XMLTYPE Using UPDATE and UPDATEXML (Deprecated)</p><pre class="pre codeblock"><code>SELECT XMLQuery('$p/PurchaseOrder/Actions/Action[1]' PASSING po.OBJECT_VALUE AS "p"
                                                     RETURNING CONTENT) action
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="SBELL-2002100912333601PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");
 
ACTION
--------------------------------
&lt;Action&gt;
  &lt;User&gt;SVOLLMAN&lt;/User&gt;
&lt;/Action&gt;

UPDATE purchaseorder po
  SET po.OBJECT_VALUE = <span class="bold">updateXML</span>(po.OBJECT_VALUE, 
                                  '/PurchaseOrder/Actions/Action[1]/User/text()',
                                  '<span class="bold">SKING</span>')
  WHERE XMLExists('$p/PurchaseOrder[Reference="SBELL-2002100912333601PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");
 
SELECT XMLQuery('$p/PurchaseOrder/Actions/Action[1]' PASSING po.OBJECT_VALUE AS "p"
                                                     RETURNING CONTENT) action
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="SBELL-2002100912333601PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");
 
ACTION
---------------------------------
&lt;Action&gt;
  &lt;User&gt;<span class="bold">SKING</span>&lt;/User&gt;
&lt;/Action&gt;
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-EFE0A8A0-7B0A-4F77-B70D-A2DABFC0BB9E__BABFIJJB">
                     <p class="titleinexample">Example C-2 Updating Multiple Text Nodes and Attribute Values Using UPDATEXML (Deprecated)</p><pre class="pre codeblock"><code>SELECT XMLCast(XMLQuery('$p/PurchaseOrder/Requestor'
                        PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
               AS VARCHAR2(30)) name,
       XMLQuery('$p/PurchaseOrder/LineItems'
                PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT) lineitems
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="SBELL-2002100912333601PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");
 
NAME             LINEITEMS
---------------- ------------------------------------------------------------------------
Sarah J. Bell    &lt;LineItems&gt;
                   &lt;LineItem ItemNumber="1"&gt;
                     &lt;Description&gt;A Night to Remember&lt;/Description&gt;
                     &lt;Part Id="715515009058" UnitPrice="39.95" Quantity="2"/&gt;
                   &lt;/LineItem&gt;
                   &lt;LineItem ItemNumber="2"&gt;
                     &lt;Description&gt;The Unbearable Lightness Of Being&lt;/Description&gt;
                     &lt;Part Id="37429140222" UnitPrice="29.95" Quantity="2"/&gt;
                   &lt;/LineItem&gt;
                   &lt;LineItem ItemNumber="3"&gt;
                     &lt;Description&gt;Sisters&lt;/Description&gt;
                     &lt;Part Id="715515011020" UnitPrice="29.95" Quantity="4"/&gt;
                   &lt;/LineItem&gt;
                 &lt;/LineItems&gt;

UPDATE purchaseorder
  SET OBJECT_VALUE = updateXML(OBJECT_VALUE,
                               '/PurchaseOrder/Requestor/text()','Stephen G. King',
                               '/PurchaseOrder/LineItems/LineItem[1]/Part/@Id','786936150421',
                               '/PurchaseOrder/LineItems/LineItem[1]/Description/text()','The Rock',
                               '/PurchaseOrder/LineItems/LineItem[3]',
                               XMLType('&lt;LineItem ItemNumber="99"&gt;
                                          &lt;Description&gt;Dead Ringers&lt;/Description&gt;
                                          &lt;Part Id="715515009249" UnitPrice="39.95" Quantity="2"/&gt;
                                        &lt;/LineItem&gt;'))
  WHERE XMLExists('$p/PurchaseOrder[Reference="SBELL-2002100912333601PDT"]'
                  PASSING OBJECT_VALUE AS "p");

SELECT XMLCast(XMLQuery('$p/PurchaseOrder/Requestor'
                        PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
               AS VARCHAR2(30)) name,
       XMLQuery('$p/PurchaseOrder/LineItems'
                PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT) lineitems
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="SBELL-2002100912333601PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");
 
NAME             LINEITEMS
---------------- ------------------------------------------------------------------
Stephen G. King  &lt;LineItems&gt;
                   &lt;LineItem ItemNumber="1"&gt;
                     &lt;Description&gt;The Rock&lt;/Description&gt;
                     &lt;Part Id="786936150421" UnitPrice="39.95" Quantity="2"/&gt;
                   &lt;/LineItem&gt;
                   &lt;LineItem ItemNumber="2"&gt;
                     &lt;Description&gt;The Unbearable Lightness Of Being&lt;/Description&gt;
                     &lt;Part Id="37429140222" UnitPrice="29.95" Quantity="2"/&gt;
                   &lt;/LineItem&gt;
                   &lt;LineItem ItemNumber="99"&gt;
                     &lt;Description&gt;Dead Ringers&lt;/Description&gt;
                     &lt;Part Id="715515009249" UnitPrice="39.95" Quantity="2"/&gt;
                   &lt;/LineItem&gt;
                 &lt;/LineItems&gt;
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-EFE0A8A0-7B0A-4F77-B70D-A2DABFC0BB9E__BABJBEAG">
                     <p class="titleinexample">Example C-3 Updating Selected Nodes within a Collection Using UPDATEXML (Deprecated)</p><pre class="oac_no_warn" dir="ltr">SELECT XMLCast(XMLQuery('$p/PurchaseOrder/Requestor'
                        PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
               AS VARCHAR2(30)) name,
       XMLQuery('$p/PurchaseOrder/LineItems'
                PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT) lineitems
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="SBELL-2002100912333601PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");
 
NAME             LINEITEMS
---------------- ----------------------------------------------------------------
Sarah J. Bell    &lt;LineItems&gt;
                   &lt;LineItem ItemNumber="1"&gt;
                     &lt;Description&gt;A Night to Remember&lt;/Description&gt;
                     &lt;Part Id="715515009058" UnitPrice="39.95" Quantity="2"/&gt;
                   &lt;/LineItem&gt;
                   &lt;LineItem ItemNumber="2"&gt;
                     &lt;Description&gt;The Unbearable Lightness Of Being&lt;/Description&gt;
                     &lt;Part Id="37429140222" UnitPrice="29.95" Quantity="2"/&gt;
                   &lt;/LineItem&gt;
                   &lt;LineItem ItemNumber="3"&gt;
                     &lt;Description&gt;Sisters&lt;/Description&gt;
                     &lt;Part Id="715515011020" UnitPrice="29.95" Quantity="4"/&gt;
                   &lt;/LineItem&gt;
                 &lt;/LineItems&gt;

UPDATE purchaseorder
  SET OBJECT_VALUE = 
      updateXML(OBJECT_VALUE,
                '/PurchaseOrder/Requestor/text()','Stephen G. King',
                '/PurchaseOrder/LineItems/LineItem/Part[@Id="715515009058"]/@Quantity',
                25,
                '/PurchaseOrder/LineItems/LineItem[Description/text() =
                                                   "The Unbearable Lightness Of Being"]',
                XMLType('&lt;LineItem ItemNumber="99"&gt;
                           &lt;Part Id="786936150421" Quantity="5" UnitPrice="29.95"/&gt;
                           &lt;Description&gt;The Rock&lt;/Description&gt;
                         &lt;/LineItem&gt;'))
  WHERE XMLExists('$p/PurchaseOrder[Reference="SBELL-2002100912333601PDT"]'
                  PASSING OBJECT_VALUE AS "p");

SELECT XMLCast(XMLQuery('$p/PurchaseOrder/Requestor'
                        PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
               AS VARCHAR2(30)) name,
       XMLQuery('$p/PurchaseOrder/LineItems'
                PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT) lineitems
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="SBELL-2002100912333601PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");
 
NAME             LINEITEMS
---------------- -------------------------------------------------------------
Stephen G. King  &lt;LineItems&gt;
                   &lt;LineItem ItemNumber="1"&gt;
                     &lt;Description&gt;A Night to Remember&lt;/Description&gt;
                     &lt;Part Id="715515009058" UnitPrice="39.95" Quantity="25"/&gt;
                   &lt;/LineItem&gt;
                   &lt;LineItem ItemNumber="99"&gt;
                     &lt;Part Id="786936150421" Quantity="5" UnitPrice="29.95"/&gt;
                     &lt;Description&gt;The Rock&lt;/Description&gt;
                   &lt;/LineItem&gt;
                   &lt;LineItem ItemNumber="3"&gt;
                     &lt;Description&gt;Sisters&lt;/Description&gt;
                     &lt;Part Id="715515011020" UnitPrice="29.95" Quantity="4"/&gt;
                   &lt;/LineItem&gt;
                 &lt;/LineItems&gt;</pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="deprecated-functions-for-updating-XML-data.html#GUID-5CD0462B-B427-4BA6-9AA9-66A7494F279A">Deprecated Oracle SQL Function UPDATEXML and NULL Values</a><br>Several considerations apply to using deprecated Oracle SQL function <code class="codeph">updateXML</code> with <code class="codeph">NULL</code> values.
                     </li>
                     <li class="ulchildlink"><a href="deprecated-functions-for-updating-XML-data.html#GUID-3235F02A-4E7D-4168-AD1B-6EF8F9A7D133">Update of the Same XML Node More Than Once Using UPDATEXML (Deprecated)</a><br>You can update the same XML node more than once in an <code class="codeph">updateXML</code> expression. The order of updates is determined by the order of the XPath expressions, in left-to-right order. Each successive update works on the result of the previous one. 
                     </li>
                     <li class="ulchildlink"><a href="deprecated-functions-for-updating-XML-data.html#GUID-7C22238D-7EA2-4EDB-8198-092C17824FEE">Guidelines for DOM Fidelity When Using UPDATEXML (Deprecated)</a><br>Guidelines are presented for DOM fidelity when using Oracle SQL function <code class="codeph">updateXML</code>.
                     </li>
                  </ul>
               </div>
               <a id="ADXDB6053"></a><a id="ADXDB6054"></a><a id="ADXDB6052"></a><div class="props_rev_3"><a id="GUID-5CD0462B-B427-4BA6-9AA9-66A7494F279A" name="GUID-5CD0462B-B427-4BA6-9AA9-66A7494F279A"></a><h4 id="ADXDB-GUID-5CD0462B-B427-4BA6-9AA9-66A7494F279A" class="sect4"><span class="enumeration_section">C.3.1 </span>Deprecated Oracle SQL Function UPDATEXML and NULL Values
                  </h4>
                  <div>
                     <p>Several considerations apply to using deprecated Oracle SQL function <code class="codeph">updateXML</code> with <code class="codeph">NULL</code> values.
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>If you update an XML <span class="italic">element</span> to <code class="codeph">NULL</code>, the attributes and children of the element are removed, and the element becomes empty. The type and namespace properties of the element are retained. See <a href="deprecated-functions-for-updating-XML-data.html#GUID-5CD0462B-B427-4BA6-9AA9-66A7494F279A__BABJCJHA">Example C-4</a>.
                           </p>
                        </li>
                        <li>
                           <p>If you update an <span class="italic">attribute</span> value to <code class="codeph">NULL</code>, the value appears as the empty string. See <a href="deprecated-functions-for-updating-XML-data.html#GUID-5CD0462B-B427-4BA6-9AA9-66A7494F279A__BABJCJHA">Example C-4</a>.
                           </p>
                        </li>
                        <li>
                           <p>If you update the <span class="italic">text</span> node of an element to <code class="codeph">NULL</code>, the content (text) of the element is removed. The element itself remains, but it is empty.<code class="codeph"></code> See <a href="deprecated-functions-for-updating-XML-data.html#GUID-5CD0462B-B427-4BA6-9AA9-66A7494F279A__BABEBCFG">Example C-5</a>.
                           </p>
                        </li>
                     </ul>
                     <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-5CD0462B-B427-4BA6-9AA9-66A7494F279A__BABJCJHA">Example C-4</a> updates all of the following to <code class="codeph">NULL</code>:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The <code class="codeph">Description</code> element and the <code class="codeph">Quantity</code> attribute of the <code class="codeph">LineItem</code> element whose <code class="codeph">Part</code> element has attribute <code class="codeph">Id</code> value 715515009058.
                           </p>
                        </li>
                        <li>
                           <p>The <code class="codeph">LineItem</code> element whose <code class="codeph">Description</code> element has the content (text) "The Unbearable Lightness Of Being".
                           </p>
                        </li>
                     </ul>
                     <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-5CD0462B-B427-4BA6-9AA9-66A7494F279A__BABEBCFG">Example C-5</a> updates the text node of a <code class="codeph">Part</code> element whose <code class="codeph">Description</code> attribute has value "<code class="codeph">A Night to Remember</code>" to <code class="codeph">NULL</code>. The XML data for this example corresponds to a different, revised purchase-order XML schema &#x2013; see <a href="XML-Schema-evolution.html#GUID-AD87A5C3-D0E8-4109-A6B2-F3F673D42FFD" title="An evolved version of a purchase-order XML schema is shown. It is used in examples that illustrate the use of copy-based XML schema evolution.">Scenario for Copy-Based Evolution</a>. In that XML schema, <code class="codeph">Description</code> is an attribute of the <code class="codeph">Part</code> element, not a sibling element. 
                     </p>
                     <div class="infoboxnotealso" id="GUID-5CD0462B-B427-4BA6-9AA9-66A7494F279A__GUID-3DEF06E9-FE92-4D58-AD0B-4EC6966EFD5E">
                        <p class="notep1">See Also:</p>
                        <p><a href="how-to-use-XML-DB.html#GUID-96D5EAC3-463F-48C0-BF3C-D051E0B174E8__CHDBGCBG">Example 3-26</a></p>
                     </div>
                     <div class="example" id="GUID-5CD0462B-B427-4BA6-9AA9-66A7494F279A__BABJCJHA">
                        <p class="titleinexample">Example C-4 NULL Updates with UPDATEXML (Deprecated) &#x2013; Element and Attribute</p><pre class="oac_no_warn" dir="ltr">SELECT XMLCast(XMLQuery('$p/PurchaseOrder/Requestor'
                        PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
               AS VARCHAR2(30)) name,
       XMLQuery('$p/PurchaseOrder/LineItems'
                PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT) lineitems
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="SBELL-2002100912333601PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");
 
NAME             LINEITEMS
---------------- -------------------------------------------------------------------
Sarah J. Bell    &lt;LineItems&gt;
                   &lt;LineItem ItemNumber="1"&gt;
                     &lt;Description&gt;A Night to Remember&lt;/Description&gt;
                     &lt;Part Id="715515009058" UnitPrice="39.95" Quantity="2"/&gt;
                   &lt;/LineItem&gt;
                   &lt;LineItem ItemNumber="2"&gt;
                     &lt;Description&gt;The Unbearable Lightness Of Being&lt;/Description&gt;
                     &lt;Part Id="37429140222" UnitPrice="29.95" Quantity="2"/&gt;
                   &lt;/LineItem&gt;
                   &lt;LineItem ItemNumber="3"&gt;
                     &lt;Description&gt;Sisters&lt;/Description&gt;
                     &lt;Part Id="715515011020" UnitPrice="29.95" Quantity="4"/&gt;
                   &lt;/LineItem&gt;
                 &lt;/LineItems&gt;

UPDATE purchaseorder
  SET OBJECT_VALUE = 
      updateXML(
        OBJECT_VALUE,
        '/PurchaseOrder/LineItems/LineItem[Part/@Id="715515009058"]/Description', NULL,
             '/PurchaseOrder/LineItems/LineItem/Part[@Id="715515009058"]/@Quantity', NULL,
        '/PurchaseOrder/LineItems/LineItem[Description/text()=
                                           "The Unbearable Lightness Of Being"]', NULL)
  WHERE XMLExists('$p/PurchaseOrder[Reference="SBELL-2002100912333601PDT"]'
                  PASSING OBJECT_VALUE AS "p");

SELECT XMLCast(XMLQuery('$p/PurchaseOrder/Requestor'
                        PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
               AS VARCHAR2(30)) name,
       XMLQuery('$p/PurchaseOrder/LineItems'
                PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT) lineitems
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="SBELL-2002100912333601PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");
 
NAME             LINEITEMS
---------------- ----------------------------------------------------------------
Sarah J. Bell    &lt;LineItems&gt;
                   &lt;LineItem ItemNumber="1"&gt;
                     <span class="bold">&lt;Description/&gt;</span>
                     &lt;Part Id="715515009058" UnitPrice="39.95" <span class="bold">Quantity=""</span>/&gt;
                   &lt;/LineItem&gt;
                   <span class="bold">&lt;LineItem/&gt;</span>
                   &lt;LineItem ItemNumber="3"&gt;
                     &lt;Description&gt;Sisters&lt;/Description&gt;
                     &lt;Part Id="715515011020" UnitPrice="29.95" Quantity="4"/&gt;
                   &lt;/LineItem&gt;
                 &lt;/LineItems&gt;</pre></div>
                     <!-- class="example" -->
                     <div class="example" id="GUID-5CD0462B-B427-4BA6-9AA9-66A7494F279A__BABEBCFG">
                        <p class="titleinexample">Example C-5 NULL Updates with UPDATEXML (Deprecated) &#x2013; Text Node</p><pre class="oac_no_warn" dir="ltr">SELECT XMLCast(XMLQuery('$p/PurchaseOrder/LineItems/LineItem/Part[@Description="A Night to Remember"]'
                        PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
               AS VARCHAR2(128)) part
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[@Reference="SBELL-2003030912333601PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");

PART
----
&lt;Part Description="A Night to Remember" UnitCost="39.95"&gt;<span class="bold">715515009058</span>&lt;/Part&gt;

UPDATE purchaseorder
  SET OBJECT_VALUE = 
        updateXML(OBJECT_VALUE, 
                  '/PurchaseOrder/LineItems/LineItem/Part[@Description="A Night to Remember"]/<span class="bold">text()</span>', <span class="bold">NULL</span>)
  WHERE XMLExists('$p/PurchaseOrder[@Reference="SBELL-2003030912333601PDT"]'
                  PASSING OBJECT_VALUE AS "p");

SELECT XMLCast(XMLQuery('$p/PurchaseOrder/LineItems/LineItem/Part[@Description="A Night to Remember"]'
                        PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
               AS VARCHAR2(128)) part
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[@Reference="SBELL-2003030912333601PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");

PART
----
&lt;Part Description="A Night to Remember" UnitCost="39.95"/&gt;
</pre></div>
                     <!-- class="example" -->
                  </div>
               </div><a id="ADXDB6055"></a><div class="props_rev_3"><a id="GUID-3235F02A-4E7D-4168-AD1B-6EF8F9A7D133" name="GUID-3235F02A-4E7D-4168-AD1B-6EF8F9A7D133"></a><h4 id="ADXDB-GUID-3235F02A-4E7D-4168-AD1B-6EF8F9A7D133" class="sect4"><span class="enumeration_section">C.3.2 </span>Update of the Same XML Node More Than Once Using UPDATEXML (Deprecated)
                  </h4>
                  <div>
                     <p>You can update the same XML node more than once in an <code class="codeph">updateXML</code> expression. The order of updates is determined by the order of the XPath expressions, in left-to-right order. Each successive update works on the result of the previous one. 
                     </p>
                     <p>For example, you can update both <code class="codeph">/EMP[EMPNO=217]</code> and <code class="codeph">/EMP[EMPNAME="Jane"]/EMPNO</code>, where the first XPath identifies the <code class="codeph">EMPNO</code> node containing it as well. 
                     </p>
                  </div>
               </div><a id="ADXDB6056"></a><div class="props_rev_3"><a id="GUID-7C22238D-7EA2-4EDB-8198-092C17824FEE" name="GUID-7C22238D-7EA2-4EDB-8198-092C17824FEE"></a><h4 id="ADXDB-GUID-7C22238D-7EA2-4EDB-8198-092C17824FEE" class="sect4"><span class="enumeration_section">C.3.3 </span>Guidelines for DOM Fidelity When Using UPDATEXML (Deprecated)
                  </h4>
                  <div>
                     <p>Guidelines are presented for DOM fidelity when using Oracle SQL function <code class="codeph">updateXML</code>.
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>When DOM fidelity is preserved —</p>
                           <p>When you update an element to <code class="codeph">NULL</code>, you make that element appear <span class="italic">empty</span> in its parent. When you update a text node inside an element to <code class="codeph">NULL</code>, you <span class="italic">remove</span> the text node. When you update an attribute node to <code class="codeph">NULL</code>, you make the attribute value the <span class="italic">empty</span> string.
                           </p>
                           <p>An example of an empty element is <code class="codeph">&lt;myElem/&gt;</code>. An example of an attribute with an empty-string value is <code class="codeph">myAttr=""</code>.
                           </p>
                        </li>
                        <li>
                           <p>When DOM fidelity is not preserved —</p>
                           <p>When you update a <code class="codeph">complexType</code> element to <code class="codeph">NULL</code>, you make it appear <span class="italic">empty</span> in its parent. When you update a SQL-inlined <code class="codeph">simpleType</code> element to <code class="codeph">NULL</code>, you make it <span class="italic">disappear</span> from its parent. Updating a text node to <code class="codeph">NULL</code> is the same as setting the parent <code class="codeph">simpleType</code> element to <code class="codeph">NULL</code>. 
                           </p>
                           <p>Furthermore, text nodes can only appear inside <code class="codeph">simpleType</code> elements when DOM fidelity is not preserved, since there is no positional descriptor with which to store mixed content. When you update an attribute node to <code class="codeph">NULL</code>, you <span class="italic">remove</span> the attribute from the element.
                           </p>
                        </li>
                        <li>
                           <p>How to tell whether DOM fidelity is preserved —</p>
                           <p>You can determine whether or not DOM fidelity is preserved for particular parts of a given <code class="codeph">XMLType</code> instance in a given XML schema by querying the XML schema metadata for attribute <code class="codeph">maintainDOM</code>.
                           </p>
                           <div class="infoboxnotealso" id="GUID-7C22238D-7EA2-4EDB-8198-092C17824FEE__GUID-1D20F7BC-4BDD-4997-805E-0E5890A41FD3">
                              <p class="notep1">See Also:</p>
                              <p><a href="XML-Schema-and-query-object-relational-storage.html#GUID-0A560425-E6F2-4AA2-9818-B80EFE2D0AD3" title="You can query database views USER_XML_SCHEMAS and ALL_XML_SCHEMAS to obtain a registered XML schema with all of its annotations. The registered version of an XML schema contains a full set of Oracle XML&nbsp;DB annotations. These annotations were supplied by a user or set by default during XML schema registration.">Querying a Registered XML Schema to Obtain Annotations</a> for an example of querying a schema to retrieve DOM fidelity values 
                              </p>
                           </div>
                        </li>
                     </ul>
                  </div>
                  <div>
                     <div class="relinfo">
                        <p><strong>Related Topics</strong></p>
                        <ul>
                           <li><a href="XML-Schema-and-query-basic.html#GUID-F809A6FE-28CD-4776-AB11-0B34ECBD9FF6" title="DOM fidelity means that all information in an XML document is preserved except whitespace that is insignificant. You can use DOM fidelity to ensure the accuracy and integrity of XML documents stored in Oracle XML&nbsp;DB.">DOM Fidelity</a></li>
                        </ul>
                     </div>
                  </div>
                  
               </div>
            </div><a id="ADXDB6061"></a><a id="ADXDB6062"></a><a id="ADXDB6060"></a><div class="props_rev_3"><a id="GUID-505550EB-A598-40F4-BB73-12837E3D887C" name="GUID-505550EB-A598-40F4-BB73-12837E3D887C"></a><h3 id="ADXDB-GUID-505550EB-A598-40F4-BB73-12837E3D887C" class="sect3"><span class="enumeration_section">C.4 </span>Optimization of Deprecated Oracle SQL Functions that Modify XML Data
               </h3>
               <div>
                  <p>In most cases, the deprecated Oracle SQL functions that modify XML data materialize a copy of the entire input XML document in memory, then update the copy. However, functions <code class="codeph">updateXML</code>, <code class="codeph">insertChildXML</code>, <code class="codeph">insertChildXMLbefore</code>, <code class="codeph">insertChildXMLafter</code>, and <code class="codeph">deleteXML</code> — that is, all <span class="italic">except</span> <code class="codeph">insertXMLbefore</code>, <code class="codeph">insertXMLafter</code>, and <code class="codeph">appendChildXML</code> — are optimized for <code class="codeph">XMLType</code> <code class="codeph">UPDATE</code> operations. 
                  </p>
                  <p>For object-relational storage, if particular conditions are met, then the function call can be rewritten to update the object-relational columns directly with the values. For binary XML storage, data preceding the targeted update is not modified, and, if SecureFiles LOBs are used (the default behavior), then sliding inserts are used to update only the portions of the data that need changing.</p>
                  <div class="infoboxnotealso" id="GUID-505550EB-A598-40F4-BB73-12837E3D887C__GUID-B0794157-07F7-4455-974F-AAC6B9C3BC20">
                     <p class="notep1">See Also:</p>
                     <p><a href="how-to-use-XML-DB.html#GUID-757B4470-851B-47B7-AB78-81F47ECE5398" title="An overview of the various ways of using Oracle XML&nbsp;DB is presented.">Overview of How To Use Oracle XML&nbsp;DB</a> and <a href="XPath-rewrite-for-object-relational-storage.html#GUID-35551023-CCAC-477B-8BBF-CD0E0B44C962" title="For XMLType data stored object-relationally, queries involving XPath expression arguments to various SQL functions can often be automatically rewritten to queries against the underlying SQL tables, which are highly optimized.">XPath Rewrite for Object-Relational Storage</a> for information about the conditions for XPath rewrite
                     </p>
                  </div>
                  <p>As an example with object-relational storage, the XPath argument to <code class="codeph">updateXML</code> in <a href="deprecated-functions-for-updating-XML-data.html#GUID-505550EB-A598-40F4-BB73-12837E3D887C__BABCCAFF">Example C-6</a> is processed by Oracle XML&nbsp;DB and rewritten into equivalent object-relational SQL code, as illustrated in <a href="deprecated-functions-for-updating-XML-data.html#GUID-505550EB-A598-40F4-BB73-12837E3D887C__BABHBDIC">Example C-7</a>.
                  </p>
                  <div class="infoboxnote" id="GUID-505550EB-A598-40F4-BB73-12837E3D887C__GUID-EB3F4EC4-3863-4335-A497-F71AB8A0BCCF">
                     <p class="notep1">Note:</p>
                     <p>The use of <code class="codeph">XMLDATA</code> for DML is shown here only as an illustration of internal Oracle XML&nbsp;DB behavior. Do <span class="italic">not</span> use <code class="codeph">XMLDATA</code> yourself for DML operations. You can use <code class="codeph">XMLDATA</code> directly only for DDL operations, never for DML operations.
                     </p>
                     <p>More generally, in your code, do not rely on the current mapping between the XML Schema object model and the SQL object model. This Oracle XML&nbsp;DB implementation mapping might change in the future.</p>
                  </div>
                  <div class="example" id="GUID-505550EB-A598-40F4-BB73-12837E3D887C__BABCCAFF">
                     <p class="titleinexample">Example C-6 XPath Expressions in UPDATEXML Expression</p><pre class="oac_no_warn" dir="ltr">SET LONG 2000</pre><pre class="oac_no_warn" dir="ltr">--</pre><pre class="oac_no_warn" dir="ltr">SELECT XMLCast(XMLQuery('$p/PurchaseOrder/User'
PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
       AS VARCHAR2(30))
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="SBELL-2002100912333601PDT"]'
  PASSING po.OBJECT_VALUE AS "p");
 
XMLCAST(XMLQUERY('$P/PURCHASEO
------------------------------
SBELL

UPDATE purchaseorder
  SET OBJECT_VALUE = updateXML(OBJECT_VALUE, <span class="bold">'/PurchaseOrder/User/text()', 'SVOLLMAN'</span>)
  WHERE XMLExists('$p/PurchaseOrder[Reference="SBELL-2002100912333601PDT"]'
  PASSING OBJECT_VALUE AS "p");

SELECT XMLCast(XMLQuery('$p/PurchaseOrder/User'
PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
       AS VARCHAR2(30))
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="SBELL-2002100912333601PDT"]'
  PASSING po.OBJECT_VALUE AS "p");
 
XMLCAST(XMLQUERY('$P/PURCHASEO
------------------------------
<span class="bold">SVOLLMAN</span></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-505550EB-A598-40F4-BB73-12837E3D887C__BABHBDIC">
                     <p class="titleinexample">Example C-7 Object Relational Equivalent of UPDATEXML Expression</p><pre class="oac_no_warn" dir="ltr">SELECT XMLCast(XMLQuery('$p/PurchaseOrder/User'
                        PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
               AS VARCHAR2(30))
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="SBELL-2002100912333601PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");

XMLCAST(XMLQUERY('$P/PURCHASEO
------------------------------
SBELL
 
UPDATE purchaseorder p
   SET p."XMLDATA"."<span class="bold">USERID</span>" = '<span class="bold">SVOLLMAN</span>'
   WHERE p."XMLDATA"."REFERENCE" = 'SBELL-2002100912333601PDT';

SELECT XMLCast(XMLQuery('$p/PurchaseOrder/User'
                        PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
               AS VARCHAR2(30))
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="SBELL-2002100912333601PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");
 

XMLCAST(XMLQUERY('$P/PURCHASEO
------------------------------
<span class="bold">SVOLLMAN</span></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="query-and-update-XML.html#GUID-F72DC7CD-40A9-4F07-9350-B80D2AD1F4D0" title="A SQL query that involves XQuery expressions can often be automatically rewritten (optimized) in one or more ways. This optimization is referred to as XML query rewrite or optimization. When this happens, the XQuery expression is, in effect, evaluated directly against the XML document without constructing a DOM in memory.">Performance Tuning for XQuery</a></li>
                     </ul>
                  </div>
               </div>
               
            </div><a id="ADXDB6064"></a><a id="ADXDB6063"></a><div class="props_rev_3"><a id="GUID-646CDBD2-A1DC-4FC3-BF87-7E5D47B28005" name="GUID-646CDBD2-A1DC-4FC3-BF87-7E5D47B28005"></a><h3 id="ADXDB-GUID-646CDBD2-A1DC-4FC3-BF87-7E5D47B28005" class="sect3"><span class="enumeration_section">C.5 </span>Creating XML Views Using Deprecated Oracle SQL Functions that Modify XML Data
               </h3>
               <div>
                  <p>You can use the deprecated Oracle SQL functions that modify XML data (<code class="codeph">updateXML</code>, <code class="codeph">insertChildXML</code>, <code class="codeph">insertChildXMLbefore</code>, <code class="codeph">insertChildXMLafter</code>, <code class="codeph">insertXMLbefore</code>, <code class="codeph">insertXMLafter</code>, <code class="codeph">appendChildXML</code>, and <code class="codeph">deleteXML</code>) to create new views of XML data.
                  </p>
                  <div class="section">
                     <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-646CDBD2-A1DC-4FC3-BF87-7E5D47B28005__BABHECAF">Example C-8</a> creates a view of table <code class="codeph">purchaseorder</code> using deprecated Oracle SQL function <code class="codeph">updateXML</code>. 
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-646CDBD2-A1DC-4FC3-BF87-7E5D47B28005__BABHECAF">
                     <p class="titleinexample">Example C-8 Creating a View Using UPDATEXML (Deprecated)</p><pre class="pre codeblock"><code>CREATE OR REPLACE VIEW purchaseorder_summary OF XMLType AS
  SELECT <span class="bold">updateXML</span>(OBJECT_VALUE,
                   '/PurchaseOrder/Actions', NULL,
                   '/PurchaseOrder/ShippingInstructions', NULL,
                   '/PurchaseOrder/LineItems', NULL) AS XML
  FROM purchaseorder p;

SELECT OBJECT_VALUE FROM purchaseorder_summary
  WHERE XMLExists('$p/PurchaseOrder[Reference="DAUSTIN-20021009123335811PDT"]'
                  PASSING OBJECT_VALUE AS "p");
 
OBJECT_VALUE
---------------------------------------------------------------------------
&lt;PurchaseOrder
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation=
      "http://localhost:8080/source/schemas/poSource/xsd/purchaseOrder.xsd"&gt;
  &lt;Reference&gt;DAUSTIN-20021009123335811PDT&lt;/Reference&gt;
  &lt;Actions/&gt;
  &lt;Reject/&gt;
  &lt;Requestor&gt;David L. Austin&lt;/Requestor&gt;
  &lt;User&gt;DAUSTIN&lt;/User&gt;
  &lt;CostCenter&gt;S30&lt;/CostCenter&gt;
  &lt;ShippingInstructions/&gt;
  &lt;SpecialInstructions&gt;Courier&lt;/SpecialInstructions&gt;
  &lt;LineItems/&gt;
&lt;/PurchaseOrder&gt;</code></pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADXDB6066"></a><a id="ADXDB6067"></a><a id="ADXDB6068"></a><a id="ADXDB6065"></a><div class="props_rev_3"><a id="GUID-23A699A3-B5F1-4BB1-A6FC-2D079398F8DD" name="GUID-23A699A3-B5F1-4BB1-A6FC-2D079398F8DD"></a><h3 id="ADXDB-GUID-23A699A3-B5F1-4BB1-A6FC-2D079398F8DD" class="sect3"><span class="enumeration_section">C.6 </span>INSERTCHILDXML Deprecated Oracle SQL Function
               </h3>
               <div>
                  <p>Deprecated Oracle SQL function <code class="codeph">insertChildXML</code> inserts new children (one or more elements of the same type or a single attribute) under parent XML elements. The XML document that is the target of the insertion can be XML Schema-based or non-schema-based. 
                  </p>
                  <p>A <span class="italic">copy</span> of the input <code class="codeph">XMLType</code> instance is modified and returned. The original data is unaffected. You can then use the returned data with SQL operation <code class="codeph">UPDATE</code> to modify database data.
                  </p>
                  <p>Function <code class="codeph">insertChildXML</code> has the following parameters (in order): 
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">target-data</code></span></span> (<code class="codeph">XMLType</code>) &#x2013; The XML data containing the target parent element.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">parent-xpath</code></span></span> (<code class="codeph">VARCHAR2</code>) &#x2013; An XPath&nbsp;1.0 expression that locates the parent elements within <span class="italic"><code class="codeph">target-data</code></span>. The <span class="italic"><code class="codeph">child-data</code></span> is inserted under <span class="italic">each</span> parent element. 
                        </p>
                        <p>If <span class="italic"><code class="codeph">parent-xpath</code></span> matches an empty sequence of element nodes, then no insertion is done, and <span class="italic"><code class="codeph">target-data</code></span> is returned unchanged (no error is raised). If <span class="italic"><code class="codeph">parent-xpath</code></span> does not match a sequence of element nodes (in particular, if <span class="italic"><code class="codeph">parent-xpath</code></span> matches one or more <span class="italic">attribute</span> or <span class="italic">text</span> nodes), then an error is raised.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">child-name</code></span></span> (<code class="codeph">VARCHAR2</code>) &#x2013; The name of the child elements or attribute to insert. An attribute name is distinguished from an element name by having an at-sign (<code class="codeph">@</code>) prefix as part of <span class="italic"><code class="codeph">child-name</code></span>, for example, <code class="codeph">@my_attribute</code> versus <code class="codeph">my_element</code>. (The at-sign is not part of the attribute name, but serves in the argument to indicate that <span class="italic"><code class="codeph">child-name</code></span> refers to an attribute.)
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">child-data</code></span></span> (<code class="codeph">XMLType</code> or <code class="codeph">VARCHAR2</code>) &#x2013; The child XML data to insert:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>If one or more <span class="italic">elements</span> are being inserted, then this is of data type <code class="codeph">XMLType</code>, and it contains element nodes. <span class="italic">Each</span> of the top-level element nodes in <span class="italic"><code class="codeph">child-data</code></span> must have the same name (tag) as <span class="italic"><code class="codeph">child-name</code></span> (or else an error is raised).
                              </p>
                           </li>
                           <li>
                              <p>If an <span class="italic">attribute</span> is being inserted, then this is of data type <code class="codeph">VARCHAR2</code>, and it represents the (scalar) attribute value. If an attribute of the same name already exists at the insertion location, then an error is raised.
                              </p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">namespace</code></span></span> (<code class="codeph">VARCHAR2</code>, <span class="italic">optional</span>) &#x2013; The XML namespace for parameters <span class="italic"><code class="codeph">parent-xpath</code></span> and <span class="italic"><code class="codeph">child-data</code></span>.
                        </p>
                     </li>
                  </ul>
                  <p>XML data <span class="italic"><code class="codeph">child-data</code></span> is inserted as one or more child elements, or a single child attribute, under <span class="italic">each</span> of the parent elements located at <span class="italic"><code class="codeph">parent-xpath</code></span>.
                  </p>
                  <p>In order of decreasing precedence, function <code class="codeph">insertChildXML</code> has the following behavior for <code class="codeph">NULL</code> arguments:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>If <span class="italic"><code class="codeph">child-name</code></span> is <code class="codeph">NULL</code>, then an error is raised.
                        </p>
                     </li>
                     <li>
                        <p>If <span class="italic"><code class="codeph">target-data</code></span> or <span class="italic"><code class="codeph">parent-xpath</code></span> is <code class="codeph">NULL</code>, then <code class="codeph">NULL</code> is returned.
                        </p>
                     </li>
                     <li>
                        <p>If <span class="italic"><code class="codeph">child-data</code></span> is <code class="codeph">NULL</code>, then:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>If <span class="italic"><code class="codeph">child-name</code></span> names an element, then no insertion is done, and <span class="italic"><code class="codeph">target-data</code></span> is returned unchanged.
                              </p>
                           </li>
                           <li>
                              <p>If <span class="italic"><code class="codeph">child-name</code></span> names an attribute, then an empty attribute value is inserted, for example, <code class="codeph">my_attribute&nbsp;=&nbsp;</code><span class="bold"><code class="codeph">""</code></span>.
                              </p>
                           </li>
                        </ul>
                     </li>
                  </ul>
                  <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-23A699A3-B5F1-4BB1-A6FC-2D079398F8DD__BABHGDJI">Figure C-2</a> shows the syntax.
                  </p>
                  <div class="figure" id="GUID-23A699A3-B5F1-4BB1-A6FC-2D079398F8DD__BABHGDJI">
                     <p class="titleinfigure">Figure C-2 INSERTCHILDXML Syntax</p><img src="img/insertchildxml.gif" width="567" alt="Description of Figure C-2 follows" title="Description of Figure C-2 follows" longdesc="img_text/insertchildxml.html"><br><a href="img_text/insertchildxml.html">Description of "Figure C-2 INSERTCHILDXML Syntax"</a></div>
                  <!-- class="figure" -->
                  <p>If <span class="italic"><code class="codeph">target-data</code></span> is XML <span class="italic">schema-based</span>, then the schema is consulted to determine the insertion positions. For example, if the schema constrains child elements named <span class="italic"><code class="codeph">child-name</code></span> to be the first child elements of a <span class="italic"><code class="codeph">parent-xpath</code></span>, then the insertion takes this into account. Similarly, if the <span class="italic"><code class="codeph">child-name</code></span> or <span class="italic"><code class="codeph">child-data</code></span> argument is inappropriate for an associated schema, then an error is raised.
                  </p>
                  <p>If the parent element does <span class="italic">not</span> yet have a child corresponding in name and kind to <span class="italic"><code class="codeph">child-name</code></span> (and if such a child is permitted by the associated XML schema, if any), then <span class="italic"><code class="codeph">child-data</code></span> is inserted as new child elements, or a new attribute value, named <span class="italic"><code class="codeph">child-name</code></span>.
                  </p>
                  <p>If the parent element already has a child <span class="italic">attribute</span> named <span class="italic"><code class="codeph">child-name</code></span> (without the at-sign), then an error is raised. If the parent element already has a child <span class="italic">element</span> named <span class="italic"><code class="codeph">child-name</code></span> (and if more than one child element is permitted by the associated XML schema, if any), then <span class="italic"><code class="codeph">child-data</code></span> is inserted so that its elements become child elements named <span class="italic"><code class="codeph">child-name</code></span>, but their positions in the sequence of children are unpredictable.
                  </p>
                  <p>If you need to insert elements into an existing, non-empty collection of child elements, and the order is important to you, then use SQL/XML function <code class="codeph">appendChildXML</code> or <code class="codeph">insertXMLbefore</code>.
                  </p>
                  <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-23A699A3-B5F1-4BB1-A6FC-2D079398F8DD__BABIGHGG">Example C-9</a> shows how to use a SQL <code class="codeph">UPDATE</code> statement and Oracle SQL function <code class="codeph">insertChildXML</code> to insert a new <code class="codeph">LineItem</code> element as a child of element <code class="codeph">LineItems</code>.
                  </p>
                  <p>If the XML data to be updated is XML schema-based and it refers to a namespace, then the data to be inserted must also refer to the same namespace. Otherwise, an error is raised because the inserted data does not conform to the XML schema. </p>
                  <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-23A699A3-B5F1-4BB1-A6FC-2D079398F8DD__BABFACIB">Example C-10</a> is the same as <a href="deprecated-functions-for-updating-XML-data.html#GUID-23A699A3-B5F1-4BB1-A6FC-2D079398F8DD__BABIGHGG">Example C-9</a>, except that the <code class="codeph">LineItem</code> element to be inserted refers to a namespace. This assumes that the relevant XML schema requires a namespace for this element. 
                  </p>
                  <p>This use of namespaces is different from the use of a namespace <span class="italic">argument</span> to function <code class="codeph">insertChildXML</code>. Namespaces supplied in that optional argument apply only to the XPath argument, not to the content to be inserted. 
                  </p>
                  <div class="example" id="GUID-23A699A3-B5F1-4BB1-A6FC-2D079398F8DD__BABIGHGG">
                     <p class="titleinexample">Example C-9 Insertion into a Collection Using INSERTCHILDXML (Deprecated)</p><pre class="pre codeblock"><code>SELECT XMLQuery('$p/PurchaseOrder/LineItems/LineItem[@ItemNumber=222]'
                PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="AMCEWEN-20021009123336171PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");

XMLQUERY('$P/PURCHASEORDER/LINEITEMS/LINEITEM[@ITEMNUMBER=222]'
---------------------------------------------------------------

1 row selected.

UPDATE purchaseorder
  SET OBJECT_VALUE = 
        <span class="bold">insertChildXML</span>(OBJECT_VALUE, 
                       '/PurchaseOrder/LineItems', 
                       'LineItem', 
                       XMLType('&lt;LineItem ItemNumber="222"&gt;
                                  &lt;Description&gt;The Harder They Come&lt;/Description&gt;
                                  &lt;Part Id="953562951413" 
                                        UnitPrice="22.95" 
                                        Quantity="1"/&gt;
                                &lt;/LineItem&gt;'))
  WHERE XMLExists('$p/PurchaseOrder[Reference="AMCEWEN-20021009123336171PDT"]'
                  PASSING OBJECT_VALUE AS "p");

SELECT XMLQuery('$p/PurchaseOrder/LineItems/LineItem[@ItemNumber=222]'
                PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="AMCEWEN-20021009123336171PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");

XMLQUERY('$P/PURCHASEORDER/LINEITEMS/LINEITEM[@ITEMNUMBER=222]'
---------------------------------------------------------------
&lt;LineItem ItemNumber="222"&gt;
  &lt;Description&gt;The Harder They Come&lt;/Description&gt;
  &lt;Part Id="953562951413" UnitPrice="22.95" Quantity="1"/&gt;
&lt;/LineItem&gt;

1 row selected.
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-23A699A3-B5F1-4BB1-A6FC-2D079398F8DD__BABFACIB">
                     <p class="titleinexample">Example C-10 Inserting an Element that Uses a Namespace</p><pre class="pre codeblock"><code>UPDATE purchaseorder
  SET OBJECT_VALUE = 
        insertChildXML(OBJECT_VALUE, 
                       '/PurchaseOrder/LineItems', 
                       'LineItem', 
                       XMLType('&lt;LineItem <span class="bold">xmlns="films.xsd"</span> ItemNumber="222"&gt;
                                  &lt;Description&gt;The Harder They Come&lt;/Description&gt;
                                  &lt;Part Id="953562951413" 
                                        UnitPrice="22.95" 
                                        Quantity="1"/&gt;
                                &lt;/LineItem&gt;'))
  WHERE XMLExists('$p/PurchaseOrder[Reference="AMCEWEN-20021009123336171PDT"]'
                  PASSING OBJECT_VALUE AS "p");
</code></pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADXDB6070"></a><a id="ADXDB6069"></a><div class="props_rev_3"><a id="GUID-B71A91D0-7DE0-4B86-BEBC-CE0080D3A8D7" name="GUID-B71A91D0-7DE0-4B86-BEBC-CE0080D3A8D7"></a><h3 id="ADXDB-GUID-B71A91D0-7DE0-4B86-BEBC-CE0080D3A8D7" class="sect3"><span class="enumeration_section">C.7 </span>INSERTCHILDXMLBEFORE Deprecated Oracle SQL Function
               </h3>
               <div>
                  <p>Deprecated Oracle SQL function <code class="codeph">insertChildXMLbefore</code> inserts one or more collection elements as children of target parent elements. The insertion for each target occurs immediately before a specified existing collection element. The existing XML document that is the target of the insertion can be XML Schema-based or non-schema-based. 
                  </p>
                  <p>A <span class="italic">copy</span> of the input <code class="codeph">XMLType</code> instance is modified and returned. The original data is unaffected. You can then use the returned data with SQL operation <code class="codeph">UPDATE</code> to modify database data.
                  </p>
                  <p>Function <code class="codeph">insertChildXMLbefore</code> has the following parameters (in order): 
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">target-data</code></span></span> (<code class="codeph">XMLType</code>) &#x2013; The XML data that is the target of the insertion.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">parent-xpath</code></span></span> (<code class="codeph">VARCHAR2</code>) &#x2013; An XPath&nbsp;1.0 expression that locates the parent elements within <span class="italic"><code class="codeph">target-data</code></span>. The <span class="italic"><code class="codeph">child-data</code></span> is inserted under <span class="italic">each</span> parent element. 
                        </p>
                        <p>If <span class="italic"><code class="codeph">parent-xpath</code></span> matches an empty sequence of element nodes, then no insertion is done, and <span class="italic"><code class="codeph">target-data</code></span> is returned unchanged (no error is raised). If <span class="italic"><code class="codeph">parent-xpath</code></span> does not match a sequence of element nodes (in particular, if <span class="italic"><code class="codeph">parent-xpath</code></span> matches one or more <span class="italic">attribute</span> or <span class="italic">text</span> nodes), then an error is raised.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">child-xpath</code></span></span> (<code class="codeph">VARCHAR2</code>) &#x2013; A relative XPath&nbsp;1.0 expression that locates the existing child that will become the successor of the inserted <span class="italic"><code class="codeph">child-data</code></span>. It must name a child element of the element indicated by <span class="italic"><code class="codeph">parent-xpath</code></span>, and it can include a predicate.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">child-data</code></span></span> (<code class="codeph">XMLType</code>) &#x2013; The child element XML data to insert. This is of data type <code class="codeph">XMLType</code>, and it contains element nodes. <span class="italic">Each</span> of the top-level element nodes in <span class="italic"><code class="codeph">child-data</code></span> must have the same data type as the element indicated by <span class="italic"><code class="codeph">child-xpath</code></span> (or else an error is raised).
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">namespace</code></span></span> (<span class="italic">optional</span>, <code class="codeph">VARCHAR2</code>) &#x2013; The namespace for parameters <span class="italic"><code class="codeph">parent-xpath</code></span>, <span class="italic"><code class="codeph">child-xpath</code></span>, and <span class="italic"><code class="codeph">child-data</code></span>.
                        </p>
                     </li>
                  </ul>
                  <p>XML data <span class="italic"><code class="codeph">child-data</code></span> is inserted as one or more child elements under <span class="italic">each</span> of the parent elements located at <span class="italic"><code class="codeph">parent-xpath</code></span>.
                  </p>
                  <p>In order of decreasing precedence, function <code class="codeph">insertChildXMLbefore</code> has the following behavior for <code class="codeph">NULL</code> arguments:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>If <span class="italic"><code class="codeph">child-xpath</code></span> is <code class="codeph">NULL</code>, then an error is raised.
                        </p>
                     </li>
                     <li>
                        <p>If <span class="italic"><code class="codeph">target-data</code></span> or <span class="italic"><code class="codeph">parent-xpath</code></span> is <code class="codeph">NULL</code>, then <code class="codeph">NULL</code> is returned.
                        </p>
                     </li>
                     <li>
                        <p>If <span class="italic"><code class="codeph">child-data</code></span> is <code class="codeph">NULL</code>, then no insertion is done, and <span class="italic"><code class="codeph">target-data</code></span> is returned unchanged.
                        </p>
                     </li>
                  </ul>
                  <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-B71A91D0-7DE0-4B86-BEBC-CE0080D3A8D7__BABGBCCC">Figure C-3</a> shows the syntax.
                  </p>
                  <div class="figure" id="GUID-B71A91D0-7DE0-4B86-BEBC-CE0080D3A8D7__BABGBCCC">
                     <p class="titleinfigure">Figure C-3 INSERTCHILDXMLBEFORE Syntax</p><img src="img/insertchildxmlbefore.gif" width="566" alt="Description of Figure C-3 follows" title="Description of Figure C-3 follows" longdesc="img_text/insertchildxmlbefore.html"><br><a href="img_text/insertchildxmlbefore.html">Description of "Figure C-3 INSERTCHILDXMLBEFORE Syntax"</a></div>
                  <!-- class="figure" -->
               </div>
            </div><a id="ADXDB6072"></a><a id="ADXDB6071"></a><div class="props_rev_3"><a id="GUID-38E1764C-91A1-448A-A485-B01A2172CACD" name="GUID-38E1764C-91A1-448A-A485-B01A2172CACD"></a><h3 id="ADXDB-GUID-38E1764C-91A1-448A-A485-B01A2172CACD" class="sect3"><span class="enumeration_section">C.8 </span>INSERTCHILDXMLAFTER Deprecated Oracle SQL Function
               </h3>
               <div>
                  <p>Deprecated Oracle SQL function <code class="codeph">insertChildXMLafter</code> inserts one or more collection elements as children of target parent elements. The insertion for each target occurs immediately after a specified existing collection element. The existing XML document that is the target of the insertion can be XML Schema-based or non-schema-based. 
                  </p>
                  <p>A <span class="italic">copy</span> of the input <code class="codeph">XMLType</code> instance is modified and returned. The original data is unaffected. You can then use the returned data with SQL operation <code class="codeph">UPDATE</code> to modify database data.
                  </p>
                  <p>Function <code class="codeph">insertChildXMLafter</code> has the following parameters (in order): 
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">target-data</code></span></span> (<code class="codeph">XMLType</code>) &#x2013; The XML data that is the target of the insertion.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">parent-xpath</code></span></span> (<code class="codeph">VARCHAR2</code>) &#x2013; An XPath&nbsp;1.0 expression that locates the parent elements within <span class="italic"><code class="codeph">target-data</code></span>. The <span class="italic"><code class="codeph">child-data</code></span> is inserted under <span class="italic">each</span> parent element. 
                        </p>
                        <p>If <span class="italic"><code class="codeph">parent-xpath</code></span> matches an empty sequence of element nodes, then no insertion is done, and <span class="italic"><code class="codeph">target-data</code></span> is returned unchanged (no error is raised). If <span class="italic"><code class="codeph">parent-xpath</code></span> does not match a sequence of element nodes (in particular, if <span class="italic"><code class="codeph">parent-xpath</code></span> matches one or more <span class="italic">attribute</span> or <span class="italic">text</span> nodes), then an error is raised.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">child-xpath</code></span></span> (<code class="codeph">VARCHAR2</code>) &#x2013; A relative XPath&nbsp;1.0 expression that locates the existing child that will become the predecessor of the inserted <span class="italic"><code class="codeph">child-data</code></span>. It must name a child element of the element indicated by <span class="italic"><code class="codeph">parent-xpath</code></span>, and it can include a predicate.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">child-data</code></span></span> (<code class="codeph">XMLType</code>) &#x2013; The child element XML data to insert. This is of data type <code class="codeph">XMLType</code>, and it contains element nodes. <span class="italic">Each</span> of the top-level element nodes in <span class="italic"><code class="codeph">child-data</code></span> must have the same data type as the element indicated by <span class="italic"><code class="codeph">child-xpath</code></span> (or else an error is raised).
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">namespace</code></span></span> (<span class="italic">optional</span>, <code class="codeph">VARCHAR2</code>) &#x2013; The namespace for parameters <span class="italic"><code class="codeph">parent-xpath</code></span>, <span class="italic"><code class="codeph">child-xpath</code></span>, and <span class="italic"><code class="codeph">child-data</code></span>.
                        </p>
                     </li>
                  </ul>
                  <p>XML data <span class="italic"><code class="codeph">child-data</code></span> is inserted as one or more child elements under <span class="italic">each</span> of the parent elements located at <span class="italic"><code class="codeph">parent-xpath</code></span>.
                  </p>
                  <p>In order of decreasing precedence, function <code class="codeph">insertChildXMLafter</code> has the following behavior for <code class="codeph">NULL</code> arguments:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>If <span class="italic"><code class="codeph">child-xpath</code></span> is <code class="codeph">NULL</code>, then an error is raised.
                        </p>
                     </li>
                     <li>
                        <p>If <span class="italic"><code class="codeph">target-data</code></span> or <span class="italic"><code class="codeph">parent-xpath</code></span> is <code class="codeph">NULL</code>, then <code class="codeph">NULL</code> is returned.
                        </p>
                     </li>
                     <li>
                        <p>If <span class="italic"><code class="codeph">child-data</code></span> is <code class="codeph">NULL</code>, then no insertion is done, and <span class="italic"><code class="codeph">target-data</code></span> is returned unchanged.
                        </p>
                     </li>
                  </ul>
                  <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-38E1764C-91A1-448A-A485-B01A2172CACD__BABICFGH">Figure C-4</a> shows the syntax.
                  </p>
                  <div class="figure" id="GUID-38E1764C-91A1-448A-A485-B01A2172CACD__BABICFGH">
                     <p class="titleinfigure">Figure C-4 INSERTCHILDXMLAFTER Syntax</p><img src="img/insertchildxmlafter.gif" width="566" alt="Description of Figure C-4 follows" title="Description of Figure C-4 follows" longdesc="img_text/insertchildxmlafter.html"><br><a href="img_text/insertchildxmlafter.html">Description of "Figure C-4 INSERTCHILDXMLAFTER Syntax"</a></div>
                  <!-- class="figure" -->
               </div>
            </div><a id="ADXDB6074"></a><a id="ADXDB6075"></a><a id="ADXDB6073"></a><div class="props_rev_3"><a id="GUID-9C56911D-B8B9-4C3D-A90F-F471C5DB3C8F" name="GUID-9C56911D-B8B9-4C3D-A90F-F471C5DB3C8F"></a><h3 id="ADXDB-GUID-9C56911D-B8B9-4C3D-A90F-F471C5DB3C8F" class="sect3"><span class="enumeration_section">C.9 </span>INSERTXMLBEFORE Deprecated Oracle SQL Function
               </h3>
               <div>
                  <p>Deprecated Oracle SQL function <code class="codeph">insertXMLbefore</code> inserts one or more nodes of any kind immediately before a target node that is not an attribute node. The XML document that is the target of the insertion can be XML Schema-based or non-schema-based. 
                  </p>
                  <p>A <span class="italic">copy</span> of the input <code class="codeph">XMLType</code> instance is modified and returned. The original data is unaffected. You can then use the returned data with SQL operation <code class="codeph">UPDATE</code> to modify database data.
                  </p>
                  <p>Function <code class="codeph">insertXMLbefore</code> has the following parameters (in order): 
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">target-data</code></span></span> (<code class="codeph">XMLType</code>) &#x2013; The XML data that is the target of the insertion.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">successor-xpath</code></span></span> (<code class="codeph">VARCHAR2</code>) &#x2013; An XPath&nbsp;1.0 expression that locates zero or more nodes in <span class="italic"><code class="codeph">target-data</code></span> of any kind <span class="italic">except</span> attribute nodes. <span class="italic"><code class="codeph">XML-data</code></span> is inserted immediately before <span class="italic">each</span> of these nodes. Thus, the nodes in <span class="italic"><code class="codeph">XML-data</code></span> become preceding siblings of each of the <span class="italic"><code class="codeph">successor-xpath</code></span> nodes.
                        </p>
                        <p>If <span class="italic"><code class="codeph">successor-xpath</code></span> matches an empty sequence of nodes, then no insertion is done, and <span class="italic"><code class="codeph">target-data</code></span> is returned unchanged (no error is raised). If <span class="italic"><code class="codeph">successor-xpath</code></span> does not match a sequence of nodes that are not attribute nodes, then an error is raised.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">XML-data</code></span></span> (<code class="codeph">XMLType</code>) &#x2013; The XML data to be inserted: one or more nodes of <span class="italic">any kind</span>. The order of the nodes is preserved after the insertion.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">namespace</code></span></span> (<span class="italic">optional</span>, <code class="codeph">VARCHAR2</code>) &#x2013; The namespace for parameter <span class="italic"><code class="codeph">successor-xpath</code></span>.
                        </p>
                     </li>
                  </ul>
                  <p>The <span class="italic"><code class="codeph">XML-data</code></span> nodes are inserted immediately before <span class="italic">each</span> of the non-attribute nodes located at <span class="italic"><code class="codeph">successor-xpath</code></span>.
                  </p>
                  <p>Function <code class="codeph">insertXMLbefore</code> has the following behavior for <code class="codeph">NULL</code> arguments:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>If <span class="italic"><code class="codeph">target-data</code></span> or <span class="italic"><code class="codeph">parent-xpath</code></span> is <code class="codeph">NULL</code>, then <code class="codeph">NULL</code> is returned.
                        </p>
                     </li>
                     <li>
                        <p>Otherwise, if <span class="italic"><code class="codeph">child-data</code></span> is <code class="codeph">NULL</code>, then no insertion is done, and <span class="italic"><code class="codeph">target-data</code></span> is returned unchanged.
                        </p>
                     </li>
                  </ul>
                  <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-9C56911D-B8B9-4C3D-A90F-F471C5DB3C8F__BABJEDEC">Figure C-5</a> shows the syntax.
                  </p>
                  <div class="figure" id="GUID-9C56911D-B8B9-4C3D-A90F-F471C5DB3C8F__BABJEDEC">
                     <p class="titleinfigure">Figure C-5 INSERTXMLBEFORE Syntax</p><img src="img/insertxmlbefore.gif" width="591" alt="Description of Figure C-5 follows" title="Description of Figure C-5 follows" longdesc="img_text/insertxmlbefore.html"><br><a href="img_text/insertxmlbefore.html">Description of "Figure C-5 INSERTXMLBEFORE Syntax"</a></div>
                  <!-- class="figure" -->
                  <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-9C56911D-B8B9-4C3D-A90F-F471C5DB3C8F__BABHGEAH">Example C-11</a> uses deprecated Oracle SQL function <code class="codeph">insertXMLbefore</code> to insert a <code class="codeph">LineItem</code> element before the first <code class="codeph">LineItem</code> element.
                  </p>
                  <div class="infoboxnote" id="GUID-9C56911D-B8B9-4C3D-A90F-F471C5DB3C8F__GUID-C42F0415-FE08-4372-A62F-72DEB0E05E78">
                     <p class="notep1">Note:</p>
                     <p>Queries that use Oracle SQL function <code class="codeph">insertXMLbefore</code> are <span class="italic">not</span> optimized. For this reason, Oracle recommends that you use function <code class="codeph">insertChildXML</code>, <code class="codeph">insertChildXMLbefore</code>, or <code class="codeph">insertChildXMLafter</code> instead. See <a href="query-and-update-XML.html#GUID-F72DC7CD-40A9-4F07-9350-B80D2AD1F4D0" title="A SQL query that involves XQuery expressions can often be automatically rewritten (optimized) in one or more ways. This optimization is referred to as XML query rewrite or optimization. When this happens, the XQuery expression is, in effect, evaluated directly against the XML document without constructing a DOM in memory.">Performance Tuning for XQuery</a> for more information.
                     </p>
                  </div>
                  <div class="example" id="GUID-9C56911D-B8B9-4C3D-A90F-F471C5DB3C8F__BABHGEAH">
                     <p class="titleinexample">Example C-11 Insertion Before an Element Using INSERTXMLBEFORE (Deprecated)</p><pre class="pre codeblock"><code>SELECT XMLQuery('$p/PurchaseOrder/LineItems/LineItem[1]'
                PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="AMCEWEN-20021009123336171PDT"]'
                   PASSING po.OBJECT_VALUE AS "p");

XMLQUERY('$P/PURCHASEORDER/LINEITEMS/LINEITEM[1]'PASSINGPO.OBJECT_
------------------------------------------------------------------
&lt;LineItem ItemNumber="1"&gt;
  &lt;Description&gt;Salesman&lt;/Description&gt;
  &lt;Part Id="37429158920" UnitPrice="39.95" Quantity="2"/&gt;
&lt;/LineItem&gt;

UPDATE purchaseorder
  SET OBJECT_VALUE = 
      <span class="bold">insertXMLbefore</span>(OBJECT_VALUE, 
                      '/PurchaseOrder/LineItems/LineItem[1]', 
                      XMLType('<span class="bold">&lt;LineItem ItemNumber="314"&gt;</span>
                                 <span class="bold">&lt;Description&gt;Brazil&lt;/Description&gt;</span>
                                 <span class="bold">&lt;Part Id="314159265359"</span> 
                                       <span class="bold">UnitPrice="69.95"</span> 
                                       <span class="bold">Quantity="2"/&gt;</span>
                               <span class="bold">&lt;/LineItem&gt;</span>'))
  WHERE XMLExists('$p/PurchaseOrder[Reference="AMCEWEN-20021009123336171PDT"]'
                  PASSING OBJECT_VALUE AS "p");

SELECT XMLQuery('$p/PurchaseOrder/LineItems/LineItem[<span class="bold">position() &lt;= 2</span>]'
                PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="AMCEWEN-20021009123336171PDT"]'
                   PASSING po.OBJECT_VALUE AS "p");

XMLQUERY('$P/PURCHASEORDER/LINEITEMS/LINEITEM[POSITION()&lt;=2]'PASSINGPO.OBJECT_
------------------------------------------------------------------------------
<span class="bold">&lt;LineItem ItemNumber="314"&gt;</span>
  <span class="bold">&lt;Description&gt;Brazil&lt;/Description&gt;</span>
  <span class="bold">&lt;Part Id="314159265359" UnitPrice="69.95" Quantity="2"/&gt;</span>
<span class="bold">&lt;/LineItem&gt;</span>
&lt;LineItem ItemNumber="1"&gt;
  &lt;Description&gt;Salesman&lt;/Description&gt;
  &lt;Part Id="37429158920" UnitPrice="39.95" Quantity="2"/&gt;
&lt;/LineItem&gt;</code></pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADXDB6077"></a><a id="ADXDB6076"></a><div class="props_rev_3"><a id="GUID-A9632F5C-6BB3-4AF6-B01E-92C4FD562C3B" name="GUID-A9632F5C-6BB3-4AF6-B01E-92C4FD562C3B"></a><h3 id="ADXDB-GUID-A9632F5C-6BB3-4AF6-B01E-92C4FD562C3B" class="sect3"><span class="enumeration_section">C.10 </span>INSERTXMLAFTER Deprecated Oracle SQL Function
               </h3>
               <div>
                  <p>Deprecated Oracle SQL function <code class="codeph">insertXMLafter</code> inserts one or more nodes of any kind immediately after a target node that is not an attribute node. The XML document that is the target of the insertion can be XML Schema-based or non-schema-based. 
                  </p>
                  <p>Function <code class="codeph">insertXMLafter</code> is thus similar to <code class="codeph">insertXMLbefore</code>, but it inserts after, not before, the target node.
                  </p>
                  <p>A <span class="italic">copy</span> of the input <code class="codeph">XMLType</code> instance is modified and returned. The original data is unaffected. You can then use the returned data with SQL operation <code class="codeph">UPDATE</code> to modify database data.
                  </p>
                  <p>Function <code class="codeph">insertXMLafter</code> has the following parameters (in order): 
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">target-data</code></span></span> (<code class="codeph">XMLType</code>) &#x2013; The XML data that is the target of the insertion.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">successor-xpath</code></span></span> (<code class="codeph">VARCHAR2</code>) &#x2013; An XPath&nbsp;1.0 expression that locates zero or more nodes in <span class="italic"><code class="codeph">target-data</code></span> of any kind <span class="italic">except</span> attribute nodes. <span class="italic"><code class="codeph">XML-data</code></span> is inserted immediately after <span class="italic">each</span> of these nodes. Thus, the nodes in <span class="italic"><code class="codeph">XML-data</code></span> become succeeding siblings of each of the <span class="italic"><code class="codeph">successor-xpath</code></span> nodes.
                        </p>
                        <p>If <span class="italic"><code class="codeph">successor-xpath</code></span> matches an empty sequence of nodes, then no insertion is done, and <span class="italic"><code class="codeph">target-data</code></span> is returned unchanged (no error is raised). If <span class="italic"><code class="codeph">successor-xpath</code></span> does not match a sequence of nodes that are not attribute nodes, then an error is raised.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">XML-data</code></span></span> (<code class="codeph">XMLType</code>) &#x2013; The XML data to be inserted: one or more nodes of <span class="italic">any kind</span>. The order of the nodes is preserved after the insertion.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">namespace</code></span></span> (<span class="italic">optional</span>, <code class="codeph">VARCHAR2</code>) &#x2013; The namespace for parameter <span class="italic"><code class="codeph">successor-xpath</code></span>.
                        </p>
                     </li>
                  </ul>
                  <p>The <span class="italic"><code class="codeph">XML-data</code></span> nodes are inserted immediately after <span class="italic">each</span> of the non-attribute nodes located at <span class="italic"><code class="codeph">successor-xpath</code></span>.
                  </p>
                  <p>Function <code class="codeph">insertXMLafter</code> has the following behavior for <code class="codeph">NULL</code> arguments:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>If <span class="italic"><code class="codeph">target-data</code></span> or <span class="italic"><code class="codeph">parent-xpath</code></span> is <code class="codeph">NULL</code>, then <code class="codeph">NULL</code> is returned.
                        </p>
                     </li>
                     <li>
                        <p>Otherwise, if <span class="italic"><code class="codeph">child-data</code></span> is <code class="codeph">NULL</code>, then no insertion is done, and <span class="italic"><code class="codeph">target-data</code></span> is returned unchanged.
                        </p>
                     </li>
                  </ul>
                  <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-A9632F5C-6BB3-4AF6-B01E-92C4FD562C3B__BABJGACE">Figure C-6</a> shows the syntax.
                  </p>
                  <div class="figure" id="GUID-A9632F5C-6BB3-4AF6-B01E-92C4FD562C3B__BABJGACE">
                     <p class="titleinfigure">Figure C-6 INSERTXMLAFTER Syntax</p><img src="img/insertxmlafter.gif" width="582" alt="Description of Figure C-6 follows" title="Description of Figure C-6 follows" longdesc="img_text/insertxmlafter.html"><br><a href="img_text/insertxmlafter.html">Description of "Figure C-6 INSERTXMLAFTER Syntax"</a></div>
                  <!-- class="figure" -->
                  <div class="infoboxnote" id="GUID-A9632F5C-6BB3-4AF6-B01E-92C4FD562C3B__GUID-5C67BDCD-3D4A-422F-B1FD-9C024228D1A7">
                     <p class="notep1">Note:</p>
                     <p>Queries that use Oracle SQL function <code class="codeph">insertXMLafter</code> are <span class="italic">not</span> optimized. For this reason, Oracle recommends that you use function <code class="codeph">insertChildXML</code>, <code class="codeph">insertChildXMLbefore</code>, or <code class="codeph">insertChildXMLafter</code> instead. See <a href="query-and-update-XML.html#GUID-F72DC7CD-40A9-4F07-9350-B80D2AD1F4D0" title="A SQL query that involves XQuery expressions can often be automatically rewritten (optimized) in one or more ways. This optimization is referred to as XML query rewrite or optimization. When this happens, the XQuery expression is, in effect, evaluated directly against the XML document without constructing a DOM in memory.">Performance Tuning for XQuery</a> for more information.
                     </p>
                  </div>
               </div>
            </div><a id="ADXDB6079"></a><a id="ADXDB6080"></a><a id="ADXDB6078"></a><div class="props_rev_3"><a id="GUID-7F8F13A6-493A-4831-B698-0FCC07508222" name="GUID-7F8F13A6-493A-4831-B698-0FCC07508222"></a><h3 id="ADXDB-GUID-7F8F13A6-493A-4831-B698-0FCC07508222" class="sect3"><span class="enumeration_section">C.11 </span>APPENDCHILDXML Deprecated Oracle SQL Function
               </h3>
               <div>
                  <p>Deprecated Oracle SQL function <code class="codeph">appendChildXML</code> inserts one or more nodes of any kind as the last children of a given element node. The XML document that is the target of the insertion can be XML Schema-based or non-schema-based. 
                  </p>
                  <p>A <span class="italic">copy</span> of the input <code class="codeph">XMLType</code> instance is modified and returned. The original data is unaffected. You can then use the returned data with SQL operation <code class="codeph">UPDATE</code> to modify database data.
                  </p>
                  <p>Function <code class="codeph">appendChildXML</code> has the following parameters (in order):
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">target-data</code></span></span> (<code class="codeph">XMLType</code>)&#x2013; The XML data containing the target parent element.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">parent-xpath</code></span></span> (<code class="codeph">VARCHAR2</code>) &#x2013; An XPath&nbsp;1.0 expression that locates zero or more <span class="italic">element</span> nodes in <span class="italic"><code class="codeph">target-data</code></span> that are the targets of the insertion operation. The <span class="italic"><code class="codeph">child-data</code></span> is inserted as the last child or children of <span class="italic">each</span> of these parent elements. 
                        </p>
                        <p>If <span class="italic"><code class="codeph">parent-xpath</code></span> matches an empty sequence of element nodes, then no insertion is done, and <span class="italic"><code class="codeph">target-data</code></span> is returned unchanged (no error is raised). If <span class="italic"><code class="codeph">parent-xpath</code></span> does not match a sequence of element nodes (in particular, if <span class="italic"><code class="codeph">parent-xpath</code></span> matches one or more <span class="italic">attribute</span> or <span class="italic">text</span> nodes), then an error is raised.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">child-data</code></span></span> (<code class="codeph">XMLType</code>) &#x2013; Child data to be inserted: one or more nodes of <span class="italic">any kind</span>. The order of the nodes is preserved after the insertion.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">namespace</code></span></span> (<span class="italic">optional</span>, <code class="codeph">VARCHAR2</code>) &#x2013; The namespace for parameter <span class="italic"><code class="codeph">parent-xpath</code></span>.
                        </p>
                     </li>
                  </ul>
                  <p>XML data <span class="italic"><code class="codeph">child-data</code></span> is inserted as the last child or children of <span class="italic">each</span> of the element nodes indicated by <span class="italic"><code class="codeph">parent-xpath</code></span>. 
                  </p>
                  <p>Function <code class="codeph">appendChildXML</code> has the following behavior for <code class="codeph">NULL</code> arguments:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>If <span class="italic"><code class="codeph">target-data</code></span> or <span class="italic"><code class="codeph">parent-xpath</code></span> is <code class="codeph">NULL</code>, then <code class="codeph">NULL</code> is returned.
                        </p>
                     </li>
                     <li>
                        <p>Otherwise, if <span class="italic"><code class="codeph">child-data</code></span> is <code class="codeph">NULL</code>, then no insertion is done, and <span class="italic"><code class="codeph">target-data</code></span> is returned unchanged.
                        </p>
                     </li>
                  </ul>
                  <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-7F8F13A6-493A-4831-B698-0FCC07508222__BABHAAII">Figure C-7</a> shows the syntax.
                  </p>
                  <div class="figure" id="GUID-7F8F13A6-493A-4831-B698-0FCC07508222__BABHAAII">
                     <p class="titleinfigure">Figure C-7 APPENDCHILDXML Syntax</p><img src="img/appendchildxml.gif" width="581" alt="Description of Figure C-7 follows" title="Description of Figure C-7 follows" longdesc="img_text/appendchildxml.html"><br><a href="img_text/appendchildxml.html">Description of "Figure C-7 APPENDCHILDXML Syntax"</a></div>
                  <!-- class="figure" -->
                  <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-7F8F13A6-493A-4831-B698-0FCC07508222__BABEGBAD">Example C-12</a> uses deprecated Oracle SQL function <code class="codeph">appendChildXML</code> to insert a <code class="codeph">Date</code> element as the last child of an <code class="codeph">Action</code> element.
                  </p>
                  <div class="infoboxnote" id="GUID-7F8F13A6-493A-4831-B698-0FCC07508222__GUID-974B6DEE-7752-4621-9789-629547CAC559">
                     <p class="notep1">Note:</p>
                     <p>Queries that use Oracle SQL function <code class="codeph">appendChildXML</code> are <span class="italic">not</span> optimized. For this reason, Oracle recommends that you use function <code class="codeph">insertChildXML</code>, <code class="codeph">insertChildXMLbefore</code>, or <code class="codeph">insertChildXMLafter</code> instead. See <a href="query-and-update-XML.html#GUID-F72DC7CD-40A9-4F07-9350-B80D2AD1F4D0" title="A SQL query that involves XQuery expressions can often be automatically rewritten (optimized) in one or more ways. This optimization is referred to as XML query rewrite or optimization. When this happens, the XQuery expression is, in effect, evaluated directly against the XML document without constructing a DOM in memory.">Performance Tuning for XQuery</a> for more information.
                     </p>
                  </div>
                  <div class="example" id="GUID-7F8F13A6-493A-4831-B698-0FCC07508222__BABEGBAD">
                     <p class="titleinexample">Example C-12 Insertion as the Last Child Using APPENDCHILDXML (Deprecated)</p><pre class="oac_no_warn" dir="ltr">SELECT XMLQuery('$p/PurchaseOrder/Actions/Action[1]'
                PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="AMCEWEN-20021009123336171PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");

XMLQUERY('$P/PURCHASEORDER/ACTIONS/ACTION[1]'PASSINGPO.OBJECT_VALUE
-------------------------------------------------------------------
&lt;Action&gt;
  &lt;User&gt;KPARTNER&lt;/User&gt;
&lt;/Action&gt;

UPDATE purchaseorder
  SET OBJECT_VALUE = 
      <span class="bold">appendChildXML</span>(OBJECT_VALUE, 
                     'PurchaseOrder/Actions/Action[1]', 
                     XMLType('<span class="bold">&lt;Date&gt;2002-11-04&lt;/Date&gt;</span>'))
  WHERE XMLExists('$p/PurchaseOrder[Reference="AMCEWEN-20021009123336171PDT"]'
                  PASSING OBJECT_VALUE AS "p");

SELECT XMLQuery('$p/PurchaseOrder/Actions/Action[1]'
                PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="AMCEWEN-20021009123336171PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");

XMLQUERY('$P/PURCHASEORDER/ACTIONS/ACTION[1]'PASSINGPO.OBJECT_VALUE
-------------------------------------------------------------------
&lt;Action&gt;
  &lt;User&gt;KPARTNER&lt;/User&gt;
  <span class="bold">&lt;Date&gt;2002-11-04&lt;/Date&gt;</span>
&lt;/Action&gt;</pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="ADXDB6082"></a><a id="ADXDB6083"></a><a id="ADXDB6081"></a><div class="props_rev_3"><a id="GUID-4E781DD7-B60E-49A5-8238-9E7CD207238B" name="GUID-4E781DD7-B60E-49A5-8238-9E7CD207238B"></a><h3 id="ADXDB-GUID-4E781DD7-B60E-49A5-8238-9E7CD207238B" class="sect3"><span class="enumeration_section">C.12 </span>DELETEXML Deprecated Oracle SQL Function
               </h3>
               <div>
                  <p>Deprecated Oracle SQL function <code class="codeph">deleteXML</code> deletes XML nodes of any kind. The XML document that is the target of the deletion can be XML Schema-based or non-schema-based. 
                  </p>
                  <p>A <span class="italic">copy</span> of the input <code class="codeph">XMLType</code> instance is modified and returned. The original data is unaffected. You can then use the returned data with SQL operation <code class="codeph">UPDATE</code> to modify database data.
                  </p>
                  <p>Function <code class="codeph">deleteXML</code> has the following parameters (in order): 
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">target-data</code></span></span> (<code class="codeph">XMLType</code>) &#x2013; The XML data containing the target nodes (to be deleted).
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">xpath</code></span></span> (<code class="codeph">VARCHAR2</code>) &#x2013; An XPath&nbsp;1.0 expression that locates zero or more nodes in <span class="italic"><code class="codeph">target-data</code></span> that are the targets of the deletion operation. <span class="italic">Each</span> of these nodes is deleted. 
                        </p>
                        <p>If <span class="italic"><code class="codeph">xpath</code></span> matches an empty sequence of nodes, then no deletion is done, and <span class="italic"><code class="codeph">target-data</code></span> is returned unchanged (no error is raised). If <span class="italic"><code class="codeph">xpath</code></span> matches the top-level element node, then an error is raised.
                        </p>
                     </li>
                     <li>
                        <p><span class="italic"><span class="bold"><code class="codeph">namespace</code></span></span> (<span class="italic">optional</span>, <code class="codeph">VARCHAR2</code>) &#x2013; The namespace for parameter <span class="italic"><code class="codeph">xpath</code></span>.
                        </p>
                     </li>
                  </ul>
                  <p>The XML nodes located at <span class="italic"><code class="codeph">xpath</code></span> are deleted from <span class="italic"><code class="codeph">target-data</code></span>. Function <code class="codeph">deleteXML</code> returns <code class="codeph">NULL</code> if <span class="italic"><code class="codeph">target-data</code></span> or <span class="italic"><code class="codeph">xpath</code></span> is <code class="codeph">NULL</code>.
                  </p>
                  <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-4E781DD7-B60E-49A5-8238-9E7CD207238B__BABGIGID">Figure C-8</a> shows the syntax.
                  </p>
                  <div class="figure" id="GUID-4E781DD7-B60E-49A5-8238-9E7CD207238B__BABGIGID">
                     <p class="titleinfigure">Figure C-8 DELETEXML Syntax</p><img src="img/deletexml.gif" width="471" alt="Description of Figure C-8 follows" title="Description of Figure C-8 follows" longdesc="img_text/deletexml.html"><br><a href="img_text/deletexml.html">Description of "Figure C-8 DELETEXML Syntax"</a></div>
                  <!-- class="figure" -->
                  <p><a href="deprecated-functions-for-updating-XML-data.html#GUID-4E781DD7-B60E-49A5-8238-9E7CD207238B__BABEJFDA">Example C-13</a> uses deprecated Oracle SQL function <code class="codeph">deleteXML</code> to delete the <code class="codeph">LineItem</code> element whose <code class="codeph">ItemNumber</code> attribute has value <code class="codeph">222</code>.
                  </p>
                  <div class="example" id="GUID-4E781DD7-B60E-49A5-8238-9E7CD207238B__BABEJFDA">
                     <p class="titleinexample">Example C-13 Deletion of an Element Using DELETEXML (Deprecated)</p><pre class="pre codeblock"><code>SELECT XMLQuery('$p/PurchaseOrder/LineItems/LineItem[@ItemNumber=222]'
                PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="AMCEWEN-20021009123336171PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");

XMLQUERY('$P/PURCHASEORDER/LINEITEMS/LINEITEM[@ITEMNUMBER=222]'PASSINGPO
------------------------------------------------------------------------
&lt;LineItem ItemNumber="222"&gt;
  &lt;Description&gt;The Harder They Come&lt;/Description&gt;
  &lt;Part Id="953562951413" UnitPrice="22.95" Quantity="1"/&gt;
&lt;/LineItem&gt;

UPDATE purchaseorder
  SET OBJECT_VALUE = 
      <span class="bold">deleteXML</span>(OBJECT_VALUE, 
                '/PurchaseOrder/LineItems/LineItem[@ItemNumber="222"]')
  WHERE XMLExists('$p/PurchaseOrder[Reference="AMCEWEN-20021009123336171PDT"]'
                  PASSING OBJECT_VALUE AS "p");

SELECT XMLQuery('$p/PurchaseOrder/LineItems/LineItem[@ItemNumber=222]'
                PASSING po.OBJECT_VALUE AS "p" RETURNING CONTENT)
  FROM purchaseorder po
  WHERE XMLExists('$p/PurchaseOrder[Reference="AMCEWEN-20021009123336171PDT"]'
                  PASSING po.OBJECT_VALUE AS "p");

XMLQUERY('$P/PURCHASEORDER/LINEITEMS/LINEITEM[@ITEMNUMBER=222]'PASSINGPO
------------------------------------------------------------------------
 
1 row selected.
</code></pre></div>
                  <!-- class="example" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>