<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Oracle Sharding sharding is a database scaling technique based on horizontal partitioning of data across multiple Oracle databases.">
      <meta name="description" content="Oracle Sharding sharding is a database scaling technique based on horizontal partitioning of data across multiple Oracle databases.">
      <title>Oracle Sharding Architecture</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Database Concepts">
      <meta property="og:description" content="Oracle Sharding sharding is a database scaling technique based on horizontal partitioning of data across multiple Oracle databases.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Database Concepts">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="database-concepts.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-03-22T11:18:58-07:00">
      <meta name="dcterms.title" content="Database Concepts">
      <meta name="dcterms.dateCopyrighted" content="1993, 2018">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E85769-04">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/12.2">
      <meta name="dcterms.release" content="Release 12.2">
      <link rel="prev" href="application-and-networking-architecture.html" title="Previous" type="text/html">
      <link rel="next" href="multitenant-architecture.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"12.2","element_name":"Release 12.2","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="CNCPT">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="application-and-networking-architecture.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="multitenant-architecture.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Database Concepts</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-instance-architecture.html" property="item" typeof="WebPage"><span property="name">Oracle Instance Architecture</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Oracle Sharding Architecture</li>
            </ol>
            <a id="GUID-3B87285B-F156-4CDA-87F7-BF4FC0E2EE5E" name="GUID-3B87285B-F156-4CDA-87F7-BF4FC0E2EE5E"></a>
            
            <h2 id="CNCPT-GUID-3B87285B-F156-4CDA-87F7-BF4FC0E2EE5E" class="sect2"><span class="enumeration_chapter">17 </span>Oracle Sharding Architecture
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Oracle Sharding sharding is a database scaling technique based on horizontal partitioning of data across multiple Oracle databases.</p>
               <p>This chapter contains the following topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="oracle-sharding-architecture.html#GUID-D90D0A33-1BCB-48D8-8193-8FD1C2959371" title="Sharding is a data tier architecture in which data is horizontally partitioned across independent databases.">About Sharding</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-sharding-architecture.html#GUID-0D1CBC48-93D0-41A9-9786-4285FE060C97" title="Sharding provides linear scalability and complete fault isolation for the most demanding OLTP applications.">Benefits of Sharding</a></p>
                  </li>
                  <li>
                     <p><a href="oracle-sharding-architecture.html#GUID-3D41F762-BE04-486D-8018-C7A210D809F9" title="Oracle Sharding is a scalability and availability feature for suitable OLTP applications. It enables distribution and replication of data across a pool of Oracle databases that share no hardware or software.">Components of the Oracle Sharding Architecture</a></p>
                  </li>
               </ul>
            </div>
            <div class="sect2"><a id="GUID-D90D0A33-1BCB-48D8-8193-8FD1C2959371" name="GUID-D90D0A33-1BCB-48D8-8193-8FD1C2959371"></a><h3 id="CNCPT-GUID-D90D0A33-1BCB-48D8-8193-8FD1C2959371" class="sect3">About Sharding</h3>
               <div>
                  <p><span class="italic">Sharding</span> is a data tier architecture in which data is horizontally partitioned across independent databases. 
                  </p>
                  <p>Each <span>database is hosted on dedicated server with its own local resources - CPU, memory, flash, or disk.</span> <span>Each database in such configuration is called a <strong class="term">shard</strong>.</span> <span>All of the shards together make up a single logical database, which is referred to as a <strong class="term">sharded database (SDB)</strong>.</span></p>
                  <p><span>Horizontal partitioning involves splitting a database table across shards so that each shard contains the table with the same columns but a different subset of rows. A table split up in this manner is also known as a <span class="italic">sharded table</span>.</span></p>
                  <p>The following figure shows a table horizontally partitioned across three shards.</p>
                  <div class="figure" id="GUID-D90D0A33-1BCB-48D8-8193-8FD1C2959371__GUID-4242B296-023B-4842-981C-DFE75CA2E713">
                     <p class="titleinfigure">Figure 17-1 Horizontal Partitioning of a Table Across Shards</p><img src="img/admin_3v_134a.png" alt="Description of Figure 17-1 follows" title="Description of Figure 17-1 follows" longdesc="img_text/admin_3v_134a.html"><br><a href="img_text/admin_3v_134a.html">Description of "Figure 17-1 Horizontal Partitioning of a Table Across Shards"</a></div>
                  <!-- class="figure" -->
                  <p>Sharding is based on shared-nothing hardware infrastructure and it eliminates single points of failure because shards do not share physical resources such as CPU, memory, or storage devices. Shards are also loosely coupled in terms of software; they do not run clusterware.</p>
                  <p>Shards are typically hosted on dedicated servers. These servers can be commodity hardware or engineered systems. The shards can run on single instance or Oracle RAC databases. They can be placed on-premises, in a cloud, or in a hybrid on-premises and cloud configuration.</p>
                  <p>From the perspective of a database administrator, an SDB consists of multiple databases that can be managed either collectively or individually. However, from the perspective of the application, an SDB looks like a single database: the number of shards and distribution of data across those shards are completely transparent to database applications.</p>
                  <p>Sharding is intended for custom OLTP applications that are suitable for a sharded database architecture. Applications that use sharding must have a well-defined data model and data distribution strategy (consistent hash, range, list, or composite) that primarily accesses data using a sharding key. Examples of a sharding key include <code class="codeph">customer_id</code>, <code class="codeph">account_no</code>, or <code class="codeph">country_id</code>.
                  </p>
               </div>
            </div>
            <div class="sect2"><a id="GUID-0D1CBC48-93D0-41A9-9786-4285FE060C97" name="GUID-0D1CBC48-93D0-41A9-9786-4285FE060C97"></a><h3 id="CNCPT-GUID-0D1CBC48-93D0-41A9-9786-4285FE060C97" class="sect3">Benefits of Sharding</h3>
               <div>
                  <p>Sharding provides linear scalability and complete fault isolation for the most demanding OLTP applications.</p>
                  <p>Key benefits of sharding include:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="bold">Linear Scalability</span>. Sharding eliminates performance bottlenecks and makes it possible to linearly scale performance and capacity by adding shards.
                        </p>
                     </li>
                     <li>
                        <p> <span class="bold">Fault Containment</span>. Sharding is a shared nothing hardware infrastructure that eliminates single points of failure, such as shared disk, SAN, and clusterware, and provides strong fault isolation—the failure or slow-down of one shard does not affect the performance or availability of other shards.
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">Geographical Distribution of Data</span>. Sharding makes it possible to store particular data close to its consumers and satisfy regulatory requirements when data must be located in a particular jurisdiction.
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">Rolling Upgrades</span>. Applying configuration changes on one shard at a time does not affect other shards, and allows administrators to first test the changes on a small subset of data.
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">Simplicity of Cloud Deployment</span>. Sharding is well suited to deployment in the cloud. Shards may be sized as required to accommodate whatever cloud infrastructure is available and still achieve required service levels. Oracle Sharding supports on-premises, cloud, and hybrid deployment models.
                        </p>
                     </li>
                  </ul>
                  <p><span>Unlike NoSQL data stores that implement sharding, Oracle Sharding provides the benefits of sharding without sacrificing the capabilities of an enterprise RDBMS.</span> For example, Oracle Sharding supports:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Relational schemas</p>
                     </li>
                     <li>
                        <p>Database partitioning</p>
                     </li>
                     <li>
                        <p>ACID properties and read consistency</p>
                     </li>
                     <li>
                        <p>SQL and other programmatic interfaces</p>
                     </li>
                     <li>
                        <p>Complex data types</p>
                     </li>
                     <li>
                        <p>Online schema changes</p>
                     </li>
                     <li>
                        <p>Multi-core scalability</p>
                     </li>
                     <li>
                        <p>Advanced security</p>
                     </li>
                     <li>
                        <p>Compression</p>
                     </li>
                     <li>
                        <p>High Availability features</p>
                     </li>
                     <li>
                        <p>Enterprise-scale backup and recovery</p>
                     </li>
                  </ul>
               </div>
            </div>
            <div class="sect2"><a id="GUID-3D41F762-BE04-486D-8018-C7A210D809F9" name="GUID-3D41F762-BE04-486D-8018-C7A210D809F9"></a><h3 id="CNCPT-GUID-3D41F762-BE04-486D-8018-C7A210D809F9" class="sect3">Components of the Oracle Sharding Architecture</h3>
               <div>
                  <p>Oracle Sharding is a scalability and availability feature for suitable OLTP applications. It enables distribution and replication of data across a pool of Oracle databases that share no hardware or software.</p>
                  <p>Applications perceive the pool of databases as a single logical database. Applications can elastically scale data, transactions, and users to any level, on any platform, by adding databases (shards) to the pool. Oracle Database supports scaling up to 1000 shards.</p>
                  <p>The following figure illustrates the major architectural components of Oracle Sharding:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Sharded database (SDB) &#x2013; a single logical Oracle Database that is horizontally partitioned across a pool of physical Oracle Databases (shards) that share no hardware or software</p>
                     </li>
                     <li>
                        <p>Shards - independent physical Oracle databases that host a subset of the sharded database</p>
                     </li>
                     <li>
                        <p>Global service - database services that provide access to data in an SDB</p>
                     </li>
                     <li>
                        <p>Shard catalog &#x2013; an Oracle Database that supports automated shard deployment, centralized management of a sharded database, and multi-shard queries</p>
                     </li>
                     <li>
                        <p>Shard directors &#x2013; network listeners that enable high performance connection routing based on a sharding key</p>
                     </li>
                     <li>
                        <p>Connection pools - at runtime, act as shard directors by routing database requests across pooled connections</p>
                     </li>
                     <li>
                        <p>Management interfaces - GDSCTL (command-line utility) and Oracle Enterprise Manager (GUI)</p>
                     </li>
                  </ul>
                  <div class="figure" id="GUID-3D41F762-BE04-486D-8018-C7A210D809F9__GUID-65F25F7E-0A7B-4DC2-8B45-21DE4055DFA2">
                     <p class="titleinfigure">Figure 17-2 Oracle Sharding Architecture</p><img src="img/admin_3v_143d.png" alt="Description of Figure 17-2 follows" title="Description of Figure 17-2 follows" longdesc="img_text/admin_3v_143d.html"><br><a href="img_text/admin_3v_143d.html">Description of "Figure 17-2 Oracle Sharding Architecture"</a></div>
                  <!-- class="figure" -->
                  <div class="section">
                     <p class="subhead2">Sharded Database and Shards</p>
                     <p>Shards are&nbsp;independent Oracle databases that are hosted on database servers which have their own local resources: CPU, memory, and disk. No shared storage is required across the shards.</p>
                     <p>A&nbsp;sharded database&nbsp;is a collection of&nbsp;shards. Shards can all be placed in one region or can be placed in different regions. A region in the context of Oracle Sharding represents a data center or multiple data centers that are in close network proximity.</p>
                     <p>Shards are replicated for High Availability (HA) and Disaster Recovery (DR) with Oracle replication technologies such as Data Guard. For HA, the standby shards can be placed in the same region where the primary shards are placed. For DR, the standby shards are located in another region.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2">Global Service</p>
                     <p>A global service is an extension to the notion of the traditional database service. All of the properties of traditional database services are supported for global services. For sharded databases additional properties are set for global services — for example, database role, replication lag tolerance, region affinity between clients and shards, and so on. For a read-write transactional workload, a single global service is created to&nbsp;access data from any primary shard in an SDB. For highly available shards using Active Data Guard,&nbsp;a separate read-only global service can be created.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2">Shard Catalog</p>
                     <p>The shard catalog is a special-purpose Oracle Database that is a persistent store for SDB configuration data and plays a key role in centralized management of a sharded database. All configuration changes, such as adding and removing shards and global services, are initiated on the shard catalog. All DDLs in an SDB are executed by connecting  to the shard catalog. </p>
                     <p>The shard catalog also contains the master copy of all duplicated tables in an SDB.&nbsp;The shard catalog uses materialized views to automatically replicate changes to duplicated tables in all shards.&nbsp;The shard catalog database also acts as a query coordinator used to process multi-shard queries and queries that do not specify a sharding key.</p>
                     <p>Using Oracle Data Guard for shard catalog high availability is a recommended best practice.&nbsp;The availability of the shard catalog has no impact on the availability of the SDB.&nbsp;An outage of the shard catalog only affects the ability to perform maintenance operations or multi-shard queries during the brief period required to complete an automatic failover to a standby shard catalog.&nbsp;OLTP transactions continue to be routed and executed by the SDB and are unaffected by a catalog outage.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2">Shard Director</p>
                     <p>Oracle Database 12<span class="italic">c</span> introduced the global service manager to route connections based on database role, load, replication lag, and locality. In support of Oracle Sharding, global service managers support routing of connections based on data location. A global service manager, in the context of Oracle Sharding, is known as a shard director.
                     </p>
                     <p>A shard director is a specific implementation of a global service manager that acts as a regional listener for clients that connect to an SDB. The director maintains a current topology map of the SDB. Based on the sharding key passed during a connection request, the director routes the connections to the appropriate shard.</p>
                     <p>For a typical SDB, a set of shard directors are installed on dedicated low-end commodity servers in each region. To achieve high availability, deploy multiple shard directors. In Oracle Database 12<span class="italic">c</span> Release 2, you can deploy up to 5 shard directors in a given region.
                     </p>
                     <p>The following are the key capabilities of shard directors:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Maintain runtime data about SDB configuration and availability of shards</p>
                        </li>
                        <li>
                           <p>Measure network latency between its own and other regions</p>
                        </li>
                        <li>
                           <p>Act as a regional listener for clients to connect to an SDB</p>
                        </li>
                        <li>
                           <p>Manage global services</p>
                        </li>
                        <li>
                           <p>Perform connection load balancing</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2">Connection Pools</p>
                     <p>Oracle Database supports connection-pooling in data access drivers such as OCI, JDBC, and ODP.NET. In Oracle 12<span class="italic">c</span> Release 2, these drivers can recognize sharding keys specified as part of a connection request. Similarly, the Oracle Universal Connection Pool (UCP) for JDBC clients can recognize sharding keys specified in a connection URL.&nbsp;Oracle UCP also enables non-Oracle application clients such as Apache Tomcat and WebSphere to work with Oracle Sharding.
                     </p>
                     <p>Oracle clients use UCP cache routing information to directly route a database request to the appropriate shard, based on the sharding keys provided by the application.&nbsp;Such data-dependent routing of database requests eliminates an extra network hop, decreasing the transactional latency for high volume OLTP applications.</p>
                     <p>Routing information is cached during an initial connection to a shard, which is established using a shard director.&nbsp;Subsequent database requests for sharding keys within the cached range are routed directly to the shard, bypassing the shard director.</p>
                     <p>Like UCP, a shard director can process a sharding key specified in a connect string and cache routing information.&nbsp;However, UCP routes database requests using an already established connection, while a shard director routes connection requests to a shard.&nbsp;The routing cache automatically refreshes when a shard becomes unavailable or changes occur to the sharding topology. For high-performance, data-dependent routing, Oracle recommends using a connection pool when accessing data in the SDB.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2">Management Interfaces for an SDB</p>
                     <p>You can deploy, manage, and monitor Oracle Sharded databases with two interfaces: Oracle Enterprise Manager Cloud Control and GDSCTL.</p>
                     <p>Cloud Control enables life cycle management of a sharded database with a graphical user interface. You can manage and monitor an SDB for availability and performance, and you can do tasks such as add and deploy shards, services, shard directors, and other sharding components.</p>
                     <p>GDSCTL is a command-line interface that provides a simple declarative way of specifying the configuration of an SDB and automating its deployment. Only a few GDSCTL commands are required to create an SDB, for example:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">CREATE SHARDCATALOG</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">ADD GSM</code> and <code class="codeph">START GSM</code>&nbsp;(create and start shard directors)
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">CREATE SHARD</code>&nbsp;(for each shard)
                           </p>
                        </li>
                        <li>
                           <p><code class="codeph">DEPLOY</code></p>
                        </li>
                     </ul>
                     <p>The&nbsp;GDSCTL <code class="codeph">DEPLOY</code>&nbsp;command automatically creates the shards and their respective listeners.&nbsp;In addition, this command automatically deploys the replication configuration used for shard-level high availability specified by the administrator.
                     </p>
                     <div class="infoboxnotealso" id="GUID-3D41F762-BE04-486D-8018-C7A210D809F9__GUID-C349D164-B810-4A36-8F92-C8ABEF5D502D">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../gsmug/intro-global-data-services.html#GSMUG-GUID-415B8BB5-5C8D-4C78-8E76-43DB1648E467"><span><cite>Oracle Database Global Data Services Concepts and Administration Guide</cite></span></a> for information about global service managers, global services, and the GDSCTL commands used with Oracle Sharding
                              </p>
                           </li>
                           <li>
                              <p>Oracle Sharding best practices white papers in the Oracle Database section of the <a href="http://www.oracle.com/goto/maa">Oracle MAA web page</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>