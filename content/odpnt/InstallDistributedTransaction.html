<!DOCTYPE html
  SYSTEM "about:legacy-compat">

<!-- saved from url=(0023)https://docs.oracle.com -->

<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Distributed Transactions</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Developer's Guide ">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Developer's Guide for Microsoft Windows">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 17.8.1">
      <link rel="alternate" href="oracle-data-provider-net.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2017-11-27T18:06:48-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2002, 2017">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E83836-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/12.2">
      <meta name="dcterms.release" content="Release 12.2">
      <link rel="prev" href="InstallManagedConfig.html" title="Previous" type="text/html">
      <link rel="next" href="InstallConfigDiff.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">
            {
                "primary":
                {
                    "category":{
                      "short_name":"database",
                      "element_name":"Database",
                      "display_in_url":true
                    },
                    "suite":{
                      "short_name":"oracle",
                      "element_name":"Oracle",
                      "display_in_url":true
                    },
                    "product_group":{
                      "short_name":"not-applicable",
                      "element_name":"Not applicable",
                      "display_in_url":false
                    },
                    "product":{
                      "short_name":"oracle-database",
                      "element_name":"Oracle Database",
                      "display_in_url":true
                    },
                    "release":{
                      "short_name":"12.2",
                      "element_name":"Release 12.2",
                      "display_in_url":true
                    },
                    "platform":{
                      "short_name":"",
                      "element_name":"",
                      "display_in_url":false
                    },
                    "component":{
                      "short_name":"",
                      "element_name":"",
                      "display_in_url":false
                    }
                }
            }
            </script>
      
    <meta name="dcterms.title" content="OracleÂ® Data Provider for .NET">
    <meta name="dcterms.isVersionOf" content="ODPNT">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="InstallManagedConfig.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="InstallConfigDiff.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Developer's Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="install.html" property="item" typeof="WebPage"><span property="name">Installing and Configuring Oracle Data Provider for .NET</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Distributed Transactions</li>
            </ol>
            <a id="GUID-D8CE1DB4-A695-450B-B29C-9C6AD98077AA" name="GUID-D8CE1DB4-A695-450B-B29C-9C6AD98077AA"></a><a id="ODPNT8172"></a>
            
            <h2 id="ODPNT-GUID-D8CE1DB4-A695-450B-B29C-9C6AD98077AA" class="sect2"><span class="enumeration_section">2.10 </span>Distributed Transactions
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>ODP.NET, Managed and Unmanaged Drivers provide its resource manager, which manage Oracle database transactions, and work in cooperation with Microsoft Distributed Transaction Coordinator (MSDTC) to guarantee atomicity and isolation to an application across networks. MSDTC coordinates with all the resource managers that are enlisted to the same <code class="codeph">System.Transactions</code>, to perform 2-phrase commit or rollback atomically. With that, Oracle distributed transactions can then be committed or rolled back across networks properly.
               </p>
            </div><a id="ODPNT8500"></a><div class="props_rev_3"><a id="GUID-9D0D5DA9-085D-439E-8DA3-5DB2C397E695" name="GUID-9D0D5DA9-085D-439E-8DA3-5DB2C397E695"></a><h3 id="ODPNT-GUID-9D0D5DA9-085D-439E-8DA3-5DB2C397E695" class="sect3"><span class="enumeration_section">2.10.1 </span>Oracle Services for Microsoft Transaction Server
               </h3>
               <div>
                  <p>Oracle Services for Microsoft Transaction (OraMTS) allow client components to leverage Oracle database participation in MSDTC transactions. It acts as a proxy for the Oracle database to MSDTC to ensure that Oracle distributed database transactions commit or rollback together with the rest of the distributed transaction.</p>
                  <p>If a failure occurs, such as a network failure or server hardware failure, then it can leave an in-process distributed transaction in-doubt. OraMTS has a recovery service to resolve these transactions on the machine that began this transaction. This recovery service runs as a Windows service. </p>
                  <p>It is required to install the OraMTS Recovery Service on all the client machines where ODP.NET is running and participating in MSDTC. As a machine may have multiple IP addresses, administrators for managed ODP.NET applications can specify the host machine name or IP address that has the running recovery service in the application's .NET configuration file. ODP.NET, Unmanaged Driver resolves the IP/machine name for the recovery service automatically.</p>
                  <p>With .NET Framework 4.5.2, Microsoft introduced new API support that allows Oracle to use only managed calls to coordinate ODP.NET transactions with the MSDTC. ODP.NET utilizes this managed code with the managed driver (starting with ODAC 12<span class="italic">c</span> Release 3) and with the unmanaged driver (starting with ODAC 12<span class="italic">c</span> Release 4). 
                  </p>
                  <p>While ODP.NET, Unmanaged Driver developers can opt out of using OraMTS when using the latest .NET Framework and ODP.NET versions, they still need to install and configure the OraMTS Windows recovery service to manage recovery scenarios.</p>
                  <div class="tblformal" id="GUID-9D0D5DA9-085D-439E-8DA3-5DB2C397E695__GUID-D9ED0FDE-B9C0-44AB-A7DC-AF0A910288F5">
                     <p class="titleintable">Table 2-8 Supported ODP.NET Type and .NET Framework Version for Distributed Transaction </p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="Supported ODP.NET Type and .NET Framework Version for Distributed Transaction " summary="column 1 lists the ODP.NET type, column 2 the corresponding .NET Framework version, and column 3 its distributed transaction support" width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="20%" id="d53648e136">ODP.NET Type</th>
                              <th align="left" valign="bottom" width="26%" id="d53648e139">.NET Framework Version</th>
                              <th align="left" valign="bottom" width="55%" id="d53648e142">Distributed Transaction Support</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d53648e147" headers="d53648e136 ">
                                 <p>Managed</p>
                              </td>
                              <td align="left" valign="top" width="26%" headers="d53648e147 d53648e139 ">
                                 <p>4.5.2 and higher</p>
                              </td>
                              <td align="left" valign="top" width="55%" headers="d53648e147 d53648e142 ">
                                 <p>Uses .NET Framework's native managed implementation (default) for distributed transactions. This is Oracle's recommended approach. </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d53648e157" headers="d53648e136 ">
                                 <p>Managed</p>
                              </td>
                              <td align="left" valign="top" width="26%" headers="d53648e157 d53648e139 ">
                                 <p>4.5.1 and lower</p>
                              </td>
                              <td align="left" valign="top" width="55%" headers="d53648e157 d53648e142 ">
                                 <p>Uses the <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d53648e169" headers="d53648e136 ">
                                 <p>Unmanaged</p>
                              </td>
                              <td align="left" valign="top" width="26%" headers="d53648e169 d53648e139 ">
                                 <p>4.5.2 and higher</p>
                              </td>
                              <td align="left" valign="top" width="55%" headers="d53648e169 d53648e142 ">
                                 <p>Uses OraMTS (default) or managed OraMTS implementation. Oracle recommends using managed OraMTS for unmanaged ODP.NET applications requiring high availability from Oracle RAC or Data Guard.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="20%" id="d53648e179" headers="d53648e136 ">
                                 <p>Unmanaged</p>
                              </td>
                              <td align="left" valign="top" width="26%" headers="d53648e179 d53648e139 ">
                                 <p>4.5.1 and lower</p>
                              </td>
                              <td align="left" valign="top" width="55%" headers="d53648e179 d53648e142 ">
                                 <p>Uses OraMTS</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <div class="infoboxnote" id="GUID-9D0D5DA9-085D-439E-8DA3-5DB2C397E695__GUID-A08F472F-4631-4936-BD3C-1307EA79808B">
                     <p class="notep1">Note:</p>
                     <p>While .NET Framework 4.5.1 and lower within the .NET Framework 4 family are no longer supported, administrators can still use any of the distributed transaction configurations listed above in conjunction with .NET 4.5.2 and higher. For .NET 4.5.1 and lower, the table merely recommends specific setups based on user configuration. They are not requirements.</p>
                  </div>
                  <div class="infoboxnotealso" id="GUID-9D0D5DA9-085D-439E-8DA3-5DB2C397E695__GUID-00901534-5DE4-48C5-81FD-1083A69E94CB">
                     <p class="notep1">See Also:</p>
                     <p>Manually Creating an Oracle MTS Recovery Service in <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/12.2/odpnt&amp;id=NTMTS303"><span class="italic">Oracle Services for Microsoft Transaction Server Developer's Guide for Microsoft Windows</span></a>.
                     </p>
                  </div>
               </div>
            </div><a id="ODPNT8501"></a><div class="props_rev_3"><a id="GUID-CF7FB0C7-B8E8-425C-B1CB-8C72CDEC48D6" name="GUID-CF7FB0C7-B8E8-425C-B1CB-8C72CDEC48D6"></a><h3 id="ODPNT-GUID-CF7FB0C7-B8E8-425C-B1CB-8C72CDEC48D6" class="sect3"><span class="enumeration_section">2.10.2 </span>ODP.NET, Managed Driver Setup
               </h3>
               <div>
                  <p>This section explains the setup and configuration steps required for using distributed transactions with ODP.NET, Managed Driver.</p>
                  <p>Oracle recommends that applications use .NET's native managed distributed transaction implementation (default), which is available in .NET Framework 4.5.2 or higher. Applications can set whether .NET's native managed distributed transaction or <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> is used by setting the <code class="codeph">UseManagedDTC</code> parameter in the .NET configuration file. Follow these steps to configure distributed transactions in these .NET Framework versions:
                  </p>
                  <ol>
                     <li>
                        <p>Create and setup the OraMTS recovery service or make sure an existing recovery service is running.</p>
                     </li>
                     <li>
                        <p>Set the value of <code class="codeph">OMTSRECO_PORT</code> in the .NET configuration to specify the port number that the OraMTS recovery service is running. 
                        </p>
                     </li>
                  </ol>
                  <p>Alternatively, you can still use <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> with .NET Framework 4.5.2 and managed ODP.NET. To do so, set <code class="codeph">UseManagedDTC</code> to <code class="codeph">true</code> and follow the instructions listed below for .NET Framework 4.5.1.
                  </p>
                  <p>For .NET Framework 4.5.1 and lower applications, follow these steps to setup and configure managed ODP.NET for distributed instructions:</p>
                  <ol>
                     <li>
                        <p>Create and setup the OraMTS recovery service or make sure an existing recovery service is running.</p>
                     </li>
                     <li>
                        <p>Deploy <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> along with the application.
                        </p>
                     </li>
                     <li>
                        <p>Set the value of <code class="codeph">OMTSRECO_PORT</code> in the .NET configuration to specify the port number that the OraMTS recovery service is running.
                        </p>
                     </li>
                  </ol>
                  <p><code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> is included with ODP.NET, Managed Driver. This DLL makes unmanaged MSDTC COM calls to MSDTC, which means there is a 32-bit version and 64-bit version of this DLL. These two DLLs share the same name. If you are using 32-bit .NET Framework, then deploy the 32-bit <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code>. If you are using 64-bit .NET Framework, then deploy the 64-bit <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code>. The DLLs are located in the following directories:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>For 32-bit .NET Framework: <span class="italic"><code class="codeph">ORACLE_HOME</code></span><code class="codeph">\odp.net\managed\x86</code></p>
                     </li>
                     <li>
                        <p>For 64-bit .NET Framework: ORACLE_HOME<code class="codeph">\odp.net\managed\x64</code></p>
                     </li>
                  </ul>
                  <p>Upon ODP.NET installation, <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> is no longer placed into the Global Assembly Cache (GAC). For applications that use this DLL, <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> must either be placed in the application directory or in the GAC.
                  </p>
                  <p><code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> should not be directly referenced by a .NET application. It will be implicitly loaded by ODP.NET, Managed Driver when using distributed transactions.
                  </p>
                  <p>For applications with platform target <code class="codeph">x64</code> or <code class="codeph">x86</code> specifically, <code class="codeph">Oracle.ManagedDataAccess.dll</code> will load <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> appropriately if it is placed into the GAC or if it resides in the application directory.
                  </p>
                  <p>For applications that target AnyCPU, the corresponding <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> needs to be placed into x64 and x86 subdirectories under wherever the <code class="codeph">Oracle.ManagedDataAccess.dll</code> is loaded from by the application. ODP.NET, Managed Driver will load the appropriate <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> assembly (32-bit or 64-bit), based on whether the application is 32-bit or 64-bit. If both 32-bit and 64-bit versions of <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> are in the GAC, then the appropriate assemblies will be loaded automatically.
                  </p>
               </div>
            </div><a id="ODPNT8502"></a><div class="props_rev_3"><a id="GUID-91E8B4FF-08C7-46DF-8151-42A882D9ACD9" name="GUID-91E8B4FF-08C7-46DF-8151-42A882D9ACD9"></a><h3 id="ODPNT-GUID-91E8B4FF-08C7-46DF-8151-42A882D9ACD9" class="sect3"><span class="enumeration_section">2.10.3 </span>ODP.NET, Unmanaged Driver Setup
               </h3>
               <div>
                  <p>This section explains the setup and configuration steps required for using distributed transactions with ODP.NET, Unmanaged Driver.</p>
                  <p>For .NET Framework 4.5.2 and higher, ODP.NET, Unmanaged Driver has embedded a managed OraMTS implementation into its assembly. OraMTS remains the default implementation for the ODP.NET, Unmanaged Driver, but the managed OraMTS implementation is recommended when using any high availability FAN operations (HA Events = true) with Oracle Real Application Clusters or Oracle Data Guard. The managed OraMTS implementation supports this high availability functionality, while the traditional OraMTS does not.</p>
                  <p>Applications can set whether OraMTS (default) or managed OraMTS is used by setting the <code class="codeph">UseOraMTSManaged</code> parameter in the .NET configuration file.
                  </p>
                  <p>Install and configure OraMTS, including its recovery service to use OraMTS implementation for ODP.NET, Unmanaged Driver.</p>
                  <p>For .NET Framework 4.5.2 and higher applications, you can use the managed OraMTS implementation instead of the traditional OraMTS. To set this up, perform the following steps:</p>
                  <ol>
                     <li>
                        <p>Set <code class="codeph">UseOraMTSManaged</code> to <code class="codeph">true</code> in the .NET configuration file.
                        </p>
                     </li>
                     <li>
                        <p>Create and setup the OraMTS recovery service or make sure an existing recovery service is running.</p>
                     </li>
                  </ol>
                  <div class="infoboxnotealso" id="GUID-91E8B4FF-08C7-46DF-8151-42A882D9ACD9__GUID-FDCC3222-106E-4388-ADDB-5C723373FA40">
                     <p class="notep1">See Also:</p>
                     <p><a href="InstallManagedConfig.html#GUID-A82B8720-BF62-48C4-8D48-E48114759EBE">distributedTransaction section</a> for more information about .NET configuration setup
                     </p>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>