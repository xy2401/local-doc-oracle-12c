<!DOCTYPE html
  SYSTEM "about:legacy-compat">

<!-- saved from url=(0023)https://docs.oracle.com -->

<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Unified auditing enables you to create policies that audit user behavior in the database in a variety of ways.">
      <meta name="description" content="Unified auditing enables you to create policies that audit user behavior in the database in a variety of ways.">
      <title>Auditing Database Activity</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="2 Day + Security Guide ">
      <meta property="og:description" content="Unified auditing enables you to create policies that audit user behavior in the database in a variety of ways.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="2 Day + Security Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 17.8.1">
      <link rel="alternate" href="oracle-database-2-day-security-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2017-10-11T15:35:05-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2006, 2017">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E85658-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/12.2">
      <meta name="dcterms.release" content="Release 12.2">
      <link rel="prev" href="enforcing-row-level-security-with-oracle-label-security.html" title="Previous" type="text/html">
      <link rel="next" href="book-index.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">
            {
                "primary":
                {
                    "category":{
                      "short_name":"database",
                      "element_name":"Database",
                      "display_in_url":true
                    },
                    "suite":{
                      "short_name":"oracle",
                      "element_name":"Oracle",
                      "display_in_url":true
                    },
                    "product_group":{
                      "short_name":"not-applicable",
                      "element_name":"Not applicable",
                      "display_in_url":false
                    },
                    "product":{
                      "short_name":"oracle-database",
                      "element_name":"Oracle Database",
                      "display_in_url":true
                    },
                    "release":{
                      "short_name":"12.2",
                      "element_name":"Release 12.2",
                      "display_in_url":true
                    },
                    "platform":{
                      "short_name":"",
                      "element_name":"",
                      "display_in_url":false
                    },
                    "component":{
                      "short_name":"",
                      "element_name":"",
                      "display_in_url":false
                    }
                }
            }
            </script>
      
    <meta name="dcterms.title" content="Oracle Database 2 Day + Security Guide">
    <meta name="dcterms.isVersionOf" content="TDPSG">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="enforcing-row-level-security-with-oracle-label-security.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="book-index.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">2 Day + Security Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Auditing Database Activity</li>
            </ol>
            <a id="GUID-BF747771-01D1-4BFB-8489-08988E1181F6" name="GUID-BF747771-01D1-4BFB-8489-08988E1181F6"></a><a id="TDPSG50000"></a>
            
            <h2 id="TDPSG-GUID-BF747771-01D1-4BFB-8489-08988E1181F6" class="sect2"><span class="enumeration_chapter">9 </span>Auditing Database Activity
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Unified auditing enables you to create policies that audit user behavior in the database in a variety of ways.</p>
            </div>
            <div>
               <p><strong>Topics:</strong></p>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="auditing-database-activity.html#GUID-60CB5082-498D-471A-BC23-2B9BA645A767">About Auditing</a><br>Auditing is the monitoring and recording of selected user database actions. 
                  </li>
                  <li class="ulchildlink"><a href="auditing-database-activity.html#GUID-81F26882-3BD7-4DF5-9AE5-7BCDFD8625C5">Why Is Auditing Used?</a><br>Auditing enables activities such as enabling user accountability, deterring inappropriate user actions, and investigating suspicious activity. 
                  </li>
                  <li class="ulchildlink"><a href="auditing-database-activity.html#GUID-282F5C87-9DA0-4CEA-8B50-060691097468">Tutorial: Creating a Unified Audit Policy</a><br>In this tutorial, you create unified audit policy that monitors <code class="codeph">SELECT</code> statements on the <code class="codeph">OE.CUSTOMERS</code> table. 
                  </li>
               </ul>
            </div>
            <a id="TDPSG50051"></a><div class="props_rev_3"><a id="GUID-60CB5082-498D-471A-BC23-2B9BA645A767" name="GUID-60CB5082-498D-471A-BC23-2B9BA645A767"></a><h3 id="TDPSG-GUID-60CB5082-498D-471A-BC23-2B9BA645A767" class="sect3"><span class="enumeration_section">9.1 </span>About Auditing
               </h3>
               <div>
                  <p>Auditing is the monitoring and recording of selected user database actions. </p>
                  <p>To perform auditing, you must be granted the appropriate system privileges. To better facilitate separation of duty, the following two default roles are provided:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">AUDIT_ADMIN</code> role, which enables you to configure auditing and administer both unified audit policies and fine-grained audit policies. It also enables you to view and analyze audit data. Typically, security administrators are granted this role.
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">AUDIT_VIEWER</code> role, which enables you to view and analyze audit data only. Typically, external auditors are granted this role.
                        </p>
                     </li>
                  </ul>
                  <p>This section provides an introduction to unified auditing, which captures audit records from the following locations: </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Audit records (including <code class="codeph">SYS</code> audit records) from unified audit policies and <code class="codeph">AUDIT</code> settings
                        </p>
                     </li>
                     <li>
                        <p>Fine-grained audit records from the <code class="codeph">DBMS_FGA</code> PL/SQL package
                        </p>
                     </li>
                     <li>
                        <p>Oracle Real Application Security audit records</p>
                     </li>
                     <li>
                        <p>Oracle Recovery Manager audit records</p>
                     </li>
                     <li>
                        <p>Oracle Database Vault audit records</p>
                     </li>
                     <li>
                        <p>Oracle Label Security audit records</p>
                     </li>
                  </ul>
                  <p>Oracle Database consolidates these records in one location, in one format, viewable from the <code class="codeph">UNIFIED_AUDIT_TRAIL</code> view for single database instances and <code class="codeph">GV$UNIFIED_AUDIT_TRAIL</code> for Oracle Real Application Clusters environments. 
                  </p>
                  <p>When you upgrade your database to the current release, you must manually migrate to unified auditing if you want to use it. After you complete the migration, in an upgraded database, the audit records from the previous release are still available. You then can archive and purge these older audit trails. Afterwards, the new audit records will be written to the unified audit trail. </p>
                  <p>For a newly created database, Oracle Database provides mixed mode-enabled auditing, which enables both the old and new audit facilities to run simultaneously. </p>
                  <p>When you create and enable a unified audit policy, the policy begins to collect audit records right away. You do not need to set initialization parameters to enable overall auditing, as was necessary in previous releases. The policy can be as simple as auditing the activities of a single user or you can create complex audit policies that use conditions. You can have more than one audit policy in effect at a time in a database. An audit policy can contain both system-wide and object-specific audit options. Most of the auditing that you will do for general activities (including standard auditing) requires the use of audit policies</p>
                  <p>Another type of auditing is fine-grained auditing. Fine-grained auditing provides most of the auditing capabilities as unified auditing, plus the following functionality: </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="bold">Auditing specific columns.</span> You can audit specific relevant columns that hold sensitive information, such as salaries or Social Security numbers. 
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">Using event handlers.</span> For example, you can write a function that sends an email alert to a security administrator when an audited column that should not be changed at midnight is updated. 
                        </p>
                     </li>
                  </ul>
                  <p>Oracle provides three predefined audit policies that cover commonly used security relevant audit settings. These policies are designed to provide an effective method of enforcing strong internal controls so that your site meets its regulatory compliance requirements. </p>
                  <div class="infoboxnotealso" id="GUID-60CB5082-498D-471A-BC23-2B9BA645A767__GUID-C9D2301D-1EB4-447E-8AB9-DF2A08146CA5">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../upgrd/changes-in-12c-release-2-upgrade.html#UPGRD52756"><span><cite>Oracle Database Upgrade Guide</cite></span></a> for information about migrating to unified auditing and about mixed mode auditing
                           </p>
                        </li>
                        <li>
                           <p><a href="../dbseg/part_6.html#DBSEG006"><span><cite>Oracle Database Security Guide</cite></span></a> for information about archiving and purging the audit trail
                           </p>
                        </li>
                        <li>
                           <p><a href="../dbseg/configuring-audit-policies.html#DBSEG525"><span><cite>Oracle Database Security Guide</cite></span></a> for information about fine-grained auditing
                           </p>
                        </li>
                        <li>
                           <p><a href="../dbseg/configuring-audit-policies.html#DBSEG356"><span><cite>Oracle Database Security Guide</cite></span></a> for more information about the predefined audit policies
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="TDPSG50511"></a><div class="props_rev_3"><a id="GUID-81F26882-3BD7-4DF5-9AE5-7BCDFD8625C5" name="GUID-81F26882-3BD7-4DF5-9AE5-7BCDFD8625C5"></a><h3 id="TDPSG-GUID-81F26882-3BD7-4DF5-9AE5-7BCDFD8625C5" class="sect3"><span class="enumeration_section">9.2 </span>Why Is Auditing Used?
               </h3>
               <div>
                  <p>Auditing enables activities such as enabling user accountability, deterring inappropriate user actions, and investigating suspicious activity. </p>
                  <p></p>
                  <p>Auditing is used for the following reasons:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="bold">Enable accountability for actions.</span> These include actions taken in a particular schema, table, or row, or affecting specific content.
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">Deter users from inappropriate actions based on that accountability.</span></p>
                     </li>
                     <li>
                        <p><span class="bold">Investigate suspicious activity.</span> For example, if a user is deleting data from tables, then a security administrator might decide to audit all connections to the database and all successful and unsuccessful deletions of rows from all tables in the database. 
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">Notify an auditor of actions by an unauthorized user.</span> For example, an unauthorized user could change or delete data, or a user has more privileges than expected, which can lead to reassessing user authorizations.
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">Detect problems with an authorization or access control implementation.</span> For example, you can create audit policies that you expect will never generate an audit record because the data is protected in other ways. However, if these policies do generate audit records, then you will know the other security controls are not properly implemented.
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">Address auditing requirements for compliance.</span> Regulations such as the following have common auditing-related requirements: 
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Sarbanes-Oxley Act</p>
                           </li>
                           <li>
                              <p>Health Insurance Portability and Accountability Act (HIPAA)</p>
                           </li>
                           <li>
                              <p>International Convergence of Capital Measurement and Capital Standards: a Revised Framework (Basel II)</p>
                           </li>
                           <li>
                              <p>Japan Privacy Law</p>
                           </li>
                           <li>
                              <p>European Union Directive on Privacy and Electronic Communications</p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p><span class="bold">Monitor and gather data about specific database activities.</span> For example, the database administrator can gather statistics about which tables are being updated, how many logical I/O operations are performed, or how many concurrent users connect at peak times.
                        </p>
                     </li>
                  </ul>
               </div>
            </div><a id="TDPSG50528"></a><div class="props_rev_3"><a id="GUID-282F5C87-9DA0-4CEA-8B50-060691097468" name="GUID-282F5C87-9DA0-4CEA-8B50-060691097468"></a><h3 id="TDPSG-GUID-282F5C87-9DA0-4CEA-8B50-060691097468" class="sect3"><span class="enumeration_section">9.3 </span>Tutorial: Creating a Unified Audit Policy
               </h3>
               <div>
                  <p>In this tutorial, you create unified audit policy that monitors <code class="codeph">SELECT</code> statements on the <code class="codeph">OE.CUSTOMERS</code> table. 
                  </p>
               </div>
               <div>
                  <p><strong>Topics:</strong></p>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="auditing-database-activity.html#GUID-9F687165-559C-4C7E-9B3F-41BAEFB2DE32">Step 1: If Necessary, Enable Unified Auditing</a><br>In this procedure, you check if unified auditing has been enabled, and if it has not, you enable it. 
                     </li>
                     <li class="ulchildlink"><a href="auditing-database-activity.html#GUID-6826D46D-C75C-4E14-AC32-39A1536055A1">Step 2: Grant the SEC_ADMIN User the AUDIT_ADMIN Role</a><br>Next, you are ready to grant the <code class="codeph">sec_admin</code> user the <code class="codeph">AUDIT_ADMIN</code> role, which enables <code class="codeph">SEC_ADMIN</code> to create audit policies. 
                     </li>
                     <li class="ulchildlink"><a href="auditing-database-activity.html#GUID-B647AEF8-1453-4786-AA9F-46ED87C609EB">Step 3: Create and Enable a Unified Audit Policy</a><br>In Enterprise Manager as user <code class="codeph">sec_admin</code>, you can create a unified auditing policy for <code class="codeph">SELECT</code> statements on the <code class="codeph">OE.CUSTOMERS</code> table. 
                     </li>
                     <li class="ulchildlink"><a href="auditing-database-activity.html#GUID-2CB4E1B6-B67B-41CA-BF6F-208F7A701664">Step 4: Test the Unified Audit Policy</a><br>With auditing enabled, you are ready to test the audit settings. 
                     </li>
                     <li class="ulchildlink"><a href="auditing-database-activity.html#GUID-AA2587D0-F93F-4B25-A543-E41D04A69FFE">Step 5: Optionally, Remove the Components for This Tutorial</a><br>You can remove the components of this tutorial if you no longer need them. 
                     </li>
                     <li class="ulchildlink"><a href="auditing-database-activity.html#GUID-EE3AC409-4410-4430-9E7B-847B0BBCAFCF">Step 6: Optionally, Remove the SEC_ADMIN Security Administrator Account</a><br>If you no longer need the <code class="codeph">sec_admin</code> administrator account, then you should remove it.
                     </li>
                  </ul>
               </div>
               <a id="TDPSG55281"></a><div class="props_rev_3"><a id="GUID-9F687165-559C-4C7E-9B3F-41BAEFB2DE32" name="GUID-9F687165-559C-4C7E-9B3F-41BAEFB2DE32"></a><h4 id="TDPSG-GUID-9F687165-559C-4C7E-9B3F-41BAEFB2DE32" class="sect4"><span class="enumeration_section">9.3.1 </span>Step 1: If Necessary, Enable Unified Auditing
                  </h4>
                  <div>
                     <p>In this procedure, you check if unified auditing has been enabled, and if it has not, you enable it. </p>
                     <div class="section">
                        <p class="subhead3">To enable unified auditing: </p>
                        <ol>
                           <li>
                              <p>Log in to SQL*Plus as user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> administrative privilege.
                              </p><pre class="oac_no_warn" dir="ltr">sqlplus sys as sysdba
Enter password: <span class="italic">password</span>
</pre></li>
                           <li>
                              <p>Run the following query to find out if your database has been migrated to use unified auditing. Enter <code class="codeph">Unified Auditing</code> in the case shown here. 
                              </p><pre class="oac_no_warn" dir="ltr">SELECT VALUE FROM V$OPTION WHERE PARAMETER = 'Unified Auditing';
</pre><p>If the output for the <code class="codeph">VALUE</code> column is <code class="codeph">FALSE</code>, then complete the remaining steps in this section to migrate to unified auditing. If the output is <code class="codeph">TRUE</code>, then unified auditing is enabled and you can go to <a href="auditing-database-activity.html#GUID-6826D46D-C75C-4E14-AC32-39A1536055A1" title="Next, you are ready to grant the sec_admin user the AUDIT_ADMIN role, which enables SEC_ADMIN to create audit policies.">Step 2: Grant the SEC_ADMIN User the AUDIT_ADMIN Role</a>. 
                              </p>
                           </li>
                           <li>
                              <p>Stop the database. </p>
                              <p>For single-instance installations, enter the following commands from SQL*Plus:</p><pre class="oac_no_warn" dir="ltr">SHUTDOWN IMMEDIATE
EXIT
</pre><p>For Windows systems, stop the Oracle service:</p><pre class="oac_no_warn" dir="ltr">net stop OracleService%ORACLE_SID%
</pre><p>For Oracle Real Application Clusters (Oracle RAC) installations, shut down each database instance as follows: </p><pre class="oac_no_warn" dir="ltr">srvctl stop database -db <span class="italic">db_name</span>
</pre></li>
                           <li>
                              <p>Stop the listener. (Stopping the listener is not necessary for Oracle RAC and Grid Infrastructure listeners.)</p><pre class="oac_no_warn" dir="ltr">lsnrctl stop <span class="italic">listener_name</span>
</pre><p>You can find the name of the listener by running the <code class="codeph">lsnrctl status</code> command. The name is indicated by the <code class="codeph">Alias</code> setting.
                              </p>
                           </li>
                           <li>
                              <p>Go to the <code class="codeph">$ORACLE_HOME/rdbms/lib</code> directory.
                              </p>
                           </li>
                           <li>
                              <p>Enable the unified auditing executable. </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><span class="bold">UNIX:</span> Run the following command: 
                                    </p><pre class="oac_no_warn" dir="ltr">make -f ins_rdbms.mk uniaud_on ioracle ORACLE_HOME=$ORACLE_HOME
</pre></li>
                                 <li>
                                    <p><span class="bold">Windows:</span> Rename the <code class="codeph">%ORACLE_HOME%/bin/orauniaud12.dll.option</code> file to <code class="codeph">%ORACLE_HOME%/bin/orauniaud12.dll</code>. 
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>Restart the listener.</p><pre class="oac_no_warn" dir="ltr">lsnrctl start <span class="italic">listener_name</span>
</pre></li>
                           <li>
                              <p>Restart the database. Log in to SQL*Plus and then enter the <code class="codeph">STARTUP</code> command as follows:
                              </p><pre class="oac_no_warn" dir="ltr">sqlplus sys as sysoper
Enter password: <span class="italic">password</span>

SQL&gt; STARTUP
</pre><p>For Windows systems, start the Oracle service again.</p><pre class="oac_no_warn" dir="ltr">net start OracleService%ORACLE_SID%
</pre><p>For Oracle RAC installations, from a command line, restart the database as follows: </p><pre class="oac_no_warn" dir="ltr">srvctl setenv database -db orcl</pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TDPSG94453"></a><div class="props_rev_3"><a id="GUID-6826D46D-C75C-4E14-AC32-39A1536055A1" name="GUID-6826D46D-C75C-4E14-AC32-39A1536055A1"></a><h4 id="TDPSG-GUID-6826D46D-C75C-4E14-AC32-39A1536055A1" class="sect4"><span class="enumeration_section">9.3.2 </span>Step 2: Grant the SEC_ADMIN User the AUDIT_ADMIN Role
                  </h4>
                  <div>
                     <p>Next, you are ready to grant the <code class="codeph">sec_admin</code> user the <code class="codeph">AUDIT_ADMIN</code> role, which enables <code class="codeph">SEC_ADMIN</code> to create audit policies. 
                     </p>
                     <div class="section">
                        <p class="subhead3">To grant the SEC_ADMIN user the AUDIT_ADMIN role: </p>
                        <ol>
                           <li>
                              <p>Access the Database home page for your target database as user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> administrative privilege.
                              </p>
                              <p>See <a href="../admqs/getting-started-with-database-administration.html#ADMQS033"><span><cite>Oracle Database 2 Day DBA</cite></span></a> for more information. 
                              </p>
                           </li>
                           <li>
                              <p>From the <span class="bold">Schema</span> menu, select <span class="bold">Users</span>.
                              </p>
                           </li>
                           <li>
                              <p>Select the <span class="bold">SEC_ADMIN</span> account and click <span class="bold">Edit</span>. 
                              </p>
                              <p>If the sec_admin user account does not exist, see <a href="managing-user-privileges.html#GUID-61DD01F3-6446-4677-9002-C522EDCC7298" title="For greater security, you should apply separation of duty concepts when you assign responsibilities to the system administrators on your staff.">Step 2: Create a Security Administrator Account</a> for instructions on how to create the <code class="codeph">sec_admin</code> security administrator account.    
                              </p>
                           </li>
                           <li>
                              <p>In the Edit User: SEC_ADMIN page, select the <span class="bold">Roles</span> tab.
                              </p>
                           </li>
                           <li>
                              <p>Select the <span class="bold">Edit List</span> button.
                              </p>
                           </li>
                           <li>
                              <p>In the Modify Roles page, select <span class="bold">AUDIT_ADMIN</span> from the Available Roles list, and then move it to the Selected Roles list. Click <span class="bold">OK</span>.
                              </p>
                           </li>
                           <li>
                              <p>In the Edit User: SEC_ADMIN page, select the <span class="bold">Object Privileges</span> tab.
                              </p>
                           </li>
                           <li>
                              <p>In the Edit User page: SEC_ADMIN page, from the <span class="bold">Object Type</span> list, select <span class="bold">Package</span>, and then click <span class="bold">Add</span>. 
                              </p>
                           </li>
                           <li>
                              <p>In the Add Package Object Privileges page, do the following: </p>
                              <ol type="a">
                                 <li>
                                    <p>In the <span class="bold">Select Package Objects</span> field, enter <code class="codeph">SYS.DBMS_AUDIT_MGMT</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Under Available Packages, select <span class="bold">EXECUTE</span> and then click <span class="bold">Move</span> to send it to the Selected Privileges list.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Click <span class="bold">OK</span>.
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>In the Edit User page: SEC_ADMIN page, click <span class="bold">Apply</span>.
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TDPSG55282"></a><div class="props_rev_3"><a id="GUID-B647AEF8-1453-4786-AA9F-46ED87C609EB" name="GUID-B647AEF8-1453-4786-AA9F-46ED87C609EB"></a><h4 id="TDPSG-GUID-B647AEF8-1453-4786-AA9F-46ED87C609EB" class="sect4"><span class="enumeration_section">9.3.3 </span>Step 3: Create and Enable a Unified Audit Policy
                  </h4>
                  <div>
                     <p>In Enterprise Manager as user <code class="codeph">sec_admin</code>, you can create a unified auditing policy for <code class="codeph">SELECT</code> statements on the <code class="codeph">OE.CUSTOMERS</code> table. 
                     </p>
                     <div class="section">
                        <p class="subhead3">To create the unified audit policy:</p>
                        <ol>
                           <li>
                              <p>In Enterprise Manager, log out and then log back in again as user <code class="codeph">sec_admin</code>. 
                              </p>
                           </li>
                           <li>
                              <p>From the <span class="bold">Security</span> menu, select <span class="bold">Audit Settings</span>.
                              </p>
                           </li>
                           <li>
                              <p>In the Audit Settings page, click <span class="bold">Create</span>. 
                              </p>
                           </li>
                           <li>
                              <p>In the Create Audit Policy : Privileges and Roles page, enter the following settings:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><span class="bold">Name:</span> Enter <code class="codeph">select_cust_pol</code> for the policy name. 
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Comments:</span> Enter <code class="codeph">Audit policy for SELECT statements on OE.CUSTOMERS</code>.
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>Click the <span class="bold">Next</span> button.
                              </p>
                           </li>
                           <li>
                              <p>In the Create Audit Policy : Component Actions page, click <span class="bold">Next</span>. 
                              </p>
                           </li>
                           <li>
                              <p>In the Create Audit Policy : Object Actions page, click <span class="bold">Add Object</span>. 
                              </p>
                           </li>
                           <li>
                              <p>In the Add Object dialog box, enter the following settings: </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><span class="bold">Schema:</span> <code class="codeph">OE</code></p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Type:</span> <code class="codeph">TABLE</code></p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Object:</span> <code class="codeph">CUSTOMERS</code></p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Action:</span> <code class="codeph">SELECT</code></p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>Click <span class="bold">OK</span>.
                              </p>
                              <p>The Create Audit Policy : Object Actions page should appear as follows: </p>
                              <div class="figure" id="GUID-B647AEF8-1453-4786-AA9F-46ED87C609EB__GUID-1DA90CBB-47FA-4844-8F4D-E3EA7A80D2CA"><img src="img/audit_create.gif" width="480" alt="Description of audit_create.gif follows" title="Description of audit_create.gif follows" longdesc="img_text/audit_create.html"><br><a href="img_text/audit_create.html">Description of the illustration audit_create.gif</a></div>
                              <!-- class="figure" -->
                           </li>
                           <li>
                              <p>In the Create Audit Policy : Object Actions window click <span class="bold">Next</span>. 
                              </p>
                           </li>
                           <li>
                              <p>In the Create Audit Policy : Conditions window, click <span class="bold">Next</span>. In the Create Audit Policy : Review page, click <span class="bold">Submit</span>.
                              </p>
                              <p>The Audit Settings page appears, with <span class="bold">SELECT_CUST_POL</span> in the list of policies.
                              </p>
                           </li>
                           <li>
                              <p>Select <span class="bold">SELECT_CUST_POL</span> and then click the <span class="bold">Enable</span> button.
                              </p>
                           </li>
                           <li>
                              <p>In the Enable Audit Policy dialog box, select the <span class="bold">Few Users</span> check box.
                              </p>
                              <p>The Enable Audit Policy dialog expands so that you can add specific users. </p>
                              <div class="figure" id="GUID-B647AEF8-1453-4786-AA9F-46ED87C609EB__GUID-37FA60DF-1CE3-4349-B428-D20D4E1126E3"><img src="img/audit_enable.png" width="406" alt="Description of audit_enable.png follows" title="Description of audit_enable.png follows" longdesc="img_text/audit_enable.html"><br><a href="img_text/audit_enable.html">Description of the illustration audit_enable.png</a></div>
                              <!-- class="figure" -->
                           </li>
                           <li>
                              <p>Click the <span class="bold">Add User</span> button. 
                              </p>
                           </li>
                           <li>
                              <p>In the Add User dialog box, search for and enter <code class="codeph">OE</code> (select the <code class="codeph">Show Oracle Supplied</code> check box) and ensure that the <span class="bold">Audit on Success</span> and <span class="bold">Audit on Failure</span> check boxes are selected. 
                              </p>
                           </li>
                           <li>
                              <p>Click <span class="bold">OK</span>. 
                              </p>
                           </li>
                           <li>
                              <p>Repeat these steps to add user <span class="bold">HR</span> to the list.
                              </p>
                           </li>
                           <li>
                              <p>Do not exit Enterprise Manager.</p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TDPSG55283"></a><div class="props_rev_3"><a id="GUID-2CB4E1B6-B67B-41CA-BF6F-208F7A701664" name="GUID-2CB4E1B6-B67B-41CA-BF6F-208F7A701664"></a><h4 id="TDPSG-GUID-2CB4E1B6-B67B-41CA-BF6F-208F7A701664" class="sect4"><span class="enumeration_section">9.3.4 </span>Step 4: Test the Unified Audit Policy
                  </h4>
                  <div>
                     <p>With auditing enabled, you are ready to test the audit settings. </p>
                     <div class="section">
                        <p>Any <code class="codeph">SELECT</code> statements that are performed on the <code class="codeph">OE.CUSTOMERS</code> table will be written to the unified audit trail. To find the audit records, you must query the <code class="codeph">UNIFIED_AUDIT_TRAIL</code> dynamic view.
                        </p>
                        <p>A unified auditing policy takes effect in the next user session for the users who are being audited. So, before their audit records can be captured, the users must connect to the database <span class="italic">after</span> the policy has been created. 
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3">To test the audit settings: </p>
                        <ol>
                           <li>
                              <p>In SQL*Plus, connect as user <code class="codeph">OE</code> and query the <code class="codeph">OE.CUSTOMERS</code> table so that you can generate a record for the audit trail. 
                              </p><pre class="oac_no_warn" dir="ltr">connect OE
Enter password: <span class="italic">password</span>

SELECT COUNT(*) FROM CUSTOMERS;

COUNT(*)
--------
     319
</pre></li>
                           <li>
                              <p>Connect as user <code class="codeph">HR</code> and try to run this query. 
                              </p><pre class="oac_no_warn" dir="ltr">connect HR
Enter password: <span class="italic">password</span>

SELECT COUNT(*) FROM OE.CUSTOMERS;

ERROR at line 1:
ORA-00942: table or view does not exist
</pre><p>At this point, the audit trail contains two records, one for a successful query by user <code class="codeph">OE</code> and another for a failed query attempt by user <code class="codeph">HR</code>. 
                              </p>
                           </li>
                           <li>
                              <p>Connect as user <code class="codeph">SH</code> and try to run the same query. 
                              </p><pre class="oac_no_warn" dir="ltr">connect SH
Enter password: <span class="italic">password</span>

SELECT COUNT(*) FROM OE.CUSTOMERS;

ERROR at line 1:
ORA-00942: table or view does not exist
</pre><p>Because this user is not being audited, there should be no audit record for this action.</p>
                           </li>
                           <li>
                              <p>Connect as user <code class="codeph">sec_admin</code>. 
                              </p><pre class="oac_no_warn" dir="ltr">connect sec_admin
Enter password: <span class="italic">password</span>
</pre></li>
                           <li>
                              <p>Run then the following procedure. </p><pre class="oac_no_warn" dir="ltr">EXEC SYS.DBMS_AUDIT_MGMT.FLUSH_UNIFIED_AUDIT_TRAIL;
</pre><p>If the audit trail mode is <code class="codeph">QUEUED</code>, then audit records are not written to disk until the in-memory queues are full. This command explicitly flushes the queues to disk, so that you can see the audit trail records in the <code class="codeph">UNIFIED_AUDIT_TRAIL</code> view.
                              </p>
                           </li>
                           <li>
                              <p>Enter the following statement to query the <code class="codeph">UNIFIED_AUDIT_TRAIL</code> view: 
                              </p><pre class="oac_no_warn" dir="ltr">col dbusername format a12
col sql_text format a30
col event_timestamp format a38

SELECT DBUSERNAME, SQL_TEXT, EVENT_TIMESTAMP
FROM UNIFIED_AUDIT_TRAIL 
WHERE SQL_TEXT LIKE 'SELECT %';
</pre><p>For this <code class="codeph">SELECT</code> statement, enter the text for the <code class="codeph">SQL_TEXT</code> column (<code class="codeph">'SELECT %'</code>) using the same case that you used when you entered the <code class="codeph">SELECT</code> statement for users <code class="codeph">OE</code>, <code class="codeph">HR</code>, and <code class="codeph">SH</code>. In other words, if you entered that <code class="codeph">SELECT</code> statement in lowercase letters, then enter <code class="codeph">'select %'</code> when you query the <code class="codeph">DBA_AUDIT_TRAIL</code> view, not <code class="codeph">'SELECT %'</code>.
                              </p>
                              <p>Output similar to the following appears:</p><pre class="oac_no_warn" dir="ltr">DBUSERNAME SQL_TEXT                          EVENT_TIMESTAMP
---------- --------------------------------- --------------------------------
OE         SELECT COUNT(*) FROM CUSTOMERS    04-JAN-13 03.39.02.468963 PM 
HR         SELECT COUNT(*) FROM OE.CUSTOMERS 04-JAN-13 03.38.05.974127 PM 
</pre><p>Because the audit policy only applied to users <code class="codeph">OE</code> and <code class="codeph">HR</code>, there is no record for user <code class="codeph">SH</code>'s actions.
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TDPSG55284"></a><div class="props_rev_3"><a id="GUID-AA2587D0-F93F-4B25-A543-E41D04A69FFE" name="GUID-AA2587D0-F93F-4B25-A543-E41D04A69FFE"></a><h4 id="TDPSG-GUID-AA2587D0-F93F-4B25-A543-E41D04A69FFE" class="sect4"><span class="enumeration_section">9.3.5 </span>Step 5: Optionally, Remove the Components for This Tutorial
                  </h4>
                  <div>
                     <p>You can remove the components of this tutorial if you no longer need them. </p>
                     <div class="section">
                        <p class="subhead3">To remove the audit settings for this tutorial:</p>
                        <ol>
                           <li>
                              <p>In Enterprise Manager, ensure that you are logged in as user sec_admin. </p>
                           </li>
                           <li>
                              <p>Select Administration, then Security, and then Audit Settings to display the Audit Settings page. </p>
                           </li>
                           <li>
                              <p>Select the <span class="bold">SELECT_CUST_POL</span> policy, click <span class="bold">Disable</span>, and then select <span class="bold">Yes</span> in the Confirmation dialog box. 
                              </p>
                           </li>
                           <li>
                              <p>Select the <span class="bold">SELECT_CUST_POL</span> policy again, click <span class="bold">Delete</span>, and then select <span class="bold">Yes</span> in the Confirmation dialog box. Then click <span class="bold">Yes</span> again. 
                              </p>
                           </li>
                           <li>
                              <p>Log out of Enterprise Manager and then log back in again as user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> administrative privilege. 
                              </p>
                           </li>
                           <li>
                              <p>From the <span class="bold">Schema</span> menu, select <span class="bold">Users</span>.
                              </p>
                           </li>
                           <li>
                              <p>Select the <span class="bold">SEC_ADMIN</span> user and then click <span class="bold">Edit</span>. 
                              </p>
                           </li>
                           <li>
                              <p>In the Edit User : SEC_ADMIN page, select <span class="bold">Roles</span>. 
                              </p>
                           </li>
                           <li>
                              <p>Select the <span class="bold">Edit List</span> button. 
                              </p>
                           </li>
                           <li>
                              <p>In the Modify Roles page, move the <span class="bold">AUDIT_ADMIN</span> role to the Available Roles list and then click <span class="bold">OK</span>. 
                              </p>
                           </li>
                           <li>
                              <p>In the Edit User : SEC_ADMIN page, select the <span class="bold">Object Privileges</span> tab. 
                              </p>
                           </li>
                           <li>
                              <p>Select the <span class="bold">EXECUTE</span> privilege for the <span class="bold">DBMS_AUDIT_MGMT</span> package, and then click <span class="bold">Delete</span>. 
                              </p>
                           </li>
                           <li>
                              <p>Click <span class="bold">Apply</span>. 
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TDPSG55285"></a><div class="props_rev_3"><a id="GUID-EE3AC409-4410-4430-9E7B-847B0BBCAFCF" name="GUID-EE3AC409-4410-4430-9E7B-847B0BBCAFCF"></a><h4 id="TDPSG-GUID-EE3AC409-4410-4430-9E7B-847B0BBCAFCF" class="sect4"><span class="enumeration_section">9.3.6 </span>Step 6: Optionally, Remove the SEC_ADMIN Security Administrator Account
                  </h4>
                  <div>
                     <p>If you no longer need the <code class="codeph">sec_admin</code> administrator account, then you should remove it.
                     </p>
                     <div class="section">
                        <p class="subhead3">To remove the sec_admin security administrator account: </p>
                        <ol>
                           <li>
                              <p>Log in to the database as user <code class="codeph">SYSTEM</code>. 
                              </p>
                           </li>
                           <li>
                              <p>From the Database home page, select <span class="bold">Schema</span>, then <span class="bold">Users</span>. 
                              </p>
                           </li>
                           <li>
                              <p>Select the user <code class="codeph">sec_admin</code>. 
                              </p>
                           </li>
                           <li>
                              <p>Click <span class="bold">Delete</span>. 
                              </p>
                           </li>
                           <li>
                              <p>In the Confirmation page, select <span class="bold">Yes</span>. 
                              </p>
                           </li>
                           <li>
                              <p>Exit Enterprise Manager.</p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>