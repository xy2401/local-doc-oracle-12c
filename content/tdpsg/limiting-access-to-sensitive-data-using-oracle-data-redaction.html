<!DOCTYPE html
  SYSTEM "about:legacy-compat">

<!-- saved from url=(0023)https://docs.oracle.com -->

<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Oracle Data Redaction limits access to sensitive data by redacting this data in real time.">
      <meta name="description" content="Oracle Data Redaction limits access to sensitive data by redacting this data in real time.">
      <title>Limiting Access to Sensitive Data Using&nbsp;Oracle&nbsp;Data Redaction</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="2 Day + Security Guide ">
      <meta property="og:description" content="Oracle Data Redaction limits access to sensitive data by redacting this data in real time.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="2 Day + Security Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 17.8.1">
      <link rel="alternate" href="oracle-database-2-day-security-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2017-10-11T15:35:05-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2006, 2017">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E85658-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/12.2">
      <meta name="dcterms.release" content="Release 12.2">
      <link rel="prev" href="restricting-access-with-oracle-virtual-private-database.html" title="Previous" type="text/html">
      <link rel="next" href="enforcing-row-level-security-with-oracle-label-security.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">
            {
                "primary":
                {
                    "category":{
                      "short_name":"database",
                      "element_name":"Database",
                      "display_in_url":true
                    },
                    "suite":{
                      "short_name":"oracle",
                      "element_name":"Oracle",
                      "display_in_url":true
                    },
                    "product_group":{
                      "short_name":"not-applicable",
                      "element_name":"Not applicable",
                      "display_in_url":false
                    },
                    "product":{
                      "short_name":"oracle-database",
                      "element_name":"Oracle Database",
                      "display_in_url":true
                    },
                    "release":{
                      "short_name":"12.2",
                      "element_name":"Release 12.2",
                      "display_in_url":true
                    },
                    "platform":{
                      "short_name":"",
                      "element_name":"",
                      "display_in_url":false
                    },
                    "component":{
                      "short_name":"",
                      "element_name":"",
                      "display_in_url":false
                    }
                }
            }
            </script>
      
    <meta name="dcterms.title" content="Oracle Database 2 Day + Security Guide">
    <meta name="dcterms.isVersionOf" content="TDPSG">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="restricting-access-with-oracle-virtual-private-database.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="enforcing-row-level-security-with-oracle-label-security.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">2 Day + Security Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Limiting Access to Sensitive Data Using&nbsp;Oracle&nbsp;Data Redaction</li>
            </ol>
            <a id="GUID-66C153C6-CE5C-4D5F-888E-40A06628C708" name="GUID-66C153C6-CE5C-4D5F-888E-40A06628C708"></a><a id="TDPSG94443"></a>
            
            <h2 id="TDPSG-GUID-66C153C6-CE5C-4D5F-888E-40A06628C708" class="sect2"><span class="enumeration_chapter">7 </span>Limiting Access to Sensitive Data Using&nbsp;Oracle&nbsp;Data Redaction
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>Oracle Data Redaction limits access to sensitive data by redacting this data in real time.</p>
            </div>
            <div>
               <p><strong>Topics:</strong></p>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="limiting-access-to-sensitive-data-using-oracle-data-redaction.html#GUID-20F6A24A-A84E-4266-9DD7-6C17267AAD57">About Oracle Data Redaction</a><br>Oracle Data Redaction enables you to redact (mask) column data.
                  </li>
                  <li class="ulchildlink"><a href="limiting-access-to-sensitive-data-using-oracle-data-redaction.html#GUID-F4E365BA-4024-4019-B928-DF52B3FD0500">Tutorial: Redacting Data for a Select Group of Users</a><br>In this tutorial, you create an Oracle Data Redaction policy that redacts data based on the user who has logged in.
                  </li>
               </ul>
            </div>
            <a id="TDPSG94444"></a><div class="props_rev_3"><a id="GUID-20F6A24A-A84E-4266-9DD7-6C17267AAD57" name="GUID-20F6A24A-A84E-4266-9DD7-6C17267AAD57"></a><h3 id="TDPSG-GUID-20F6A24A-A84E-4266-9DD7-6C17267AAD57" class="sect3"><span class="enumeration_section">7.1 </span>About Oracle Data Redaction
               </h3>
               <div>
                  <p>Oracle Data Redaction enables you to redact (mask) column data.</p>
                  <p></p>
                  <p>You can redact data using one of the following methods: </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><span class="bold">Full redaction.</span> You redact all the contents of the column data. The redacted value returned to the querying user depends on the data type of the column. For example, columns of the <code class="codeph">NUMBER</code> data type are redacted with a zero (<code class="codeph">0</code>) and character data types are redacted with a blank space.
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">Partial redaction.</span> You redact a portion of the column data. For example, you can redact most of a credit card number with asterisks (*), except for the last four digits. 
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">Regular expressions.</span> You can use regular expressions in both full and partial redaction. This enables you to redact data based on a search pattern for the data. For example, you can use regular expressions to redact specific phone numbers or email addresses in your data.
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">Redaction using NULL values.</span> This feature enables you to use the <code class="codeph">DBMS_REDACT.NULLIFY</code> function hide all of the sensitive data in a table or view column and replace it with null values. You can set this function by using the <code class="codeph">function_type</code> parameter of the <code class="codeph">DBMS_REDACT.ADD_POLICY</code> or <code class="codeph">DBMS_REDACT.ALTER_POLICY</code> procedure.
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">Random redaction.</span> The redacted data presented to the querying user appears as randomly-generated values each time it is displayed. 
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">No redaction.</span> This option enables you to test the internal operation of your redaction policies, with no effect on the results of queries against tables with policies defined on them. You can use this option to test the redaction policy definitions before applying them to a production environment.
                        </p>
                     </li>
                     <li>
                        <p><span class="bold">Central management of named Data Redaction expressions.</span> This feature enables you to create a library of named policy expressions that can be used in the columns of multiple tables and views. By having named policy expressions, you can centrally manage all of the policy expressions within a database.
                        </p>
                     </li>
                  </ul>
                  <p>Data Redaction performs the redaction at run time, that is, the moment that the user tries to view the data. This functionality is ideally suited for dynamic production systems in which data constantly changes. While the data is being redacted, Oracle Database can process all data normally and preserve the back-end referential integrity constraints. Data redaction can help you to comply with industry regulations such as Payment Card Industry Data Security Standard (PCI DSS) and the Sarbanes-Oxley Act. </p>
                  <div class="infoboxnotealso" id="GUID-20F6A24A-A84E-4266-9DD7-6C17267AAD57__GUID-0CF672D9-4EBA-4234-BE24-BD371030912E">
                     <p class="notep1">See Also:</p><a href="../asoag/introduction-to-oracle-data-redaction.html#ASOAG594"><span><cite>Oracle Database Advanced Security Guide</cite></span></a> for detailed information about Oracle Data Redaction
                  </div>
               </div>
            </div><a id="TDPSG94445"></a><div class="props_rev_3"><a id="GUID-F4E365BA-4024-4019-B928-DF52B3FD0500" name="GUID-F4E365BA-4024-4019-B928-DF52B3FD0500"></a><h3 id="TDPSG-GUID-F4E365BA-4024-4019-B928-DF52B3FD0500" class="sect3"><span class="enumeration_section">7.2 </span>Tutorial: Redacting Data for a Select Group of Users
               </h3>
               <div>
                  <p>In this tutorial, you create an Oracle Data Redaction policy that redacts data based on the user who has logged in.</p>
               </div>
               <div>
                  <p><strong>Topics:</strong></p>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="limiting-access-to-sensitive-data-using-oracle-data-redaction.html#GUID-2CF5F2D2-FE41-4287-9411-CA8280EB5BE7">About Redacting Data for a Select Group of Users</a><br>The scenario for this tutorial is a sales office in which a sales manager must see all data in a table. 
                     </li>
                     <li class="ulchildlink"><a href="limiting-access-to-sensitive-data-using-oracle-data-redaction.html#GUID-1D3CB302-2D03-4B2A-B2BA-125302D656C4">Step 1: Create User Accounts and Grant Them the Necessary Privileges</a><br>First, you must create and grant privileges to the necessary users and roles.
                     </li>
                     <li class="ulchildlink"><a href="limiting-access-to-sensitive-data-using-oracle-data-redaction.html#GUID-D0BF932B-8763-4A5F-A37B-EAA9718CD9E1">Step 2: Create and Populate the SALES_OPPS Sales Opportunities Table</a><br>The <code class="codeph">sales_opps</code> table contains information for small businesses that are sales opportunities. 
                     </li>
                     <li class="ulchildlink"><a href="limiting-access-to-sensitive-data-using-oracle-data-redaction.html#GUID-7EEE12D9-3E09-48D2-AFA5-B0A2FD6A56E6">Step 3: Create the SALES_OPPS_POL Oracle Data Redaction Policy</a><br>As user <code class="codeph">sec_admin</code>, create the <code class="codeph">sales_opps_pol</code> Oracle Data Redaction policy. 
                     </li>
                     <li class="ulchildlink"><a href="limiting-access-to-sensitive-data-using-oracle-data-redaction.html#GUID-5DAF45EB-FB83-4F22-A9F8-A2DCD35ADA06">Step 4: Test the SALES_OPPS_POL Oracle Data Redaction Policy</a><br>Next, you are ready to test the policy. 
                     </li>
                     <li class="ulchildlink"><a href="limiting-access-to-sensitive-data-using-oracle-data-redaction.html#GUID-CAB52AD5-9C3F-4FD8-AA7A-8D59838BC0F4">Step 5: Optionally, Remove the Components for This Tutorial</a><br>You can remove the components that you created for this tutorial if you no longer need them.
                     </li>
                  </ul>
               </div>
               <a id="TDPSG94486"></a><div class="props_rev_3"><a id="GUID-2CF5F2D2-FE41-4287-9411-CA8280EB5BE7" name="GUID-2CF5F2D2-FE41-4287-9411-CA8280EB5BE7"></a><h4 id="TDPSG-GUID-2CF5F2D2-FE41-4287-9411-CA8280EB5BE7" class="sect4"><span class="enumeration_section">7.2.1 </span>About Redacting Data for a Select Group of Users
                  </h4>
                  <div>
                     <p>The scenario for this tutorial is a sales office in which a sales manager must see all data in a table. </p>
                     <p>The sales manager, user <code class="codeph">ezlotkey</code>, must have access to <code class="codeph">sales_opps</code> table, which describes various sales opportunities. However, the sale representatives under this sales manager, users <code class="codeph">ahutton</code> and <code class="codeph">eabel</code>, must have limited access to the <code class="codeph">sales_opps</code> table columns that describe account names and closing dates.
                     </p>
                     <p>To solve this problem, you will create an Oracle Data Redaction policy that accomplishes these needs by performing the following actions: </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The policy redacts data in two columns, each using a different redaction style.</p>
                        </li>
                        <li>
                           <p>The effect of the policy is the display of the query result with either the actual data or the redacted data based on the enabled roles of the querying user.</p>
                        </li>
                     </ul>
                     <p>For this tutorial, you will interact directly with the database by using database user accounts. This is for simplicity. The intended use scenarios for Oracle Data Redaction are twofold: redact database applications and redact direct database access. Oracle Data Redaction on its own is a good solution for redacting sensitive data from packaged and custom applications. After completing the tutorial, you will have the knowledge necessary to apply what you have learned (using the database user accounts) for scenarios that involve actual application users. When direct database access is the target scenario, you should couple Oracle Data Redaction with preventive and detective controls that provide security for privileged database users (for example, Oracle Database Vault, Oracle Label Security, Oracle Audit Vault, and Oracle Database Firewall). </p>
                  </div>
               </div><a id="TDPSG94448"></a><div class="props_rev_3"><a id="GUID-1D3CB302-2D03-4B2A-B2BA-125302D656C4" name="GUID-1D3CB302-2D03-4B2A-B2BA-125302D656C4"></a><h4 id="TDPSG-GUID-1D3CB302-2D03-4B2A-B2BA-125302D656C4" class="sect4"><span class="enumeration_section">7.2.2 </span>Step 1: Create User Accounts and Grant Them the Necessary Privileges
                  </h4>
                  <div>
                     <p>First, you must create and grant privileges to the necessary users and roles.</p>
                     <div class="section">The user <code class="codeph">sec_admin</code> must have the <code class="codeph">EXECUTE</code> privilege on the <code class="codeph">DBMS_REDACT</code> PL/SQL package, which is required to create Oracle Data Redaction policies. 
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3">To create user accounts for this tutorial:</p>
                        <ol>
                           <li>
                              <p>In Enterprise Manager, access the Database home page for your target database as user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> administrative privilege.
                              </p>
                              <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/12.2/tdpsg&amp;id=ADMQS033"><span><cite>Oracle Database 2 Day DBA</cite></span></a> for more information. 
                              </p>
                           </li>
                           <li>
                              <p>From the <span class="bold">Security</span> menu, select <span class="bold">Roles</span>.
                              </p>
                           </li>
                           <li>
                              <p>In the Roles page, select <span class="bold">Create</span>.
                              </p>
                           </li>
                           <li>
                              <p>In the Create Role page Name field, enter <code class="codeph">SUPERVISOR</code> and then click <span class="bold">OK</span>.
                              </p>
                           </li>
                           <li>
                              <p>From the <span class="bold">Schema</span> menu, select <span class="bold">Users</span>.
                              </p>
                           </li>
                           <li>
                              <p>In the Users Page, click <span class="bold">Create</span>. 
                              </p>
                           </li>
                           <li>
                              <p>In the Create User page, enter the following information: </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><span class="bold">Name</span>: <code class="codeph">EZLOTKEY</code> (to create the user account for Eleni Zlotkey)
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Profile</span>: <code class="codeph">DEFAULT</code></p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Authentication</span>: <code class="codeph">Password</code></p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Enter Password</span> and <span class="bold">Confirm Password</span>: Enter a password that meets the requirements in <a href="securing-the-database-installation-and-configuration.html#GUID-051F2B63-832D-4302-B5EC-B4523BF2CC23" title="Oracle provides password-creation requirements that help you create more secure passwords.">Requirements for Creating Passwords</a>.
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Default Tablespace</span>: <code class="codeph">USERS</code></p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Temporary Tablespace</span>: <code class="codeph">TEMP</code></p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Status</span>: <code class="codeph">Unlocked</code> 
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>Select the <span class="bold">System Privileges</span> tab. 
                              </p>
                           </li>
                           <li>
                              <p>Select the <span class="bold">Edit List</span> button.
                              </p>
                           </li>
                           <li>
                              <p>In the <span class="bold">Modify System Privileges</span> list, select the following privileges and then move them to the <span class="bold">Selected System Privileges</span> list.
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><span class="bold">CREATE SESSION</span></p>
                                 </li>
                                 <li>
                                    <p><span class="bold">CREATE TABLE</span></p>
                                 </li>
                                 <li>
                                    <p><span class="bold">UNLIMITED TABLESPACE</span></p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>Click <span class="bold">OK</span>. 
                              </p>
                           </li>
                           <li>
                              <p>In the Create User page, select the <span class="bold">Roles</span> tab, and then select the <span class="bold">Edit List</span> button.
                              </p>
                           </li>
                           <li>
                              <p>In the Modify Roles page, double-click the <span class="bold">SUPERVISOR</span> role in the <span class="bold">Available Roles</span> list to move it to the <span class="bold">Selected Roles</span> list. 
                              </p>
                           </li>
                           <li>
                              <p>Click <span class="bold">OK</span>, and then click <span class="bold">OK </span>again to return to the Users page.
                              </p>
                           </li>
                           <li>
                              <p>Select the <span class="bold">Create</span> button.
                              </p>
                           </li>
                           <li>
                              <p>In the Create User page, enter the following information: </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><span class="bold">Name</span>: <code class="codeph">EABEL</code> (to create the user account for Ellen Abel)
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Profile</span>: <code class="codeph">DEFAULT</code></p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Authentication</span>: <code class="codeph">Password</code></p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Enter Password</span> and <span class="bold">Confirm Password</span>: Enter a password that meets the requirements in <a href="securing-the-database-installation-and-configuration.html#GUID-051F2B63-832D-4302-B5EC-B4523BF2CC23" title="Oracle provides password-creation requirements that help you create more secure passwords.">Requirements for Creating Passwords</a>.
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Default Tablespace</span>: <code class="codeph">USERS</code></p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Temporary Tablespace</span>: <code class="codeph">TEMP</code></p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Status</span>: <code class="codeph">Unlocked</code> 
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>Select the <span class="bold">System Privileges</span> tab. 
                              </p>
                           </li>
                           <li>
                              <p>Select the <span class="bold">Edit List</span> button.
                              </p>
                           </li>
                           <li>
                              <p>In the <span class="bold">Modify System Privileges</span> list, double-click the <code class="codeph">CREATE SESSION</code> system privilege to move it to Selected System Privileges list.
                              </p>
                           </li>
                           <li>
                              <p>Click <span class="bold">OK</span>. 
                              </p>
                           </li>
                           <li>
                              <p>In the Users page, select the <span class="bold">EABEL</span> user.
                              </p>
                           </li>
                           <li>
                              <p>From the <span class="bold">Actions</span> list, select the <span class="bold">Create Like</span> button and then click <span class="bold">Go</span>. 
                              </p>
                           </li>
                           <li>
                              <p>In the Create User page, enter the following information:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><span class="bold">Name:</span> Enter <span class="bold">AHUTTON</span> (for user Alyssa Hutton).
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Enter Password</span> and <span class="bold">Confirm Password</span>: Enter a password that meets the requirements in <a href="securing-the-database-installation-and-configuration.html#GUID-051F2B63-832D-4302-B5EC-B4523BF2CC23" title="Oracle provides password-creation requirements that help you create more secure passwords.">Requirements for Creating Passwords</a>. 
                                    </p>
                                 </li>
                              </ul>
                              <p>Note that user <code class="codeph">ezlotkey</code> has been granted a role, <code class="codeph">supervisor</code>, but the users <code class="codeph">eabel</code> and <code class="codeph">ahutton</code> are not granted any roles. 
                              </p>
                           </li>
                           <li>
                              <p>Click <span class="bold">OK</span>. 
                              </p>
                           </li>
                           <li>
                              <p>In the Users page, select the <span class="bold">SEC_ADMIN</span> user and then click the <span class="bold">Edit</span> button. 
                              </p>
                              <p>If user <code class="codeph">SEC_ADMIN</code> does not exist, then you can quickly create this user in SQL*Plus by entering the following statement: 
                              </p><pre class="oac_no_warn" dir="ltr">GRANT CREATE PROCEDURE, CREATE ROLE, CREATE SESSION, INHERIT ANY PRIVILEGES, SELECT ANY DICTIONARY TO sec_admin IDENTIFIED BY <span class="italic">password</span>;
</pre><p>See also <a href="managing-user-privileges.html#GUID-61DD01F3-6446-4677-9002-C522EDCC7298" title="For greater security, you should apply separation of duty concepts when you assign responsibilities to the system administrators on your staff.">Step 2: Create a Security Administrator Account</a> to create this account.
                              </p>
                           </li>
                           <li>
                              <p>Select the <span class="bold">Object Privileges</span> tab. 
                              </p>
                           </li>
                           <li>
                              <p>In the Object Privileges tab, from the <span class="bold">Select Object Type</span> list, select <span class="bold">Package</span>, and then click <span class="bold">Add</span>. 
                              </p>
                           </li>
                           <li>
                              <p>In the Select Package Objects field, enter <code class="codeph">SYS.DBMS_REDACT</code>, and then in the Available Privileges list, move the <span class="bold">EXECUTE</span> privilege to the Selected Privileges list. 
                              </p>
                           </li>
                           <li>
                              <p>Click <span class="bold">OK</span>, and then click <span class="bold">Apply</span>. 
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TDPSG94449"></a><div class="props_rev_3"><a id="GUID-D0BF932B-8763-4A5F-A37B-EAA9718CD9E1" name="GUID-D0BF932B-8763-4A5F-A37B-EAA9718CD9E1"></a><h4 id="TDPSG-GUID-D0BF932B-8763-4A5F-A37B-EAA9718CD9E1" class="sect4"><span class="enumeration_section">7.2.3 </span>Step 2: Create and Populate the SALES_OPPS Sales Opportunities Table
                  </h4>
                  <div>
                     <p>The <code class="codeph">sales_opps</code> table contains information for small businesses that are sales opportunities. 
                     </p>
                     <div class="section">This table contains two columns that you must later on and on which you must create an Oracle Data Redaction policy.</div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3">To create and populate the sales_opps sales opportunities table:</p>
                        <ol>
                           <li>
                              <p>Log into the database instance as user <code class="codeph">ezlotkey</code>. 
                              </p><pre class="oac_no_warn" dir="ltr">sqlplus ezlotkey
Enter password: <span class="italic">password</span>
</pre></li>
                           <li>
                              <p>Create the <code class="codeph">sales_opps</code> table. 
                              </p><pre class="oac_no_warn" dir="ltr">CREATE TABLE sales_opps (
 account varchar2(30), 
 region varchar2(20), 
 product varchar2(20), 
 sales_rep varchar2(15), 
 close_date date, 
 price number, 
 quantity number);
</pre></li>
                           <li>
                              <p>Populate the <code class="codeph">sales_opps</code> table with some data.
                              </p><pre class="oac_no_warn" dir="ltr">INSERT INTO sales_opps VALUES ('Rising Dough Bakery', 'north-east', 'AA1 AccountPro', 'ahutton', '07-JUL-12', 400.00, 4);
INSERT INTO sales_opps VALUES ('Shear Madness Hair Salon', 'south-west', 'AA1 AccountPro', 'eabel', '20-APR-12', 400.00, 1);
INSERT INTO sales_opps VALUES ('Doublecheck Accounting', 'north-east', 'AA1 AccountPro', 'ahutton', '14-MAR-12', 400.00, 12);
INSERT INTO sales_opps VALUES ('State of Art Framing', 'south-west', 'AA1 TaxPro', 'eabel', '21-MAY-12', 300.00, 2);
INSERT INTO sales_opps VALUES ('Shady Trees Arborists', 'north-east', 'AA1 AccountPro', 'ahutton', '17-JUN-12', 400.00, 16);
</pre></li>
                           <li>
                              <p>Query the <code class="codeph">account</code> and <code class="codeph">close_date</code> columns of the <code class="codeph">sales_opps</code> table, to see the data that must be redacted. 
                              </p><pre class="oac_no_warn" dir="ltr">SELECT account, close_date, product, quantity FROM sales_opps;

ACCOUNT                        CLOSE_DAT PRODUCT                QUANTITY
------------------------------ --------- -------------------- ----------
Rising Dough Bakery            07-JUL-12 AA1 AccountPro                4
Shear Madness Hair Salon       20-APR-12 AA1 AccountPro                1
Doublecheck Accounting         14-MAR-12 AA1 AccountPro               12
State of Art Framing           21-MAY-12 AA1 TaxPro                    2
Shady Trees Arborists          17-JUN-12 AA1 AccountPro               16</pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TDPSG94450"></a><div class="props_rev_3"><a id="GUID-7EEE12D9-3E09-48D2-AFA5-B0A2FD6A56E6" name="GUID-7EEE12D9-3E09-48D2-AFA5-B0A2FD6A56E6"></a><h4 id="TDPSG-GUID-7EEE12D9-3E09-48D2-AFA5-B0A2FD6A56E6" class="sect4"><span class="enumeration_section">7.2.4 </span>Step 3: Create the SALES_OPPS_POL Oracle Data Redaction Policy
                  </h4>
                  <div>
                     <p>As user <code class="codeph">sec_admin</code>, create the <code class="codeph">sales_opps_pol</code> Oracle Data Redaction policy. 
                     </p>
                     <div class="section">
                        <p class="subhead3">To create the sales_opps_pol Data Redaction policy:</p>
                        <ol>
                           <li>
                              <p>In Enterprise Manager, log out, and then log back in again as user <code class="codeph">sec_admin</code>.
                              </p>
                              <p>See <a href="../admqs/getting-started-with-database-administration.html#ADMQS033"><span><cite>Oracle Database 2 Day DBA</cite></span></a> for more information. 
                              </p>
                           </li>
                           <li>
                              <p>From the <span class="bold">Security</span> menu, select <span class="bold">Oracle Data Redaction</span>.
                              </p>
                           </li>
                           <li>
                              <p>In the Data Redaction page, select the <span class="bold">Policies</span> tab.
                              </p>
                           </li>
                           <li>
                              <p>Select the <span class="bold">Create</span> button.
                              </p>
                           </li>
                           <li>
                              <p>In the Create Data Redaction Policy page, enter the following information to design the basics of the policy:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><span class="bold">Schema:</span> Enter <code class="codeph">EZLOTKEY</code> (in capital letters). 
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Table/View:</span> Enter <code class="codeph">SALES_OPPS</code> (in capital letters).
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Policy Name:</span> Enter <code class="codeph">SALES_OPPS_POL</code>. 
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="bold">Policy Expression:</span> Enter the following expression:
                                    </p><pre class="oac_no_warn" dir="ltr">SYS_CONTEXT('SYS_SESSION_ROLES', 'SUPERVISOR') = 'FALSE'
</pre><p>The expression translates to "Redact the data in the <code class="codeph">account</code> column for any user who does not have the <code class="codeph">supervisor</code> role enabled." In other words, only the supervisor, <code class="codeph">ezlotkey</code>, will be able to see the data in the <code class="codeph">account</code> column. 
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>Still in the Data Redaction page, apply the <code class="codeph">sales_opps_policy</code> policy to a column, as follows: 
                              </p>
                              <ol type="a">
                                 <li>
                                    <p>Select the <span class="bold">Add</span> button.
                                    </p>
                                 </li>
                                 <li>
                                    <p>In the Add window, from the <span class="bold">Column</span> list, select <span class="bold">ACCOUNT</span>. 
                                    </p>
                                    <p>The Column Datatype field displays the data type of <code class="codeph">ACCOUNT</code>, which is <code class="codeph">VARCHAR2</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>From the <span class="bold">Redaction Template</span> list, select <span class="bold">Custom</span> (which should be the default selection.)
                                    </p>
                                 </li>
                                 <li>
                                    <p>From the <span class="bold">Redaction Function</span> list, select <span class="bold">FULL</span>.
                                    </p>
                                    <p><span class="bold">FULL</span> means all the characters in the <code class="codeph">account</code> column will be redacted. Because the data type of the <code class="codeph">account</code> column is <code class="codeph">VARCHAR2</code>, the data will appear as a blank space. 
                                    </p>
                                 </li>
                                 <li>
                                    <p>Click <span class="bold">OK</span>.
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>Apply the <code class="codeph">sales_opps_pol</code> policy to a second column, as follows:
                              </p>
                              <ol type="a">
                                 <li>
                                    <p>Select the <span class="bold">Add</span> button.
                                    </p>
                                 </li>
                                 <li>
                                    <p>In the Add window, from the <span class="bold">Column</span> list, select <span class="bold">CLOSE_DATE</span>. 
                                    </p>
                                    <p>The <span class="bold">Column Datatype</span> field determines that the data type for <code class="codeph">CLOSE_DATE</code> is <code class="codeph">DATE</code>. 
                                    </p>
                                 </li>
                                 <li>
                                    <p>From the <span class="bold">Redaction Function</span> list, select <span class="bold">PARTIAL</span>.
                                    </p>
                                    <p>In a moment, the Add window expands to show the <span class="bold">Function Attributes</span> area. 
                                    </p>
                                 </li>
                                 <li>
                                    <p>In the <span class="bold">Date Redaction Format</span> field, enter the following attribute: 
                                    </p><pre class="oac_no_warn" dir="ltr">m06d7YHMS
</pre><p>This setting redacts the month and day of each date, setting them to appear as <code class="codeph">07-JUNE-12</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Click <span class="bold">OK</span>. 
                                    </p>
                                    <p>The Create Data Redaction Policy page should appear as follows:</p>
                                    <div class="figure" id="GUID-7EEE12D9-3E09-48D2-AFA5-B0A2FD6A56E6__GUID-729C5B1A-1266-45AA-85E5-3B572864D56B"><img src="img/redaction_create.gif" width="451" alt="Description of redaction_create.gif follows" title="Description of redaction_create.gif follows" longdesc="img_text/redaction_create.html"><br><a href="img_text/redaction_create.html">Description of the illustration redaction_create.gif</a></div>
                                    <!-- class="figure" -->
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>In the Create Data Redaction Policy page, click <span class="bold">OK</span>. 
                              </p>
                              <p>The policy appears in the Data Redaction Policies list.   </p>
                              <p>Do not exit Enterprise Manager. </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TDPSG94451"></a><div class="props_rev_3"><a id="GUID-5DAF45EB-FB83-4F22-A9F8-A2DCD35ADA06" name="GUID-5DAF45EB-FB83-4F22-A9F8-A2DCD35ADA06"></a><h4 id="TDPSG-GUID-5DAF45EB-FB83-4F22-A9F8-A2DCD35ADA06" class="sect4"><span class="enumeration_section">7.2.5 </span>Step 4: Test the SALES_OPPS_POL Oracle Data Redaction Policy
                  </h4>
                  <div>
                     <p>Next, you are ready to test the policy. </p>
                     <div class="section">To test the <code class="codeph">sales_opps_pol</code> Oracle Data Redaction policy, log in as the users you created earlier and query the redacted columns in the <code class="codeph">sales_opps</code> table. 
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3">To test the sales_opps_pol policy:</p>
                        <ol>
                           <li>
                              <p>Connect to SQL*Plus as user <code class="codeph">ezlotkey</code>. 
                              </p><pre class="oac_no_warn" dir="ltr">connect ezlotkey
Enter password: <span class="italic">password</span>
</pre></li>
                           <li>
                              <p>Grant the sales representatives the <code class="codeph">SELECT</code> privilege for the <code class="codeph">sales_opps</code> table. 
                              </p><pre class="oac_no_warn" dir="ltr">GRANT SELECT ON sales_opps TO eabel;
GRANT SELECT ON sales_opps TO ahutton;
</pre></li>
                           <li>
                              <p>Connect as user <code class="codeph">eabel</code>. 
                              </p><pre class="oac_no_warn" dir="ltr">connect eabel
Enter password: <span class="italic">password</span>
</pre></li>
                           <li>
                              <p>Query the <code class="codeph">sales_opps</code> tables as follows: 
                              </p><pre class="oac_no_warn" dir="ltr">SELECT account, close_date, product, quantity FROM ezlotkey.sales_opps;
</pre><p>Output similar to the following should appear:</p><pre class="oac_no_warn" dir="ltr">ACCOUNT                        CLOSE_DAT PRODUCT                QUANTITY
------------------------------ --------- -------------------- ----------
                               07-JUN-12 AA1 AccountPro                4
                               07-JUN-12 AA1 AccountPro                1
                               07-JUN-12 AA1 AccountPro               12
                               07-JUN-12 AA1 TaxPro                    2
                               07-JUN-12 AA1 AccountPro               16
</pre><p>No data appears in the <code class="codeph">account</code> column because it has been redacted to display a blank space for each row. The <code class="codeph">close_date</code> column shows dates, but they are all partial date values. The <code class="codeph">product</code> and <code class="codeph">quantity</code> columns show their data, as expected, because the Data Redaction policy does not apply to them.
                              </p>
                           </li>
                           <li>
                              <p>Connect as user <code class="codeph">ahutton</code> and perform the same query.
                              </p><pre class="oac_no_warn" dir="ltr">connect ahutton
Enter password: <span class="italic">password</span>

SELECT account, close_date, product, quantity FROM ezlotkey.sales_opps;

ACCOUNT                        CLOSE_DAT PRODUCT                QUANTITY
------------------------------ --------- -------------------- ----------
                               07-JUN-12 AA1 AccountPro                4
                               07-JUN-12 AA1 AccountPro                1
                               07-JUN-12 AA1 AccountPro               12
                               07-JUN-12 AA1 TaxPro                    2
                               07-JUN-12 AA1 AccountPro               16
</pre><p>The data is redacted for user <code class="codeph">ahutton</code> as well. 
                              </p>
                           </li>
                           <li>
                              <p>Connect as user <code class="codeph">ezlotkey</code> and perform the same query. 
                              </p><pre class="oac_no_warn" dir="ltr">connect ezlotkey
Enter password: <span class="italic">password</span>

SELECT account, close_date, product, quantity FROM sales_opps;

ACCOUNT                        CLOSE_DAT PRODUCT                QUANTITY
------------------------------ --------- -------------------- ----------
Rising Dough Bakery            07-JUL-12 AA1 AccountPro                4
Shear Madness Hair Salon       20-APR-12 AA1 AccountPro                1
Doublecheck Accounting         14-MAR-12 AA1 AccountPro               12
State of Art Framing           21-MAY-12 AA1 TaxPro                    2
Shady Trees Arborists          17-JUN-12 AA1 AccountPro               16
</pre><p>The <code class="codeph">sales_opps_pol</code> Data Redaction policy shows the actual data for user <code class="codeph">ezlotkey</code> because she has the <code class="codeph">supervisor</code> role enabled. However, if this role is disabled for <code class="codeph">ezlotkey</code>, then when she queries this table, the <code class="codeph">account</code> and <code class="codeph">close_date</code> columns will be redacted, even though she created and owns the <code class="codeph">sales_opps</code> table. 
                              </p>
                           </li>
                           <li>
                              <p>Log out of SQL*Plus. </p><pre class="oac_no_warn" dir="ltr">EXIT</pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TDPSG94452"></a><div class="props_rev_3"><a id="GUID-CAB52AD5-9C3F-4FD8-AA7A-8D59838BC0F4" name="GUID-CAB52AD5-9C3F-4FD8-AA7A-8D59838BC0F4"></a><h4 id="TDPSG-GUID-CAB52AD5-9C3F-4FD8-AA7A-8D59838BC0F4" class="sect4"><span class="enumeration_section">7.2.6 </span>Step 5: Optionally, Remove the Components for This Tutorial
                  </h4>
                  <div>
                     <p>You can remove the components that you created for this tutorial if you no longer need them.</p>
                     <div class="section">
                        <p class="subhead3">To remove the components for this tutorial:</p>
                        <ol>
                           <li>
                              <p>In Enterprise Manager, ensure that you are logged in as user <code class="codeph">sec_admin</code>.
                              </p>
                           </li>
                           <li>
                              <p>In the Data Redaction Policies page, select the <code class="codeph">SALES_OPPS_POL</code> policy. 
                              </p>
                              <div class="figure" id="GUID-CAB52AD5-9C3F-4FD8-AA7A-8D59838BC0F4__GUID-6473A7A2-FE5D-4611-AECF-21412A92F8F6"><img src="img/redaction_drop.gif" width="480" alt="Description of redaction_drop.gif follows" title="Description of redaction_drop.gif follows" longdesc="img_text/redaction_drop.html"><br><a href="img_text/redaction_drop.html">Description of the illustration redaction_drop.gif</a></div>
                              <!-- class="figure" -->
                           </li>
                           <li>
                              <p>Click the <span class="bold">Delete</span> button.
                              </p>
                           </li>
                           <li>
                              <p>In the Confirmation page, click <span class="bold">Yes</span>.
                              </p>
                           </li>
                           <li>
                              <p>Log out of Enterprise Manager and then log back in again as user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> administrative privilege 
                              </p>
                           </li>
                           <li>
                              <p>From the Database home page, select <span class="bold">Schema</span>, then <span class="bold">Users</span>. 
                              </p>
                           </li>
                           <li>
                              <p>Select user <span class="bold">AHUTTON</span>, click <span class="bold">Delete</span>, and then in the Confirmation window, select <span class="bold">Yes</span>. 
                              </p>
                           </li>
                           <li>
                              <p>Select user <span class="bold">EABEL</span>, click <span class="bold">Delete</span>, and then in the Confirmation window, select <span class="bold">Yes</span>. 
                              </p>
                           </li>
                           <li>
                              <p>Select user <span class="bold">EZLOTKEY</span>, click <span class="bold">Delete</span>, and then in the Confirmation window, select <span class="bold">Yes</span>.
                              </p>
                           </li>
                           <li>
                              <p>From the <span class="bold">Security</span> menu, select <span class="bold">Roles</span>. 
                              </p>
                           </li>
                           <li>
                              <p>Select the role <code class="codeph">SUPERVISOR</code>, click <span class="bold">Delete</span>, and in the Confirmation window, select <span class="bold">Yes</span>.
                              </p>
                           </li>
                           <li>
                              <p>In the Users page, select the <span class="bold">SEC_ADMIN</span> user and then click <span class="bold">Edit</span>. 
                              </p>
                           </li>
                           <li>
                              <p>In the Edit User: SEC_ADMIN page, select the <span class="bold">Object Privileges</span> tab.
                              </p>
                           </li>
                           <li>
                              <p>Select the <span class="bold">EXECUTE</span> privilege for the <span class="bold">DBMS_REDACT</span> package, and then click <span class="bold">Delete</span>. 
                              </p>
                           </li>
                           <li>
                              <p>Click the <span class="bold">Apply</span> button.
                              </p>
                           </li>
                           <li>
                              <p>Exit Enterprise Manager by clicking the <span class="bold">Log Out</span> button. 
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>