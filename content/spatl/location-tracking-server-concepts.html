<!DOCTYPE html
  SYSTEM "about:legacy-compat">

<!-- saved from url=(0023)https://docs.oracle.com -->

<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="The Oracle Spatial and Graph location tracking server enables you to define regions of interest, track the movement of objects into or out of those regions, and receive notifications when certain movements occur.">
      <meta name="description" content="The Oracle Spatial and Graph location tracking server enables you to define regions of interest, track the movement of objects into or out of those regions, and receive notifications when certain movements occur.">
      <title>Location Tracking Server</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Developer's Guide ">
      <meta property="og:description" content="The Oracle Spatial and Graph location tracking server enables you to define regions of interest, track the movement of objects into or out of those regions, and receive notifications when certain movements occur.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 17.8.1">
      <link rel="alternate" href="spatial-and-graph-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2017-10-11T16:10:07-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2017">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E85869-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/12.2">
      <meta name="dcterms.release" content="Release 12.2">
      <link rel="prev" href="lrs-linear-referencing-system-concepts.html" title="Previous" type="text/html">
      <link rel="next" href="spatial-analysis-mining.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">
            {
                "primary":
                {
                    "category":{
                      "short_name":"database",
                      "element_name":"Database",
                      "display_in_url":true
                    },
                    "suite":{
                      "short_name":"oracle",
                      "element_name":"Oracle",
                      "display_in_url":true
                    },
                    "product_group":{
                      "short_name":"not-applicable",
                      "element_name":"Not applicable",
                      "display_in_url":false
                    },
                    "product":{
                      "short_name":"oracle-database",
                      "element_name":"Oracle Database",
                      "display_in_url":true
                    },
                    "release":{
                      "short_name":"12.2",
                      "element_name":"Release 12.2",
                      "display_in_url":true
                    },
                    "platform":{
                      "short_name":"",
                      "element_name":"",
                      "display_in_url":false
                    },
                    "component":{
                      "short_name":"",
                      "element_name":"",
                      "display_in_url":false
                    }
                }
            }
            </script>
      
    <meta name="dcterms.title" content="Spatial and Graph Developer's Guide">
    <meta name="dcterms.isVersionOf" content="SPATL">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="lrs-linear-referencing-system-concepts.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="spatial-analysis-mining.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Developer's Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="spatial-concepts-usage.html" property="item" typeof="WebPage"><span property="name">  Conceptual and Usage Information </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Location Tracking Server</li>
            </ol>
            <a id="GUID-44411566-DA36-4C87-8412-5CEEE6A70518" name="GUID-44411566-DA36-4C87-8412-5CEEE6A70518"></a>
            
            <h2 id="SPATL-GUID-44411566-DA36-4C87-8412-5CEEE6A70518" class="sect2"><span class="enumeration_chapter">8 </span>Location Tracking Server
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>The Oracle Spatial and Graph location tracking server enables you to define regions of interest, track the movement of objects into or out of those regions, and receive notifications when certain movements occur.</p>
               <p><a id="d64260e49" class="indexterm-anchor"></a>For reference information about location tracking PL/SQL subprograms, see <a href="SDO_TRKR-reference.html#GUID-EDDAAD84-8633-4E5F-8770-CB323CCD61E0" title="The MDSYS.SDO_TRKR package contains subprograms for using the location tracking server.">SDO_TRKR Package (Location Tracking)</a>.
               </p>
            </div>
            <div>
               <p><strong>Topics:</strong></p>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="location-tracking-server-concepts.html#GUID-3C072452-0300-4B91-9C30-B34FE0069F2D">About the Location Tracking Server</a><br>As location becomes an increasingly important aspect of our lives, and as  location-sensing devices become ubiquitous, there is an increasing demand for applications to be able to monitor subscriber location data continuously. The monitoring of the location data may translate into alerts being generated in the system. 
                  </li>
                  <li class="ulchildlink"><a href="location-tracking-server-concepts.html#GUID-B753991F-E9DD-4F7F-8579-755094480C2C">Location Tracking Regions</a><br>The location tracking server tracks a set of moving objects against a known set of regions of interest and generates notifications as required. In this framework, the set of regions of interest is referred to as the location tracking regions.
                  </li>
                  <li class="ulchildlink"><a href="location-tracking-server-concepts.html#GUID-7A488F8D-E8F9-4E60-B4BC-B0E82A8BF858">Data Types for the Location Tracking Server</a><br>The PL/SQL subprograms associated with location tracking can have parameters of data types that are specific to the location tracking server.
                  </li>
                  <li class="ulchildlink"><a href="location-tracking-server-concepts.html#GUID-209F22A6-F656-4560-82C2-1FEB6AD399E8">Data Structures and Workflow for the Location Tracking Server</a><br>The location tracking server requires the user to specify a tracking region name (TR_NAME)  when the server is initialized. Based on this name, some additional data structures are created.
                  </li>
               </ul>
            </div>
            
            <div class="props_rev_3"><a id="GUID-3C072452-0300-4B91-9C30-B34FE0069F2D" name="GUID-3C072452-0300-4B91-9C30-B34FE0069F2D"></a><h3 id="SPATL-GUID-3C072452-0300-4B91-9C30-B34FE0069F2D" class="sect3"><span class="enumeration_section">8.1 </span>About the Location Tracking Server
               </h3>
               <div>
                  <p>As location becomes an increasingly important aspect of our lives, and as  location-sensing devices become ubiquitous, there is an increasing demand for applications to be able to monitor subscriber location data continuously. The monitoring of the location data may translate into alerts being generated in the system. </p>
                  <p>For example, a trucking company may want to monitor its network of 10,000 trucks as they move along their specified routes towards their destinations. They may want to track the movement of trucks within a specified range of the route and expect notifications to be generated to detect undesirable deviations the vehicles from their desired routes. Proactive location-based services (LBSs) generalize such applications that track locations of subscribers inside or outside a specified region of interest for various purposes, such as location-based advertising and notifications about friends nearby.</p>
                  <p>The Oracle Spatial and Graph location tracking server provides:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>A simple framework for setting up a <span class="italic">location tracking network</span> within the database through a PL/SQL interface
                        </p>
                     </li>
                     <li>
                        <p>An API for continuous location monitoring of objects within a tracking network</p>
                     </li>
                     <li>
                        <p>A queuing mechanism for incoming location updates and tracking requests and for outgoing relevant notifications, using Oracle Advanced Queuing</p>
                     </li>
                     <li>
                        <p>Efficient, continuous location monitoring for thousands of relevant objects within the database</p>
                     </li>
                  </ul>
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-B753991F-E9DD-4F7F-8579-755094480C2C" name="GUID-B753991F-E9DD-4F7F-8579-755094480C2C"></a><h3 id="SPATL-GUID-B753991F-E9DD-4F7F-8579-755094480C2C" class="sect3"><span class="enumeration_section">8.2 </span>Location Tracking Regions
               </h3>
               <div>
                  <p>The location tracking server tracks a set of moving objects against a known set of regions of interest and generates notifications as required. In this framework, the set of regions of interest is referred to as the location tracking regions.</p>
                  <p>In the database these are managed in a table with two columns: <code class="codeph">roi_id INTEGER, roi_geom SDO_GEOMETRY</code>. ROI_ID is the primary key for this table, and ROI_GEOM is the geometry of the tracking region.
                  </p>
                  <p>Several additional structures are created when you create a tracking region set. You can create any number of tracking region sets, and each set typically can have thousands of regions that are tracked. When a region is no longer of interest for tracking purposes, it should be deleted from the tracking regions table.</p>
                  <p>You also need to insert the set of location objects to be tracked. Locations objects must specify an ID for the object and an ROI_ID to specify the target tracking region for this object. That is, each location object can be tracked against one or more tracking regions. These objects are created by inserting TRACKER_MSG (tracker message) objects into the tracking queue. </p>
                  <p>A tracker message object specifies the <code class="codeph">object_id</code>, <code class="codeph">roi_id</code>, and two flags. 
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>The <code class="codeph">isTrackInside</code> flag specifies whether to track the object as it is inside the region or outside the region. If <code class="codeph">isTrackInside</code> is set to <code class="codeph">Y</code>, the object will be tracked to see its location stays inside the target ROI; and if the object ever leaves the ROI, then a notification message is generated. If <code class="codeph">isTrackInside</code> is set to <code class="codeph">N</code>,  the object will be tracked to see its location stays outside the target ROI; and if the object ever enters the ROI, then a notification message is generated.
                        </p>
                     </li>
                     <li>
                        <p>The <code class="codeph">isActive</code> flag specifies whether this location object is active or not. If it is set to <code class="codeph">Y</code>, the location object will be tracked. If it is set to <code class="codeph">N</code>, tracking will be turned off for the object. This allows the actual location object to persist, while the tracking of the object can be turned on or off based on the application context.
                        </p>
                     </li>
                  </ul>
                  <p>After location objects created and tracking options configured, you can start inserting new locations for tracking objects. That is, as the objects move in space, the location changes. And every time a new location is acquired, it can be inserted into the location message queue, to be processed by the tracking server. Depending on the <code class="codeph">isTrackInside</code> flag and ROI_ID, these location messages are processed and notifications are generated as required. User application can monitor the notification queue and process the notifications whenever a new notification is generated.
                  </p>
                  <p>The following additional grants are required for a user to run the tracking server.</p><pre class="pre codeblock"><code>grant aq_administrator_role, create job, manage scheduler to &lt;USER&gt;;
grant execute on dbms_aq to  &lt;USER&gt;;
grant execute on dbms_aqadm to  &lt;USER&gt;;
grant execute on dbms_lock to  &lt;USER&gt;;
grant execute on dbms_aqin to  &lt;USER&gt;;
grant execute on dbms_aqjms to  &lt;USER&gt;;
</code></pre></div>
            </div>
            <div class="props_rev_3"><a id="GUID-7A488F8D-E8F9-4E60-B4BC-B0E82A8BF858" name="GUID-7A488F8D-E8F9-4E60-B4BC-B0E82A8BF858"></a><h3 id="SPATL-GUID-7A488F8D-E8F9-4E60-B4BC-B0E82A8BF858" class="sect3"><span class="enumeration_section">8.3 </span>Data Types for the Location Tracking Server
               </h3>
               <div>
                  <p>The PL/SQL subprograms associated with location tracking can have parameters of data types that are specific to the location tracking server.</p>
                  <p>These subprograms are documented in the <a href="SDO_TRKR-reference.html#GUID-EDDAAD84-8633-4E5F-8770-CB323CCD61E0" title="The MDSYS.SDO_TRKR package contains subprograms for using the location tracking server.">SDO_TRKR Package (Location Tracking)</a>. The specific data types have the following definitions:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>LOCATION_MSG</p><pre class="oac_no_warn" dir="ltr">(object_id INTEGER,
 time      TIMESTAMP,
 x         NUMBER,
 y         NUMBER)</pre></li>
                     <li>
                        <p>LOCATION_MSG_ARR</p><pre class="oac_no_warn" dir="ltr">VARRAY(1000) of location_msg</pre></li>
                     <li>
                        <p>LOCATION_MSG_PKD</p><pre class="oac_no_warn" dir="ltr">object(arr location_msg_arr)</pre></li>
                     <li>
                        <p>NOTIFICATION_MSG</p><pre class="oac_no_warn" dir="ltr">(object_id INTEGER,
 roi_id    INTEGER,
 time      TIMESTAMP)</pre></li>
                     <li>
                        <p>PROC_MSG</p><pre class="oac_no_warn" dir="ltr">(object_id     INTEGER,
 time          TIMESTAMP,
 x             NUMBER,
 y             NUMBER,
 roi_id        INTEGER,
 isTrackInside CHAR(1))</pre></li>
                     <li>
                        <p>PROC_MSG_ARR</p><pre class="oac_no_warn" dir="ltr">VARRAY(1000) of proc_msg</pre></li>
                     <li>
                        <p>PROC_MSG_PKD</p><pre class="oac_no_warn" dir="ltr">object(arr proc_msg_arr)</pre></li>
                     <li>
                        <p>TRACKER_MSG</p><pre class="oac_no_warn" dir="ltr">(object_id     INTEGER,
 roi_id        INTEGER,
 isTrackInside CHAR(1),
 isActivate    CHAR(1))</pre></li>
                  </ul>
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-209F22A6-F656-4560-82C2-1FEB6AD399E8" name="GUID-209F22A6-F656-4560-82C2-1FEB6AD399E8"></a><h3 id="SPATL-GUID-209F22A6-F656-4560-82C2-1FEB6AD399E8" class="sect3"><span class="enumeration_section">8.4 </span>Data  Structures and Workflow for the Location Tracking Server
               </h3>
               <div>
                  <p>The location tracking server requires the user to specify a tracking region name (TR_NAME)  when the server is initialized. Based on this name, some additional data structures are created.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Table  &lt;TR_NAME&gt;_TRACKING_REGIONS (roi_id INTEGER, roi_geom MDSYS.SDO_GEOMETRY) contains the tracking region polygons defined in the server for the TR_NAME.Users directly insert the tracking polygons into this table after the server is initialized.</p>
                     </li>
                  </ul>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Table &lt;TR_REGION&gt;_TRACKER (object_id INTEGER, 'roi_id INTEGER, isTrackInside CHAR(1)) contains the tracking objects (objects that are tracked). This table is managed by the tracking server, and users should not update this table directly.</p>
                     </li>
                  </ul>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Table &lt;TR_REGION&gt;_NOTIFICATION_TABLE and &lt;TR_REGION&gt;_TRAJECTORY are two auxiliary tables used by the server and not to be updated by the user directly.</p>
                     </li>
                  </ul>
                  <p>In addition to these tables, the server also creates a set of Advanced Query (AQ)  objects for managing the  location objects and notifications. All of these will have a prefix of &lt;TR_REGION&gt;.</p>
                  <p>The normal workflow for tracking objects is as follows: </p>
                  <ol>
                     <li>
                        <p>A tracking region set is created using the <a href="SDO_TRKR-reference.html#GUID-D1AFDF64-448F-4C7C-A34A-ADD9A2117D27">SDO_TRKR.CREATE_TRACKING_REGIONS</a> procedure.
                        </p>
                     </li>
                     <li>
                        <p>The regions are activated by the <a href="SDO_TRKR-reference.html#GUID-933F208B-5781-4BDD-80F1-806B87C89066">SDO_TRKR.START_TRACKING_REGIONS</a> procedure. 
                        </p>
                     </li>
                     <li>
                        <p>Location objects are created using the  <a href="SDO_TRKR-reference.html#GUID-4740BA80-C5C4-4E19-A1FC-5495BBF5799B">SDO_TRKR.SEND_TRACKING_MSG</a> procedure. This call creates tracking objects and specifies whether to track the objects to be inside their target regions or outside the target regions.
                        </p>
                     </li>
                     <li>
                        <p>The actual tracking of the moving objects is done using the <a href="SDO_TRKR-reference.html#GUID-6F32298E-A054-43FE-AA9D-AD248E8EB143">SDO_TRKR.SEND_LOCATION_MSGS</a> procedure. This procedure inserts moving location information about the tracked objects in the location tracking queue and about the location tracking server that processes them. 
                        </p>
                     </li>
                     <li>
                        <p>Users monitor the &lt;TR_REGION&gt;_NOTIFICATION_Q queue for alerts that are generated from the tracking server.</p>
                     </li>
                  </ol>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>