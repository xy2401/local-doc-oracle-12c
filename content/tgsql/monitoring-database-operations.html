<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="This chapter describes how to monitor SQL and PL/SQL.">
      <meta name="description" content="This chapter describes how to monitor SQL and PL/SQL.">
      <title>Monitoring Database Operations</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="SQL Tuning Guide ">
      <meta property="og:description" content="This chapter describes how to monitor SQL and PL/SQL.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="SQL Tuning Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="sql-tuning-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-03-19T08:01:25-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2013, 2018">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E85762-03">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/12.2">
      <meta name="dcterms.release" content="Release 12.2">
      <link rel="prev" href="monitoring-and-tracing-sql.html" title="Previous" type="text/html">
      <link rel="next" href="sql-test-case-builder.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"12.2","element_name":"Release 12.2","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="SQL Tuning Guide">
    <meta name="dcterms.isVersionOf" content="TGSQL">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="monitoring-and-tracing-sql.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="sql-test-case-builder.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SQL Tuning Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="monitoring-and-tracing-sql.html" property="item" typeof="WebPage"><span property="name">Monitoring and Tracing SQL</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Monitoring Database Operations </li>
            </ol>
            <a id="GUID-C941CE9D-97E1-42F8-91ED-4949B2B710BF" name="GUID-C941CE9D-97E1-42F8-91ED-4949B2B710BF"></a>
            
            <h2 id="TGSQL-GUID-C941CE9D-97E1-42F8-91ED-4949B2B710BF" class="sect2"><span class="enumeration_chapter">21 </span>Monitoring Database Operations 
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This chapter describes how to monitor SQL and PL/SQL.</p>
               <p>This chapter contains the following topics:</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-007E5BAE-B07D-4BD1-9485-DE8D260BF862">About Monitoring Database Operations</a><br>A <strong class="term">database operation</strong> is a user-defined logical object that includes session activity between two points in time. 
                  </li>
                  <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-61D052D2-1F06-4A8C-A9D8-26504AD8A720">Enabling and Disabling Monitoring of Database Operations</a><br>Use initialization parameters to enable or disable monitoring.
                  </li>
                  <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-DC573FB7-40C5-4D6D-BE81-EF356900B444">Creating a Database Operation</a><br>Creating a database operation involves supplying a name and defining its beginning and end times. 
                  </li>
                  <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-4048D00E-2635-42C8-A37D-71EFAC619062">Monitoring SQL Executions Using Cloud Control</a><br>By default, AWR automatically captures SQL monitoring reports in XML format.
                  </li>
               </ul>
            </div>
            <a id="TGSQL789"></a><a id="TGSQL790"></a><div class="props_rev_3"><a id="GUID-007E5BAE-B07D-4BD1-9485-DE8D260BF862" name="GUID-007E5BAE-B07D-4BD1-9485-DE8D260BF862"></a><h3 id="TGSQL-GUID-007E5BAE-B07D-4BD1-9485-DE8D260BF862" class="sect3"><span class="enumeration_section">21.1 </span>About Monitoring Database Operations
               </h3>
               <div>
                  <p>A <strong class="term">database operation</strong> is a user-defined logical object that includes session activity between two points in time. 
                  </p>
                  <p>A database operation contains a set of database tasks. A typical task might be a batch job or Extraction, Transformation, and Loading (ETL) processing job.</p>
                  <p>A database operation is uniquely identified by its name and execution ID. Each operation can be executed many times. Each execution of an operation is uniquely identifiable.</p>
                  <p>Real-Time Database Operations provides the ability to monitor composite operations automatically. The database automatically monitors parallel queries, DML, and DDL statements as soon as execution begins. By default, Real-Time SQL Monitoring automatically starts when a SQL statement runs in parallel, or when it has consumed at least 5 seconds of CPU or I/O time in a single execution.</p>
                  <p>The SQL monitoring feature is enabled by default when the <code class="codeph">STATISTICS_LEVEL</code> initialization parameter is either set to <code class="codeph">TYPICAL</code> (the default value) or <code class="codeph">ALL</code>. Using the <code class="codeph">DBMS_SQL_MONITOR</code> package, you can start and stop, monitor, and report on database operations.
                  </p>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-7E2A0A25-6EF1-4180-B16E-65B47039CEC7">Purpose of Monitoring Database Operations</a><br>Real-Time SQL Monitoring enables you to monitor a single SQL statement or PL/SQL program unit. 
                     </li>
                     <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-B581E8C5-41AC-4638-978F-80E758AAE2B7">Database Operation Monitoring Concepts</a><br>The <code class="codeph">DBMS_SQL_MONITOR</code> package is the key component of the architecture for database operations.
                     </li>
                     <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-13D71625-2548-4F7B-B2B2-FEEAD24F7690">User Interfaces for Database Operations Monitoring</a><br>You can monitor database operations from the command line or by using Cloud Control.
                     </li>
                     <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-A11CCA38-7DD8-4B08-9311-29CC7ED92EE6">Basic Tasks in Database Operations Monitoring</a><br>This section explains the basic tasks in database operations monitoring.
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-007E5BAE-B07D-4BD1-9485-DE8D260BF862__GUID-6DE945D9-2E81-4945-B526-D400CDB87B57">
                     <p class="notep1">See Also:</p>
                     <p><a href="../cncpt/process-architecture.html#CNCPT89228"><span><cite>Oracle Database Concepts</cite></span></a> for a brief conceptual overview of database operations
                     </p>
                  </div>
               </div>
               <a id="TGSQL94583"></a><div class="props_rev_3"><a id="GUID-7E2A0A25-6EF1-4180-B16E-65B47039CEC7" name="GUID-7E2A0A25-6EF1-4180-B16E-65B47039CEC7"></a><h4 id="TGSQL-GUID-7E2A0A25-6EF1-4180-B16E-65B47039CEC7" class="sect4"><span class="enumeration_section">21.1.1 </span>Purpose of Monitoring Database Operations
                  </h4>
                  <div>
                     <p>Real-Time SQL Monitoring enables you to monitor a single SQL statement or PL/SQL program unit. </p>
                     <p>Database operations extend Real-Time SQL Monitoring by enabling you to treat a set of statements or procedures as a named, uniquely identified, and re-executable unit. In general, monitoring database operations is useful for the following users:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>DBAs whose responsibilities include identifying expensive (high response time) SQL statements and PL/SQL functions</p>
                        </li>
                        <li>
                           <p>DBAs who manage batch jobs in a data warehouse or OLTP system</p>
                        </li>
                        <li>
                           <p>Application or database developers who need to monitor the activities related to particular operations, for example, Oracle Data Pump operations</p>
                        </li>
                     </ul>
                     <p>Monitoring database operations is useful for performing the following tasks:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Tracking and reporting</p>
                           <p>Tracking requires first defining a database operation, for example, though <code class="codeph">DBMS_SQL_MONITOR</code>, OCI, or JDBC APIs. You can define an operation from a different session from the one that you are currently using. The database infrastructure determines what to track on behalf of the defined operation. 
                           </p>
                           <p>You can generate reports on the operation. For example, your tuning task may involve determining which SQL statements run on behalf of a specific batch job, what their execution statistics were, what was occurring in the database when the operation was executing, and so on.</p>
                        </li>
                        <li>
                           <p>Monitoring execution progress</p>
                           <p>This task involves monitoring a currently executing database operation. The information is particularly useful when you are investigating why an operation is taking a long time to complete.</p>
                        </li>
                        <li>
                           <p>Monitoring resource usage</p>
                           <p>You may want to detect when a SQL execution uses excessive CPU, issues an excessive amount of I/O, or takes a long time to complete. With Oracle Database Resource Manager (the Resource Manager), you can configure thresholds for each consumer group that specify the maximum resource usage for all SQL executions in the group. When a SQL operation reaches a specified threshold, the Resource Manager can switch the operation into a lower-priority consumer group, terminate the session or call, or log the event. You can then monitor these SQL operations.</p>
                        </li>
                        <li>
                           <p>Tuning for response time</p>
                           <p>When tuning a database operation, you typically aim to improve the <a href="glossary.html#GUID-371FCA7E-6CDB-4D4C-9BD6-90944AD21E3A"><span class="xrefglossterm">response time</span></a>. Often the database operation performance issues are mainly SQL performance issues.
                           </p>
                        </li>
                     </ul>
                     <p>This section contains the following topics:</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-BFD26CCE-4CCA-4FB6-B9FD-ECD82898769E">Simple Database Operation Use Cases</a><br>For simple operations, Real-Time SQL Monitoring helps determine where a currently executing SQL statement is in its execution plan and where the statement is spending its time. 
                        </li>
                        <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-0DB2A541-9799-48A6-9668-86C35E6465F3">Composite Database Operation Use Cases</a><br>In OLTP and data warehouse environments, a job often logically groups related SQL statements. The job can span multiple concurrent sessions.
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-7E2A0A25-6EF1-4180-B16E-65B47039CEC7__GUID-3EE1D84A-2F3B-4BC3-A6EE-22F4416FE3BC">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="monitoring-database-operations.html#GUID-4048D00E-2635-42C8-A37D-71EFAC619062" title="By default, AWR automatically captures SQL monitoring reports in XML format.">Monitoring SQL Executions Using Cloud Control</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/12.2/tgsql&amp;id=ADMIN11879"><span><cite>Oracle Database Administratorâ€™s Guide</cite></span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <a id="TGSQL94584"></a><div class="props_rev_3"><a id="GUID-BFD26CCE-4CCA-4FB6-B9FD-ECD82898769E" name="GUID-BFD26CCE-4CCA-4FB6-B9FD-ECD82898769E"></a><h5 id="TGSQL-GUID-BFD26CCE-4CCA-4FB6-B9FD-ECD82898769E" class="sect5"><span class="enumeration_section">21.1.1.1 </span>Simple Database Operation Use Cases
                     </h5>
                     <div>
                        <p>For simple operations, Real-Time SQL Monitoring helps determine where a currently executing SQL statement is in its execution plan and where the statement is spending its time. </p>
                        <p>You can also see the breakdown of time and resource usage for recently completed statements. In this way, you can better determine why a particular operation is expensive.</p>
                        <p>Typical use cases for Real-Time SQL Monitoring include the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>A frequently executed SQL statement is executing more slowly than normal. You must identify the root cause of this problem.</p>
                           </li>
                           <li>
                              <p>A database session is experiencing slow performance.</p>
                           </li>
                           <li>
                              <p>A parallel SQL statement is taking a long time. You want to determine how the server processes are dividing the work.</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="TGSQL94585"></a><div class="props_rev_3"><a id="GUID-0DB2A541-9799-48A6-9668-86C35E6465F3" name="GUID-0DB2A541-9799-48A6-9668-86C35E6465F3"></a><h5 id="TGSQL-GUID-0DB2A541-9799-48A6-9668-86C35E6465F3" class="sect5"><span class="enumeration_section">21.1.1.2 </span>Composite Database Operation Use Cases
                     </h5>
                     <div>
                        <p>In OLTP and data warehouse environments, a job often logically groups related SQL statements. The job can span multiple concurrent sessions.</p>
                        <p>Typical use cases for monitoring composite operations include the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>A periodic batch job containing many SQL statements must complete in a certain number of hours, but took twice as long as expected.</p>
                           </li>
                           <li>
                              <p>After a database upgrade, the execution time of an important batch job doubled. To resolve this problem, you must collect enough relevant statistical data from the batch job before and after the upgrade, compare the two sets of data, and then identify the changes.</p>
                           </li>
                           <li>
                              <p>Packing a <a href="glossary.html#GUID-52FB0AE5-7346-44E5-BE92-3C09385B1DDC"><span class="xrefglossterm">SQL tuning set (STS)</span></a> took far longer than anticipated. To diagnose the problem, you need to know what was being executed over time. Because this issue cannot be easily reproduced, you need to monitor the process while it is running.
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-0DB2A541-9799-48A6-9668-86C35E6465F3__GUID-9E2007BE-F17A-44CB-A382-B2452F0B4F93">
                           <p class="notep1">See Also:</p>
                           <p><span class="q">"<a href="managing-sql-tuning-sets.html#GUID-DD136837-9921-4C73-ABB8-9F1DC22542C5" title="A SQL tuning set (STS) is a database object that you can use as input to tuning tools.">About SQL Tuning Sets</a>"</span></p>
                        </div>
                     </div>
                  </div>
               </div><a id="TGSQL94586"></a><div class="props_rev_3"><a id="GUID-B581E8C5-41AC-4638-978F-80E758AAE2B7" name="GUID-B581E8C5-41AC-4638-978F-80E758AAE2B7"></a><h4 id="TGSQL-GUID-B581E8C5-41AC-4638-978F-80E758AAE2B7" class="sect4"><span class="enumeration_section">21.1.2 </span>Database Operation Monitoring Concepts
                  </h4>
                  <div>
                     <p>The <code class="codeph">DBMS_SQL_MONITOR</code> package is the key component of the architecture for database operations.
                     </p>
                     <p>This section contains the following topics:</p>
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-CEED2A89-51DE-42AC-B2BD-CAD3D6E25807">About the Architecture of Real-Time SQL Monitoring</a><br>Real-Time SQL Monitoring is a built-in database infrastructure that helps you identify performance problems with long-running and parallel SQL statements.
                        </li>
                        <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-5D853CB9-D65C-44DF-BB43-058DA861B42D">When the Database Monitors Operations</a><br>Monitoring of operations depends on whether the database operation is simple or composite.
                        </li>
                        <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-EC276737-148A-4ED7-AA7D-F125AD1B8859">Attributes of Database Operations</a><br>The <code class="codeph">DBMS_SQL_MONITOR.BEGIN_OPERATION</code> function defines a database operation.
                        </li>
                     </ul>
                  </div>
                  <a id="TGSQL94588"></a><a id="TGSQL94587"></a><div class="props_rev_3"><a id="GUID-CEED2A89-51DE-42AC-B2BD-CAD3D6E25807" name="GUID-CEED2A89-51DE-42AC-B2BD-CAD3D6E25807"></a><h5 id="TGSQL-GUID-CEED2A89-51DE-42AC-B2BD-CAD3D6E25807" class="sect5"><span class="enumeration_section">21.1.2.1 </span>About the Architecture of Real-Time SQL Monitoring
                     </h5>
                     <div>
                        <p>Real-Time SQL Monitoring is a built-in database infrastructure that helps you identify performance problems with long-running and parallel SQL statements.</p>
                        <p>Real-Time SQL Monitoring is a feature of the Oracle Database Tuning Pack. Database operations are enabled when the <code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code> initialization parameter is set to <code class="codeph">DIAGNOSTIC+TUNING</code> (default).
                        </p>
                        <p>The following figure gives an overview of the architecture for Real-Time SQL Monitoring.</p>
                        <div class="figure" id="GUID-CEED2A89-51DE-42AC-B2BD-CAD3D6E25807__CHDIEDBG">
                           <p class="titleinfigure">Figure 21-1 Architecture for Real-Time SQL Monitoring</p><img src="img/tgsql_vm_033.png" alt="Description of Figure 21-1 follows" title="Description of Figure 21-1 follows" longdesc="img_text/tgsql_vm_033.html"><br><a href="img_text/tgsql_vm_033.html">Description of "Figure 21-1 Architecture for Real-Time SQL Monitoring"</a></div>
                        <!-- class="figure" -->
                        <p>As shown in the preceding graphic, the <code class="codeph">DBMS_SQL_MONITOR</code> PL/SQL package defines database operations. After monitoring is initiated, the database stores metadata about the database operations in AWR, and the data itself in both AWR and ASH. The database refreshes monitoring statistics in close to real time as each monitored statement executes, typically once every second. The database stores the operational data (the statements and metadata about the statements) in the SGA, and then periodically writes it to disk.
                        </p>
                        <p>Every monitored database operation has an entry in the <code class="codeph">V$SQL_MONITOR</code> view. This entry tracks key performance metrics collected for the execution, including the elapsed time, CPU time, number of reads and writes, I/O wait time, and various other wait times. The <code class="codeph">V$SQL_PLAN_MONITOR</code> view includes monitoring statistics for each operation in the execution plan of the SQL statement being monitored. You can access reports by using <code class="codeph">DBMS_SQL_MONITOR.REPORT_SQL_MONITOR</code>, Oracle Enterprise Manager Cloud Control (Cloud Control), or EM Express.
                        </p>
                        <div class="infoboxnotealso" id="GUID-CEED2A89-51DE-42AC-B2BD-CAD3D6E25807__GUID-9866759A-4792-41B7-ACAE-61886EEAA495">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p> <span class="q">"<a href="monitoring-database-operations.html#GUID-4048D00E-2635-42C8-A37D-71EFAC619062" title="By default, AWR automatically captures SQL monitoring reports in XML format.">Monitoring SQL Executions Using Cloud Control</a>"</span></p>
                              </li>
                              <li>
                                 <p><span><cite>Oracle Database Reference</cite></span> to learn about <a href="../refrn/V-SQL_MONITOR.html#GUID-79E97A84-9C27-4A5E-AC0D-C12CB3E748E6"><code class="codeph">V$SQL_MONITOR</code></a>, <a href="../refrn/V-SQL_PLAN_MONITOR.html#GUID-85354ECB-7E2E-4D4B-AE78-243A4BB6E523"><code class="codeph">V$SQL_PLAN_MONITOR</code></a>, and <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/12.2/tgsql&amp;id=GUID-A5CA11BA-AE1F-4A2E-9C59-A98BA1F4E5C2"><code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code></a></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/12.2/tgsql&amp;id=ARPLS68375"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about <code class="codeph">DBMS_SQLTUNE</code> and <code class="codeph">DBMS_SQL_MONITOR</code> packages
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-5D853CB9-D65C-44DF-BB43-058DA861B42D" name="GUID-5D853CB9-D65C-44DF-BB43-058DA861B42D"></a><h5 id="TGSQL-GUID-5D853CB9-D65C-44DF-BB43-058DA861B42D" class="sect5"><span class="enumeration_section">21.1.2.2 </span>When the Database Monitors Operations
                     </h5>
                     <div>
                        <p>Monitoring of operations depends on whether the database operation is simple or composite.</p>
                        <p>This section contains the following topics:</p>
                     </div>
                     <div>
                        <ul class="ullinks">
                           <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-7C35907D-AAFA-4C68-9BD3-2FF47458BD61">Simple Database Operations</a><br>A <strong class="term">simple database operation</strong> is a single SQL statement or PL/SQL subprogram.
                           </li>
                           <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-DAA57D6B-89D4-41BD-A56C-5AD02CAC417E">Composite Database Operations</a><br>A <strong class="term">composite database operation</strong> is activity between two points in time in a database session, with each session defining its own beginning and end points. 
                           </li>
                        </ul>
                     </div>
                     
                     <div class="sect5"><a id="GUID-7C35907D-AAFA-4C68-9BD3-2FF47458BD61" name="GUID-7C35907D-AAFA-4C68-9BD3-2FF47458BD61"></a><h6 id="TGSQL-GUID-7C35907D-AAFA-4C68-9BD3-2FF47458BD61" class="sect6"><span class="enumeration_section">21.1.2.2.1 </span>Simple Database Operations
                        </h6>
                        <div>
                           <p>A <strong class="term">simple database operation</strong> is a single SQL statement or PL/SQL subprogram.
                           </p>
                           <p>Oracle Database monitors simple database operations when any of the following conditions is true:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>SQL statements execute in parallel.</p>
                              </li>
                              <li>
                                 <p>Tracking for SQL statements is forced by the <code class="codeph">/*+ MONITOR */</code> hint.
                                 </p>
                              </li>
                              <li>
                                 <p>SQL statements or PL/SQL subprograms have consumed at least 5 seconds of CPU or I/O time in a single execution.</p>
                              </li>
                           </ul>
                           <p>For simple operations, Real-Time SQL Monitoring helps determine where a currently executing SQL statement is in its execution plan and where the statement is spending its time. You can also see the breakdown of time and resource usage for recently completed statements. In this way, you can better determine why a particular operation is expensive.</p>
                           <p>Typical use cases for Real-Time SQL Monitoring include the following:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>A frequently executed SQL statement is executing more slowly than normal. You must identify the root cause of this problem.</p>
                              </li>
                              <li>
                                 <p>A database session is experiencing slow performance.</p>
                              </li>
                              <li>
                                 <p>A parallel SQL statement is taking a long time. You want to determine how the server processes are dividing the work.</p>
                              </li>
                           </ul>
                        </div>
                     </div><a id="TGSQL94589"></a><div class="props_rev_3"><a id="GUID-DAA57D6B-89D4-41BD-A56C-5AD02CAC417E" name="GUID-DAA57D6B-89D4-41BD-A56C-5AD02CAC417E"></a><h6 id="TGSQL-GUID-DAA57D6B-89D4-41BD-A56C-5AD02CAC417E" class="sect6"><span class="enumeration_section">21.1.2.2.2 </span>Composite Database Operations
                        </h6>
                        <div>
                           <p>A <strong class="term">composite database operation</strong> is activity between two points in time in a database session, with each session defining its own beginning and end points. 
                           </p>
                           <p>SQL statements or PL/SQL subprograms that execute within these two points in time are part of the composite operation. A session can participate in at most one composite database operation at a time. </p>
                           <p></p>
                           <p>Oracle Database monitors composite database operations when either of the following conditions is true:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>You started an operation with <code class="codeph">DBMS_SQL_MONITOR.BEGIN_OPERATION</code>, and the operation has consumed at least 5 seconds of CPU or I/O time.
                                 </p>
                              </li>
                              <li>
                                 <p>Tracking for the operations is forced by setting <code class="codeph">FORCE_TRACKING</code> to <code class="codeph">Y</code> in <code class="codeph">BEGIN_OPERATION</code>.
                                 </p>
                              </li>
                           </ul>
                           <p>In OLTP and data warehouse environments, a job often logically groups related SQL statements. The job can span multiple concurrent sessions. Typical use cases for monitoring composite operations include the following:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>A periodic batch job containing many SQL statements must complete in a certain number of hours, but took longer than expected.</p>
                              </li>
                              <li>
                                 <p>After a database upgrade, the execution time of an important batch job increased. To resolve this problem, you must collect enough relevant statistical data from the batch job before and after the upgrade, compare the two sets of data, and then identify the changes.</p>
                              </li>
                              <li>
                                 <p>Packing a <a href="glossary.html#GUID-52FB0AE5-7346-44E5-BE92-3C09385B1DDC"><span class="xrefglossterm">SQL tuning set (STS)</span></a> took far longer than anticipated. To diagnose the problem, you need to know what was being executed over time. Because this issue cannot be easily reproduced, you need to monitor the process while it is running.
                                 </p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-DAA57D6B-89D4-41BD-A56C-5AD02CAC417E__GUID-9E2007BE-F17A-44CB-A382-B2452F0B4F93">
                              <p class="notep1">See Also:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><span class="q">"<a href="managing-sql-tuning-sets.html#GUID-DD136837-9921-4C73-ABB8-9F1DC22542C5" title="A SQL tuning set (STS) is a database object that you can use as input to tuning tools.">About SQL Tuning Sets</a>"</span></p>
                                 </li>
                                 <li>
                                    <p><a href="../arpls/DBMS_SQL_MONITOR.html#ARPLS74779"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn more about <code class="codeph">DBMS_SQL_MONITOR</code></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div>
                  </div><a id="TGSQL94590"></a><div class="props_rev_3"><a id="GUID-EC276737-148A-4ED7-AA7D-F125AD1B8859" name="GUID-EC276737-148A-4ED7-AA7D-F125AD1B8859"></a><h5 id="TGSQL-GUID-EC276737-148A-4ED7-AA7D-F125AD1B8859" class="sect5"><span class="enumeration_section">21.1.2.3 </span>Attributes of Database Operations
                     </h5>
                     <div>
                        <p>The <code class="codeph">DBMS_SQL_MONITOR.BEGIN_OPERATION</code> function defines a database operation.
                        </p>
                        <p>A database operation is uniquely identified by the following information:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Database operation name</p>
                              <p>This is a user-created name such as <code class="codeph">daily_sales_report</code>. The operation name is the same for a job even if it is executed concurrently by different sessions or on different databases. Database operation names do not reside in different namespaces.
                              </p>
                           </li>
                           <li>
                              <p>Database operation execution ID</p>
                              <p>Two or more occurrences of the same database operation can run at the same time, with the same name but different execution IDs. This numeric ID uniquely identifies different executions of the <span class="italic">same</span> database operation. 
                              </p>
                              <p>The database automatically creates an execution ID when you begin a database operation. You can also specify a user-created execution ID.</p>
                           </li>
                        </ul>
                        <p>Optionally, you can specify the session ID and session serial number in which to start the database operations. Thus, one database session can start a database operation defined in a different database session.</p>
                        <p>The database uses the following triplet of values to identify each SQL and PL/SQL statement monitored in the <code class="codeph">V$SQL_MONITOR</code> view, regardless of whether the statement is included in a database operation:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>SQL identifier to identify the SQL statement (<code class="codeph">SQL_ID</code>)
                              </p>
                           </li>
                           <li>
                              <p>Start execution timestamp (<code class="codeph">SQL_EXEC_START</code>)
                              </p>
                           </li>
                           <li>
                              <p>An internally generated identifier to ensure that this primary key is truly unique (<code class="codeph">SQL_EXEC_ID</code>)
                              </p>
                           </li>
                        </ul>
                        <p>You can use zero or more additional attributes to describe and identify the characteristics of a database operation. Each attribute has a name and value. For example, for operation <code class="codeph">daily_sales_report</code>, you might define the attribute <code class="codeph">db_name</code> and assign it the value <code class="codeph">prod</code>.
                        </p>
                        <div class="infoboxnotealso" id="GUID-EC276737-148A-4ED7-AA7D-F125AD1B8859__GUID-F308114B-4AD4-41CE-A846-652A4A611A29">
                           <p class="notep1">See Also:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/12.2/tgsql&amp;id=REFRN30479"><span><cite>Oracle Database Reference</cite></span></a> to learn about the <code class="codeph">V$SQL_MONITOR</code> view
                                 </p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/12.2/tgsql&amp;id=ARPLS68375"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_SQL_MONITOR.BEGIN_OPERATION</code> function
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="TGSQL94592"></a><div class="props_rev_3"><a id="GUID-13D71625-2548-4F7B-B2B2-FEEAD24F7690" name="GUID-13D71625-2548-4F7B-B2B2-FEEAD24F7690"></a><h4 id="TGSQL-GUID-13D71625-2548-4F7B-B2B2-FEEAD24F7690" class="sect4"><span class="enumeration_section">21.1.3 </span>User Interfaces for Database Operations Monitoring
                  </h4>
                  <div>
                     <p>You can monitor database operations from the command line or by using Cloud Control.</p>
                     <div class="section">
                        <p>This section contains the following topics:</p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-061502D7-5546-4AB6-B6D3-62FBF71E8CB7">Monitored SQL Executions Page in Cloud Control</a><br>The Monitored SQL Executions page in Cloud Control, also known as SQL Monitor, displays details of SQL execution. SQL Monitor is the recommended interface for reporting on database operations.
                        </li>
                        <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-4ABD504A-EDAD-4DA6-BEBD-772BF9214218">DBMS_SQL_MONITOR Package</a><br>The <code class="codeph">DBMS_SQL_MONITOR</code> package defines the beginning and ending of a database operation, and generates a report of the database operations.
                        </li>
                        <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-E471C229-5713-40E2-A95C-593EACB56AE7">Views for Monitoring and Reporting on Database Operations</a><br>You can obtain the statistics for database operations using several <code class="codeph">V$</code> and data dictionary view.
                        </li>
                     </ul>
                  </div>
                  <a id="TGSQL94593"></a><div class="props_rev_3"><a id="GUID-061502D7-5546-4AB6-B6D3-62FBF71E8CB7" name="GUID-061502D7-5546-4AB6-B6D3-62FBF71E8CB7"></a><h5 id="TGSQL-GUID-061502D7-5546-4AB6-B6D3-62FBF71E8CB7" class="sect5"><span class="enumeration_section">21.1.3.1 </span>Monitored SQL Executions Page in Cloud Control
                     </h5>
                     <div>
                        <p>The Monitored SQL Executions page in Cloud Control, also known as SQL Monitor, displays details of SQL execution. SQL Monitor is the recommended interface for reporting on database operations.</p>
                        <div class="section">
                           <p>Statistics at each step of the execution plan are tracked by key performance metrics, including elapsed time, CPU time, number of reads and writes, I/O wait time, and various other wait times. These metrics enable DBAs to analyze SQL execution in depth and decide on the most appropriate tuning strategies for monitored SQL statements. </p>
                           <p>SQL Monitor Active Reports provide a flash-based interactive report that enables you to save data in an HTML file. You can save this file and view it offline.</p>
                           <p>This section contains the following topics:</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                     <div>
                        <ul class="ullinks">
                           <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-4D6B463D-0CFB-4A2F-9507-B64122AAC530">Accessing the Monitored SQL Executions Page</a><br>The Monitored SQL Executions shows information such as the SQL ID, database time, and I/O requests.
                           </li>
                        </ul>
                     </div>
                     <a id="TGSQL94594"></a><div class="props_rev_3"><a id="GUID-4D6B463D-0CFB-4A2F-9507-B64122AAC530" name="GUID-4D6B463D-0CFB-4A2F-9507-B64122AAC530"></a><h6 id="TGSQL-GUID-4D6B463D-0CFB-4A2F-9507-B64122AAC530" class="sect6"><span class="enumeration_section">21.1.3.1.1 </span>Accessing the Monitored SQL Executions Page
                        </h6>
                        <div>
                           <p>The Monitored SQL Executions shows information such as the SQL ID, database time, and I/O requests.</p>
                           <div class="section">
                              <p class="subhead3">To access the Monitored SQL Executions page:</p>
                              <ol>
                                 <li>
                                    <p>Log in to Cloud Control with the appropriate credentials.</p>
                                 </li>
                                 <li>
                                    <p>Under the <span class="bold">Targets</span> menu, select <span class="bold">Databases</span>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>In the list of database targets, select the target for the Oracle Database instance that you want to administer.</p>
                                 </li>
                                 <li>
                                    <p>If prompted for database credentials, then enter the minimum credentials necessary for the tasks you intend to perform.</p>
                                 </li>
                                 <li>
                                    <p>From the <span class="bold">Performance</span> menu, select <span class="bold">SQL Monitoring</span>.
                                    </p>
                                    <p>The Monitored SQL Executions page appears.</p>
                                    <div class="figure" id="GUID-4D6B463D-0CFB-4A2F-9507-B64122AAC530__GUID-055D4E03-F49D-4192-8FFF-37E44818608E">
                                       <p class="titleinfigure">Figure 21-2 Monitored SQL Executions</p><img src="img/mon_sql_exec.jpg" alt="Description of Figure 21-2 follows" title="Description of Figure 21-2 follows" longdesc="img_text/mon_sql_exec.html"><br><a href="img_text/mon_sql_exec.html">Description of "Figure 21-2 Monitored SQL Executions"</a></div>
                                    <!-- class="figure" -->
                                 </li>
                              </ol>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div>
                  </div><a id="TGSQL94596"></a><a id="TGSQL94595"></a><div class="props_rev_3"><a id="GUID-4ABD504A-EDAD-4DA6-BEBD-772BF9214218" name="GUID-4ABD504A-EDAD-4DA6-BEBD-772BF9214218"></a><h5 id="TGSQL-GUID-4ABD504A-EDAD-4DA6-BEBD-772BF9214218" class="sect5"><span class="enumeration_section">21.1.3.2 </span>DBMS_SQL_MONITOR Package
                     </h5>
                     <div>
                        <p>The <code class="codeph">DBMS_SQL_MONITOR</code> package defines the beginning and ending of a database operation, and generates a report of the database operations.
                        </p>
                        <div class="tblformal" id="GUID-4ABD504A-EDAD-4DA6-BEBD-772BF9214218__GUID-B2677E02-96F7-4C9E-BFDB-7B2AE810BBA6">
                           <p class="titleintable">Table 21-1 DBMS_SQL_MONITOR</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_SQL_MONITOR" summary="This 2 column table describes DBMS_SQL_MONITOR. Column 1 is the program unit. Column 2 describes that unit. " width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="21%" id="d102340e2101">Subprogram</th>
                                    <th align="left" valign="bottom" width="79%" id="d102340e2104">Description</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d102340e2109" headers="d102340e2101 ">
                                       <p><code class="codeph">BEGIN_OPERATION</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d102340e2109 d102340e2104 ">
                                       <p><span>This function starts a composite database operation in the current session.</span></p>
                                       <p>This function associates a session with a database operation. Starting in Oracle Database 12<span class="italic">c</span> Release 2 (12.2), you can use <code class="codeph">session_id</code> and <code class="codeph">session_num</code> to indicate the session in which to start monitoring.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d102340e2129" headers="d102340e2101 ">
                                       <p><code class="codeph">END_OPERATION</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d102340e2129 d102340e2104 ">
                                       <p><span>This function ends a composite database operation in the current session. If the specified composite database operation does not exist, then this function has no effect.</span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d102340e2138" headers="d102340e2101 ">
                                       <p><code class="codeph">REPORT_SQL_MONITOR</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d102340e2138 d102340e2104 ">
                                       <p><span>This function builds a detailed report with monitoring information for a simple or a composite database operation.</span></p>
                                       <p>For each operation, it gives key information and associated global statistics. Use this function to get detailed monitoring information for a simple or a composite database operation.</p>
                                       <p>The target database operation for this report can be:</p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>The last database operation monitored by Oracle Database (default, no parameter).</p>
                                          </li>
                                          <li>
                                             <p>The last database operation executed in the specified session and monitored by Oracle Database. The session is identified by its session ID and optionally its serial number (<code class="codeph">-1</code> is current session). 
                                             </p>
                                          </li>
                                          <li>
                                             <p>The last execution of a specific database operation identified by its <code class="codeph">sql_id</code>.
                                             </p>
                                          </li>
                                          <li>
                                             <p>A specific execution of a database operation identified by the combination <code class="codeph">sql_id</code>, <code class="codeph">sql_exec_start</code>, and <code class="codeph">sql_exec_id</code>.
                                             </p>
                                          </li>
                                          <li>
                                             <p>The last execution of a specific composite database operation identified by <code class="codeph">dbop_name</code>.
                                             </p>
                                          </li>
                                          <li>
                                             <p>The specific execution of a composite database operation identified by the combination <code class="codeph">dbop_name</code>, <code class="codeph">dbop_exec_id</code>.
                                             </p>
                                          </li>
                                       </ul>
                                       <p>Use the <code class="codeph">type</code> parameter to specify the output type: <code class="codeph">TEXT</code> (default), <code class="codeph">HTML</code>, <code class="codeph">ACTIVE</code>, or <code class="codeph">XML</code>.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d102340e2211" headers="d102340e2101 ">
                                       <p><code class="codeph">REPORT_SQL_MONITOR_XML</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d102340e2211 d102340e2104 ">
                                       <p><span>This function is identical to the <code class="codeph">REPORT_SQL_MONITOR</code> function, except that the return type is <code class="codeph">XMLType</code>.</span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d102340e2226" headers="d102340e2101 ">
                                       <p><code class="codeph">REPORT_SQL_MONITOR_LIST</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d102340e2226 d102340e2104 ">
                                       <p><span>This function builds a report for all or a subset of database operations that have been monitored by Oracle Database.</span></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="21%" id="d102340e2235" headers="d102340e2101 ">
                                       <p><code class="codeph">REPORT_SQL_MONITOR_LIST_XML</code></p>
                                    </td>
                                    <td align="left" valign="top" width="79%" headers="d102340e2235 d102340e2104 ">
                                       <p><span>This function is identical to the <code class="codeph">REPORT_SQL_MONITOR_LIST</code> function, except that it returns <code class="codeph">XMLType</code>.</span></p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-4ABD504A-EDAD-4DA6-BEBD-772BF9214218__GUID-F4C2D356-6227-407F-96AA-A552D6AC39BB">
                              <p class="notep1">See Also:</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/12.2/tgsql&amp;id=ARPLS74779"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_SQL_MONITOR</code> package
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="TGSQL94598"></a><a id="TGSQL94597"></a><div class="props_rev_3"><a id="GUID-E471C229-5713-40E2-A95C-593EACB56AE7" name="GUID-E471C229-5713-40E2-A95C-593EACB56AE7"></a><h5 id="TGSQL-GUID-E471C229-5713-40E2-A95C-593EACB56AE7" class="sect5"><span class="enumeration_section">21.1.3.3 </span>Views for Monitoring and Reporting on Database Operations
                     </h5>
                     <div>
                        <p>You can obtain the statistics for database operations using several <code class="codeph">V$</code> and data dictionary view.
                        </p>
                        <div class="section">
                           <p>The following table summarizes these views.</p>
                           <div class="tblformal" id="GUID-E471C229-5713-40E2-A95C-593EACB56AE7__CHDFEHFI">
                              <p class="titleintable">Table 21-2 Views for Database Operations Monitoring</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="Views for Database Operations Monitoring" summary="This table describes views that you can use to monitor database operations." width="100%" frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" id="d102340e2369">View</th>
                                       <th align="left" valign="bottom" id="d102340e2372">Description</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d102340e2377" headers="d102340e2369 ">
                                          <p><a href="../refrn/DBA_HIST_REPORTS.html#REFRN23881"><code class="codeph">DBA_HIST_REPORTS</code></a></p>
                                       </td>
                                       <td align="left" valign="top" headers="d102340e2377 d102340e2372 ">
                                          <p>This view displays metadata about XML reports captured into Automatic Workload Repository (AWR). Each XML report contains details about some activity of a component. For example, a SQL Monitor report contains a detailed report about a particular database operation.</p>
                                          <p>Important columns include:</p>
                                          <ul style="list-style-type: disc;">
                                             <li>
                                                <p>The <code class="codeph">REPORT_SUMMARY</code> column contains the summary of the report.
                                                </p>
                                             </li>
                                             <li>
                                                <p>The <code class="codeph">COMPONENT_NAME</code> column accepts the value <code class="codeph">sqlmonitor</code>.
                                                </p>
                                             </li>
                                             <li>
                                                <p>The <code class="codeph">REPORT_ID</code> column provides the ID of the report, which you can specify in the <code class="codeph">RID</code> parameter of <code class="codeph">DBMS_AUTO_REPORT.REPORT_REPOSITORY_DETAIL</code>.
                                                </p>
                                             </li>
                                          </ul>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d102340e2417" headers="d102340e2369 ">
                                          <p><a href="../refrn/DBA_HIST_REPORTS_DETAILS.html#REFRN23882"><code class="codeph">DBA_HIST_REPORTS_DETAILS</code></a></p>
                                       </td>
                                       <td align="left" valign="top" headers="d102340e2417 d102340e2372 ">
                                          <p>This view displays details about each report captured in AWR. Metadata for each report appears in the <code class="codeph">DBA_HIST_REPORTS</code> view, whereas the actual report is available in the <code class="codeph">DBA_HIST_REPORTS_DETAILS</code> view.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d102340e2433" headers="d102340e2369 ">
                                          <p><a href="../refrn/V-SQL_MONITOR.html#GUID-79E97A84-9C27-4A5E-AC0D-C12CB3E748E6"><code class="codeph">V$SQL_MONITOR</code></a></p>
                                       </td>
                                       <td align="left" valign="top" headers="d102340e2433 d102340e2372 ">
                                          <p>This view contains global, high-level information about simple and composite database operations.</p>
                                          <p>For simple database operations, monitoring statistics are not cumulative over several executions. In this case, one entry in <code class="codeph">V$SQL_MONITOR</code> is dedicated to a single execution of a SQL statement. If the database monitors two executions of the same SQL statement, then each execution has a separate entry in <code class="codeph">V$SQL_MONITOR</code>.
                                          </p>
                                          <p>For simple database operations, <code class="codeph">V$SQL_MONITOR</code> has one entry for the parallel execution coordinator process and one entry for each parallel execution server process. Each entry has corresponding entries in <code class="codeph">V$SQL_PLAN_MONITOR</code>. Because the processes allocated for the parallel execution of a SQL statement are cooperating for the same execution, these entries share the same execution key (the combination of <code class="codeph">SQL_ID</code>, <code class="codeph">SQL_EXEC_START</code>, and <code class="codeph">SQL_EXEC_ID</code>).
                                          </p>
                                          <p>For composite database operations, each row contains an operation whose statistics are accumulated over the SQL statements and PL/SQL subprograms that run in the same session as part of the operation. The primary key is the combination of the columns <code class="codeph">DBOP_NAME</code> and <code class="codeph">DBOP_EXEC_ID</code>.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d102340e2476" headers="d102340e2369 ">
                                          <p><a href="../refrn/V-SQL_MONITOR_SESSTAT.html#GUID-F1C68683-4048-44FD-8B7A-F30FDCB751CA"><code class="codeph">V$SQL_MONITOR_SESSTAT</code></a></p>
                                       </td>
                                       <td align="left" valign="top" headers="d102340e2476 d102340e2372 ">
                                          <p>This view contains the statistics for all sessions involved in the database operation.</p>
                                          <p>Most of the statistics are cumulative. The database stores the statistics in XML format instead of using each column for each statistic. This view is primarily intended for the report generator. Oracle recommends that you use <code class="codeph">V$SESSTAT</code> instead of <code class="codeph">V$SQL_MONITOR_SESSTAT</code>.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" id="d102340e2494" headers="d102340e2369 ">
                                          <p><a href="../refrn/V-SQL_PLAN_MONITOR.html#GUID-85354ECB-7E2E-4D4B-AE78-243A4BB6E523"><code class="codeph">V$SQL_PLAN_MONITOR</code></a></p>
                                       </td>
                                       <td align="left" valign="top" headers="d102340e2494 d102340e2372 ">
                                          <p>This view contains monitoring statistics for each step in the execution plan of the monitored SQL statement.</p>
                                          <p>The database updates statistics in <code class="codeph">V$SQL_PLAN_MONITOR</code> every second while the SQL statement is executing. Multiple entries exist in <code class="codeph">V$SQL_PLAN_MONITOR</code> for every monitored SQL statement. Each entry corresponds to a step in the execution plan of the statement.
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p>You can use the preceding <code class="codeph">V$</code> views with the following views to get additional information about the monitored execution:
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">V$ACTIVE_SESSION_HISTORY</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">V$SESSION</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">V$SESSION_LONGOPS</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">V$SQL</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">V$SQL_PLAN</code></p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-E471C229-5713-40E2-A95C-593EACB56AE7__GUID-496AF598-73E7-4D1A-A61C-F6358276E7D7">
                              <p class="notep1">See Also:</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/12.2/tgsql&amp;id=GUID-8C5690B0-DE10-4460-86DF-80111869CF4C"><span><cite>Oracle Database Reference</cite></span></a> to learn about the <code class="codeph">V$</code> views for database operations monitoring
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="TGSQL94599"></a><div class="props_rev_3"><a id="GUID-A11CCA38-7DD8-4B08-9311-29CC7ED92EE6" name="GUID-A11CCA38-7DD8-4B08-9311-29CC7ED92EE6"></a><h4 id="TGSQL-GUID-A11CCA38-7DD8-4B08-9311-29CC7ED92EE6" class="sect4"><span class="enumeration_section">21.1.4 </span>Basic Tasks in Database Operations Monitoring
                  </h4>
                  <div>
                     <p>This section explains the basic tasks in database operations monitoring.</p>
                     <p>Basic tasks are as follows:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="q">"<a href="monitoring-database-operations.html#GUID-61D052D2-1F06-4A8C-A9D8-26504AD8A720" title="Use initialization parameters to enable or disable monitoring.">Enabling and Disabling Monitoring of Database Operations</a>"</span></p>
                           <p>This task explains how you can enable automatic monitoring of database operations at the system and statement level.</p>
                        </li>
                        <li>
                           <p><span class="q">"<a href="monitoring-database-operations.html#GUID-DC573FB7-40C5-4D6D-BE81-EF356900B444" title="Creating a database operation involves supplying a name and defining its beginning and end times.">Creating a Database Operation</a>"</span></p>
                           <p>This section explains how you can define the beginning and end of a database operation using PL/SQL.</p>
                        </li>
                        <li>
                           <p><span class="q">"<a href="monitoring-database-operations.html#GUID-4048D00E-2635-42C8-A37D-71EFAC619062" title="By default, AWR automatically captures SQL monitoring reports in XML format.">Monitoring SQL Executions Using Cloud Control</a>"</span></p>
                           <p>This section explains how you can generate and interpret reports on a database operation.</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="TGSQL94600"></a><div class="props_rev_3"><a id="GUID-61D052D2-1F06-4A8C-A9D8-26504AD8A720" name="GUID-61D052D2-1F06-4A8C-A9D8-26504AD8A720"></a><h3 id="TGSQL-GUID-61D052D2-1F06-4A8C-A9D8-26504AD8A720" class="sect3"><span class="enumeration_section">21.2 </span>Enabling and Disabling Monitoring of Database Operations
               </h3>
               <div>
                  <p>Use initialization parameters to enable or disable monitoring.</p>
                  <p>This section contains the following topics:</p>
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-9BFBE13A-EAD4-435F-8A8B-F95FB11F3AC7">Enabling Monitoring of Database Operations at the System Level</a><br>The SQL monitoring feature is enabled by default when the <code class="codeph">STATISTICS_LEVEL</code> initialization parameter is either set to <code class="codeph">TYPICAL</code> (the default value) or <code class="codeph">ALL</code>. SQL monitoring starts automatically for all long-running queries.
                     </li>
                     <li class="ulchildlink"><a href="monitoring-database-operations.html#GUID-BBE58891-7BEF-4371-ADAE-6B0A88156B8A">Enabling and Disabling Monitoring of Database Operations at the Statement Level</a><br>When the <code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code> initialization parameter is set to <code class="codeph">DIAGNOSTIC+TUNING</code>, you can use hints to enable or disable monitoring of specific SQL statements. 
                     </li>
                  </ul>
               </div>
               <a id="TGSQL94954"></a><a id="TGSQL94602"></a><a id="TGSQL94601"></a><div class="props_rev_3"><a id="GUID-9BFBE13A-EAD4-435F-8A8B-F95FB11F3AC7" name="GUID-9BFBE13A-EAD4-435F-8A8B-F95FB11F3AC7"></a><h4 id="TGSQL-GUID-9BFBE13A-EAD4-435F-8A8B-F95FB11F3AC7" class="sect4"><span class="enumeration_section">21.2.1 </span>Enabling Monitoring of Database Operations at the System Level
                  </h4>
                  <div>
                     <p>The SQL monitoring feature is enabled by default when the <code class="codeph">STATISTICS_LEVEL</code> initialization parameter is either set to <code class="codeph">TYPICAL</code> (the default value) or <code class="codeph">ALL</code>. SQL monitoring starts automatically for all long-running queries.
                     </p>
                     <div class="section">
                        <p class="subhead3">Prerequisites</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>Because SQL monitoring is a feature of the Oracle Database Tuning Pack, the <code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code> initialization parameter must be set to <code class="codeph">DIAGNOSTIC+TUNING</code> (the default value). 
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3">Assumptions</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The <code class="codeph">STATISTICS_LEVEL</code> initialization parameter is set to <code class="codeph">BASIC</code>.
                              </p>
                           </li>
                           <li>
                              <p>You want to enable automatic monitoring of database operations.</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3">To enable monitoring of database operations:</p>
                        <ol>
                           <li>
                              <p>Connect SQL*Plus to the database with the appropriate privileges, and then query the current database operations settings.</p>
                              <p>For example, run the following SQL*Plus command:</p><pre class="pre codeblock"><code>SQL&gt; SHOW PARAMETER statistics_level
 
NAME                                TYPE        VALUE
----------------------------------- ----------- -----
statistics_level                    string      BASIC
</code></pre></li>
                           <li>
                              <p>Set the statistics level to <code class="codeph">TYPICAL</code>.
                              </p>
                              <p>For example, run the following SQL statement:</p><pre class="pre codeblock"><code>SQL&gt; ALTER SYSTEM SET STATISTICS_LEVEL='TYPICAL';</code></pre></li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-9BFBE13A-EAD4-435F-8A8B-F95FB11F3AC7__GUID-7C076BE7-16E9-431B-932E-5E146D8896C7">
                           <p class="notep1">See Also:</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/12.2/tgsql&amp;id=REFRN10141"><span><cite>Oracle Database Reference</cite></span></a> to learn about the <code class="codeph">STATISTICS_LEVEL</code> and <code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code> initialization parameter
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="TGSQL94604"></a><a id="TGSQL94603"></a><div class="props_rev_3"><a id="GUID-BBE58891-7BEF-4371-ADAE-6B0A88156B8A" name="GUID-BBE58891-7BEF-4371-ADAE-6B0A88156B8A"></a><h4 id="TGSQL-GUID-BBE58891-7BEF-4371-ADAE-6B0A88156B8A" class="sect4"><span class="enumeration_section">21.2.2 </span>Enabling and Disabling Monitoring of Database Operations at the Statement Level
                  </h4>
                  <div>
                     <p>When the <code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code> initialization parameter is set to <code class="codeph">DIAGNOSTIC+TUNING</code>, you can use hints to enable or disable monitoring of specific SQL statements. 
                     </p>
                     <div class="section">
                        <p>The database monitors SQL statements or PL/SQL subprograms automatically when they have consumed at least 5 seconds of CPU or I/O time in a single execution. The <code class="codeph">MONITOR</code> hint is useful to enforce monitoring of statements or subprograms that do not meet the time criteria.
                        </p>
                        <p>Two statement-level hints are available to force or prevent the database from monitoring a SQL statement. To force SQL monitoring, use the <code class="codeph">MONITOR</code> hint:
                        </p><pre class="pre codeblock"><code>SELECT /*+ MONITOR */ SYSDATE FROM DUAL;
</code></pre><p>This hint is effective only when the <code class="codeph">CONTROL_MANAGEMENT_PACK_ACCESS</code> parameter is set to <code class="codeph">DIAGNOSTIC+TUNING</code>. To prevent the hinted SQL statement from being monitored, use the <code class="codeph">NO_MONITOR</code> reverse hint.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3">Assumptions</p>
                        <p>This tutorial assumes the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Database monitoring is currently enabled at the system level.</p>
                           </li>
                           <li>
                              <p>You want to disable automatic monitoring for the statement <code class="codeph">SELECT * FROM sales ORDER BY time_id</code>.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3">To disable monitoring of database operations for a SQL statement:</p>
                        <ol>
                           <li>
                              <p>Execute the query with the <code class="codeph">NO_MONITOR</code> hint.
                              </p>
                              <p>For example, run the following statement:</p><pre class="pre codeblock"><code>SQL&gt; SELECT * /*+NO_MONITOR*/ FROM sales ORDER BY time_id;</code></pre></li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-BBE58891-7BEF-4371-ADAE-6B0A88156B8A__GUID-C701BEE2-D952-4C8F-B133-B98D80CD0A74">
                           <p class="notep1">See Also:</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/12.2/tgsql&amp;id=SQLRF00219"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about using the <code class="codeph">MONITOR</code> and <code class="codeph">NO_MONITOR</code> hints
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="TGSQL94606"></a><a id="TGSQL94605"></a><div class="props_rev_3"><a id="GUID-DC573FB7-40C5-4D6D-BE81-EF356900B444" name="GUID-DC573FB7-40C5-4D6D-BE81-EF356900B444"></a><h3 id="TGSQL-GUID-DC573FB7-40C5-4D6D-BE81-EF356900B444" class="sect3"><span class="enumeration_section">21.3 </span>Creating a Database Operation
               </h3>
               <div>
                  <p>Creating a database operation involves supplying a name and defining its beginning and end times. </p>
                  <div class="section">
                     <p>Start a database operation by using the <code class="codeph">DBMS_SQL_MONITOR.BEGIN_OPERATION</code> function, and end it by using the <code class="codeph">DBMS_SQL_MONITOR.END_OPERATION</code> procedure.
                     </p>
                     <p>To begin the operation in a different session, specify the combination of <code class="codeph">session_id</code> and <code class="codeph">serial_num</code>. The <code class="codeph">BEGIN_OPERATION</code> function returns the database operation execution ID. If <code class="codeph">dbop_exec_id</code> is null, then the database generates a unique value.
                     </p>
                     <p>A single namespace exists for database operations, which means that name collisions are possible. Oracle recommends the following naming convention: <span class="italic">component_name.subcomponent_name.operation name</span>. For operations inside the database, Oracle recommends using <code class="codeph">ORA</code> for the component name. For example, a materialized view refresh could be named <code class="codeph">ORA.MV.refresh</code>. An E-Business Suite payroll function could be named <code class="codeph">EBIZ.payroll</code>. 
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2">To create a database operation in the current session:</p>
                     <ol>
                        <li>
                           <p>In SQL*Plus or SQL Developer, log in to the database as a user with the necessary privileges.</p>
                        </li>
                        <li>
                           <p>Start the operation by using <code class="codeph">DBMS_SQL_MONITOR.BEGIN_OPERATION</code>.
                           </p>
                           <p>This function returns the database operation execution ID. The following example creates the operation named <code class="codeph">ORA.sales.agg</code>, and stores the execution ID in a SQL*Plus variable:
                           </p><pre class="pre codeblock"><code>VARIABLE exec_id NUMBER; 
BEGIN 
  :exec_id := DBMS_SQL_MONITOR.BEGIN_OPERATION ( dbop_name =&gt; 'ORA.sales.agg' ); 
END; 
/</code></pre></li>
                        <li>
                           <p>Execute the SQL statements or PL/SQL programs that you want to monitor.</p>
                        </li>
                        <li>
                           <p>End the operation by using <code class="codeph">DBMS_SQL_MONITOR.END_OPERATION</code>.
                           </p>
                           <p>The following example ends operation <code class="codeph">ORA.sales.agg</code>:
                           </p><pre class="pre codeblock"><code>BEGIN
  DBMS_SQL_MONITOR.END_OPERATION ( dbop_name =&gt; 'ORA.sales.agg', dbop_eid =&gt; :exec_id );
END;
/</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-DC573FB7-40C5-4D6D-BE81-EF356900B444__GUID-C76CA02B-67F5-4226-8F98-6A099F8BB010">
                     <p class="titleinexample">Example 21-1 Creating a Database Operation</p>
                     <p>The following example illustrates how to use the <code class="codeph">DBMS_SQL_MONITOR</code> package to begin and end a database operation in a different session. This example assumes the following:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>You are an administrator and want to monitor statements in a session started by user <code class="codeph">sh</code>.
                           </p>
                        </li>
                        <li>
                           <p>You want to monitor queries of the <code class="codeph">sh.sales</code> table and <code class="codeph">sh.customers</code> table.
                           </p>
                        </li>
                        <li>
                           <p>You want these two queries to be monitored as a database operation named <code class="codeph">sh_count</code>.
                           </p>
                        </li>
                     </ul>
                     <div class="tblformalwide" id="GUID-DC573FB7-40C5-4D6D-BE81-EF356900B444__GUID-0A87E83A-AE66-49F4-B0B1-193FCA0010DD">
                        <p class="titleintable">Table 21-3 Creating a Database Operation</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="Creating a Database Operation" summary="This 2 column table illustrates how to begin and end a database operation. Column 1 is the SYSTEM session. Column 2 is the SH session. Column 3 describes each session. " width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="20%" id="d102340e3359">SYSTEM Session</th>
                                 <th align="left" valign="bottom" width="20%" id="d102340e3361">SH Session</th>
                                 <th align="left" valign="bottom" width="20%" id="d102340e3363">DESCRIPTION</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d102340e3367" headers="d102340e3359 "><pre class="pre codeblock"><code>SQL&gt; CONNECT SYSTEM
Enter password: *********
Connected.
</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3367 d102340e3361 ">
                                    <p>n/a</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3367 d102340e3363 ">
                                    <p>Start SQL*Plus and connect as a user with the administrator privileges.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d102340e3377" headers="d102340e3359 ">
                                    <p>n/a</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3377 d102340e3361 "><pre class="pre codeblock"><code>SQL&gt; CONNECT sh
Enter password: ******
Connected.
</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3377 d102340e3363 ">
                                    <p>In a different terminal, start SQL*Plus and connect as a user as user <code class="codeph">sh</code>.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d102340e3390" headers="d102340e3359 "><pre class="pre codeblock"><code>SELECT SID, SERIAL# 
FROM   V$SESSION 
WHERE  USERNAME = 'SH';

       SID    SERIAL#
---------- ----------
       121      13397
</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3390 d102340e3361 ">
                                    <p>n/a</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3390 d102340e3363 ">
                                    <p>In the <code class="codeph">SYSTEM</code> session, query the session ID and serial number of the <code class="codeph">sh</code> session.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d102340e3406" headers="d102340e3359 "><pre class="pre codeblock"><code>VARIABLE eid NUMBER

BEGIN
:eid:=DBMS_SQL_MONITOR.BEGIN_OPERATION
      ('sh_count', null, null,
       null, '121', '13397');
END;
/

PRINT eid

       EID
----------
         2
</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3406 d102340e3361 ">
                                    <p>n/a</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3406 d102340e3363 ">
                                    <p>In the <code class="codeph">SYSTEM</code> session, begin a database operation, specifying the session ID and serial number for the <code class="codeph">sh</code> session.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d102340e3422" headers="d102340e3359 ">
                                    <p>n/a</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3422 d102340e3361 "><pre class="pre codeblock"><code>SELECT count(*) 
FROM   sh.sales;
 
  COUNT(*)
----------
    918843

SELECT COUNT(*) 
FROM   sh.customers;
 
  COUNT(*)
----------
     55500</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3422 d102340e3363 ">
                                    <p>In the <code class="codeph">sh</code> session, query the <code class="codeph">sales</code> and <code class="codeph">customers</code> tables. These SQL queries are part of the <code class="codeph">sh_count</code> operation.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d102340e3444" headers="d102340e3359 "><pre class="pre codeblock"><code>BEGIN 
  DBMS_SQL_MONITOR.END_OPERATION
        ('sh_count',:eid);
END;
/</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3444 d102340e3361 ">
                                    <p>n/a</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3444 d102340e3363 ">
                                    <p>End the database operation by specifying the operation name and execution ID.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d102340e3454" headers="d102340e3359 "><pre class="pre codeblock"><code>COL DBOP_NAME FORMAT a10
COL STATUS FORMAT a10
COL ID FORMAT 999

SELECT DBOP_NAME, DBOP_EXEC_ID AS ID,
       STATUS, CPU_TIME, BUFFER_GETS
FROM   V$SQL_MONITOR 
WHERE DBOP_NAME IS NOT NULL
      ORDER BY DBOP_EXEC_ID;

DBOP_NAME  ID     STATUS CPU_TIME GETS
---------- -- ---------- -------- ----
sh_count    1  EXECUTING    24997   65</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3454 d102340e3361 ">
                                    <p>n/a</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3454 d102340e3363 ">
                                    <p>Query the metadata for the <code class="codeph">sh_count</code> database operation. The status of the operation is <code class="codeph">EXECUTING</code> because the session has not picked up the new session status.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d102340e3470" headers="d102340e3359 ">
                                    <p>n/a</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3470 d102340e3361 "><pre class="pre codeblock"><code>SELECT SYSDATE FROM DUAL;</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3470 d102340e3363 ">
                                    <p>To collect changed session information, execute a query that performs a round trip to the database.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="20%" id="d102340e3480" headers="d102340e3359 "><pre class="pre codeblock"><code>COL DBOP_NAME FORMAT a10
COL STATUS FORMAT a10
COL ID FORMAT 999

SELECT DBOP_NAME, DBOP_EXEC_ID AS ID,
       STATUS, CPU_TIME, BUFFER_GETS
FROM   V$SQL_MONITOR 
WHERE DBOP_NAME IS NOT NULL
      ORDER BY DBOP_EXEC_ID;

DBOP_NAME  ID     STATUS CPU_TIME GETS
---------- -- ---------- -------- ----
sh_count    1       DONE    24997   65</code></pre></td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3480 d102340e3361 ">
                                    <p>n/a</p>
                                 </td>
                                 <td align="left" valign="top" width="20%" headers="d102340e3480 d102340e3363 ">
                                    <p>The status of the operation is now updated to <code class="codeph">DONE</code>.
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="infoboxnotealso" id="GUID-DC573FB7-40C5-4D6D-BE81-EF356900B444__GUID-166139DA-C9D1-445D-B061-AB1D4CC6A9C1">
                        <p class="notep1">See Also:</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/12.2/tgsql&amp;id=ARPLS68375"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> to learn about the <code class="codeph">DBMS_SQL_MONITOR</code> package
                        </p>
                     </div>
                  </div>
                  <!-- class="example" -->
               </div>
            </div><a id="TGSQL94608"></a><a id="TGSQL94607"></a><div class="props_rev_3"><a id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062" name="GUID-4048D00E-2635-42C8-A37D-71EFAC619062"></a><h3 id="TGSQL-GUID-4048D00E-2635-42C8-A37D-71EFAC619062" class="sect3"><span class="enumeration_section">21.4 </span>Monitoring SQL Executions Using Cloud Control
               </h3>
               <div>
                  <p>By default, AWR automatically captures SQL monitoring reports in XML format.</p>
                  <div class="section">
                     <p>The reports capture only SQL statements that are not executing or queued and have finished execution since the last capture cycle. AWR captures reports only for the most expensive statements according to elapsed execution time.</p>
                     <p>The Monitored SQL Executions page in Enterprise Manager Cloud Control (Cloud Control) summarizes the activity for monitored statements. You can use this page to drill down and obtain additional details about particular statements. The Monitored SQL Executions Details page uses data from several views, including the following:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">GV$SQL_MONITOR</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">GV$SQL_PLAN_MONITOR</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">GV$SQL_MONITOR_SESSTAT</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">GV$SQL</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">GV$SQL_PLAN</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">GV$ACTIVE_SESSION_HISTORY</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">GV$SESSION_LONGOPS</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">DBA_HIST_REPORTS</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">DBA_HIST_REPORTS_DETAILS</code></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2">Assumptions</p>
                     <p>This tutorial assumes the following:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>The user <code class="codeph">sh</code> is executing the following long-running parallel query of the sales made to each customer:
                           </p><pre class="pre codeblock"><code>SELECT c.cust_id, c.cust_last_name, c.cust_first_name, 
       s.prod_id, p.prod_name, s.time_id
FROM   sales s, customers c, products p
WHERE  s.cust_id = c.cust_id
AND    s.prod_id = p.prod_id
ORDER BY c.cust_id, s.time_id;
</code></pre></li>
                        <li>
                           <p>You want to ensure that the preceding query does not consume excessive resources. While the statement executes, you want to determine basic statistics about the database operation, such as the level of parallelism, the total database time, and number of I/O requests.</p>
                        </li>
                        <li>
                           <p>You use Cloud Control to monitor statement execution.</p>
                           <div class="infoboxnote" id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062__GUID-4FC66F79-AC74-48FD-8C97-79FD7C410096">
                              <p class="notep1">Note:</p>
                              <p>To generate the SQL monitor report from the command line, run the <code class="codeph">REPORT_SQL_MONITOR</code> function in the <code class="codeph">DBMS_SQLTUNE</code> package, as in the following sample SQL*Plus script:
                              </p><pre class="pre codeblock"><code>VARIABLE my_rept CLOB
BEGIN
  :my_rept :=DBMS_SQLTUNE.REPORT_SQL_MONITOR();
END;
/
PRINT :my_rept</code></pre></div>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2">To monitor SQL executions:</p>
                     <ol>
                        <li>
                           <p>Access the Monitored SQL Executions page, as described in <span class="q">"<a href="monitoring-database-operations.html#GUID-061502D7-5546-4AB6-B6D3-62FBF71E8CB7" title="The Monitored SQL Executions page in Cloud Control, also known as SQL Monitor, displays details of SQL execution. SQL Monitor is the recommended interface for reporting on database operations.">Monitored SQL Executions Page in Cloud Control</a>"</span>.
                           </p>
                           <p>In the following graphic, the top row shows the parallel query.</p>
                           <div class="figure" id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062__GUID-118F05FF-1AEA-4492-8212-FF8747B861EB"><img src="img/mon_sql_exec_main.jpg" alt="Description of mon_sql_exec_main.jpg follows" title="Description of mon_sql_exec_main.jpg follows" longdesc="img_text/mon_sql_exec_main.html"><br><a href="img_text/mon_sql_exec_main.html">Description of the illustration mon_sql_exec_main.jpg</a></div>
                           <!-- class="figure" -->
                           <p>In this example, the query has been executing for 1.4 minutes.</p>
                        </li>
                        <li>
                           <p>Click the value in the SQL ID column to see details about the statement.</p>
                           <p>The Monitored SQL Details page appears.</p>
                           <div class="figure" id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062__GUID-046EFC89-FAC0-44C0-B07A-CAFF7B5EC0C0"><img src="img/mon_sql_exec_details.gif" alt="Description of mon_sql_exec_details.gif follows" title="Description of mon_sql_exec_details.gif follows" longdesc="img_text/mon_sql_exec_details.html"><br><a href="img_text/mon_sql_exec_details.html">Description of the illustration mon_sql_exec_details.gif</a></div>
                           <!-- class="figure" -->
                           <p>The preceding report shows the execution plan and statistics relating to statement execution. For example, the Timeline column shows when each step of the execution plan was active. Times are shown relative to the beginning and end of the statement execution. The Executions column shows how many times an operation was executed. </p>
                        </li>
                        <li>
                           <p>In the Overview section, click the link next to the SQL text.</p>
                           <p>A message shows the full text of the SQL statement.</p>
                           <div class="figure" id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062__GUID-19D6EE8B-B387-49E7-9FF7-7BE8EEE8E517"><img src="img/sql_id_tooltip.gif" alt="Description of sql_id_tooltip.gif follows" title="Description of sql_id_tooltip.gif follows" longdesc="img_text/sql_id_tooltip.html"><br><a href="img_text/sql_id_tooltip.html">Description of the illustration sql_id_tooltip.gif</a></div>
                           <!-- class="figure" -->
                        </li>
                        <li>
                           <p>In the Time &amp; Wait Statistics section, next to Database Time, move the cursor over the largest portion on the bar graph.</p>
                           <p>A message shows that user I/O is consuming over half of database time.</p>
                           <div class="figure" id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062__GUID-655F455D-5542-4CE7-9257-9AE2E98D56B7"><img src="img/time_stats.gif" alt="Description of time_stats.gif follows" title="Description of time_stats.gif follows" longdesc="img_text/time_stats.html"><br><a href="img_text/time_stats.html">Description of the illustration time_stats.gif</a></div>
                           <!-- class="figure" -->
                           <p>Database Time measures the amount of time the database has spent working on this SQL statement. This value includes CPU and wait times, such as I/O time. The bar graph is divided into several color-coded portions to highlight CPU resources, user I/O resources, and other resources. You can move the cursor over any portion to view the percentage value of the total.</p>
                        </li>
                        <li>
                           <p>In the Details section, in the IO Requests column, move the cursor over the I/O requests bar to view the percentage value of the total.</p>
                           <p>A message appears.</p>
                           <div class="figure" id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062__GUID-81041CAC-A1AC-4A5A-A999-12173E8D95B4"><img src="img/io_requests.gif" alt="Description of io_requests.gif follows" title="Description of io_requests.gif follows" longdesc="img_text/io_requests.html"><br><a href="img_text/io_requests.html">Description of the illustration io_requests.gif</a></div>
                           <!-- class="figure" -->
                           <p>In the preceding graphic, the IO Requests message shows the total number of read requests issued by the monitored SQL. The message shows that read requests form 80% of the total I/O requests.</p>
                        </li>
                     </ol>
                     <div class="infoboxnotealso" id="GUID-4048D00E-2635-42C8-A37D-71EFAC619062__GUID-9DC5EB17-AA69-419D-A78D-D50B69A7755F">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Cloud Control Online Help for descriptions of the elements on the Monitored SQL Executions Details page, and for complete descriptions of all statistics in the report.</p>
                           </li>
                           <li>
                              <p><a href="../refrn/V-SQL_MONITOR.html#GUID-79E97A84-9C27-4A5E-AC0D-C12CB3E748E6"><span><cite>Oracle Database Reference</cite></span></a> to learn about <code class="codeph">V$SQL_MONITOR</code> and related views for database operations monitoring
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>